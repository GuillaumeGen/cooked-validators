<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8" /><meta name="viewport" content="width=device-width, initial-scale=1" /><title>Cooked.MockChain.Balancing</title><link href="linuwial.css" rel="stylesheet" type="text/css" title="Linuwial" /><link rel="stylesheet" type="text/css" href="quick-jump.css" /><link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=PT+Sans:400,400i,700" /><script src="haddock-bundle.min.js" async="async" type="text/javascript"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({ tex2jax: { processClass: "mathjax", ignoreClass: ".*" } });</script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js?config=TeX-AMS-MML_HTMLorMML" type="text/javascript"></script></head><body><div id="package-header"><span class="caption">cooked-validators-0.2.0</span><ul class="links" id="page-menu"><li><a href="src/Cooked.MockChain.Balancing.html">Source</a></li><li><a href="index.html">Contents</a></li><li><a href="doc-index.html">Index</a></li></ul></div><div id="content"><div id="module-header"><table class="info"><tr><th>Safe Haskell</th><td>None</td></tr><tr><th>Language</th><td>Haskell2010</td></tr></table><p class="caption">Cooked.MockChain.Balancing</p></div><div id="synopsis"><details id="syn"><summary>Synopsis</summary><ul class="details-toggle" data-details-id="syn"><li class="src short"><a href="#v:balancedTxSkel">balancedTxSkel</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>, <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef)</li><li class="src short"><a href="#v:balancedTx">balancedTx</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>, <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef) -&gt; m (Tx BabbageEra)</li><li class="src short"><a href="#v:ensureTxSkelOutsMinAda">ensureTxSkelOutsMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li><li class="src short"><a href="#v:txSkelInputUtxosPV2">txSkelInputUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:txSkelInputUtxos">txSkelInputUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:txSkelReferenceInputUtxosPV2">txSkelReferenceInputUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:txSkelReferenceInputUtxos">txSkelReferenceInputUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:txSkelInputValidators">txSkelInputValidators</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> ValidatorHash (Versioned Validator))</li><li class="src short"><a href="#v:lookupUtxosPV2">lookupUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; [TxOutRef] -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:lookupUtxos">lookupUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; [TxOutRef] -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut)</li><li class="src short"><a href="#v:txSkelInputValue">txSkelInputValue</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m Value</li><li class="src short"><a href="#v:txSkelInputData">txSkelInputData</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> DatumHash Datum)</li><li class="src short"><a href="#v:setFeeAndBalance">setFeeAndBalance</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>)</li><li class="src short"><a href="#v:estimateTxSkelFee">estimateTxSkelFee</a> :: Params -&gt; UTxO EmulatorEra -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> DatumHash Datum -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> ValidatorHash (Versioned Validator) -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cooked-MockChain-BlockChain.html#t:MockChainError" title="Cooked.MockChain.BlockChain">MockChainError</a> <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a></li><li class="src short"><a href="#v:calcCollateral">calcCollateral</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef)</li><li class="src short"><a href="#v:balanceTxFromAux">balanceTxFromAux</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-MockChain-BlockChain.html#t:BalanceStage" title="Cooked.MockChain.BlockChain">BalanceStage</a> -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li><li class="src short"><span class="keyword">data</span> <a href="#t:BalanceTxRes">BalanceTxRes</a> = <a href="#v:BalanceTxRes">BalanceTxRes</a> {<ul class="subs"><li><a href="#v:newInputs">newInputs</a> :: [(TxOutRef, TxOut)]</li><li><a href="#v:returnValue">returnValue</a> :: Value</li><li><a href="#v:availableUtxos">availableUtxos</a> :: [(TxOutRef, TxOut)]</li></ul>}</li><li class="src short"><a href="#v:calcBalanceTx">calcBalanceTx</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-MockChain-BlockChain.html#t:BalanceStage" title="Cooked.MockChain.BlockChain">BalanceStage</a> -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; m <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a></li><li class="src short"><a href="#v:applyBalanceTx">applyBalanceTx</a> :: PubKeyHash -&gt; <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a></li></ul></details></div><div id="interface"><h1>Documentation</h1><div class="top"><p class="src"><a id="v:balancedTxSkel" class="def">balancedTxSkel</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>, <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef) <a href="src/Cooked.MockChain.Balancing.html#balancedTxSkel" class="link">Source</a> <a href="#v:balancedTxSkel" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:balancedTx" class="def">balancedTx</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>, <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef) -&gt; m (Tx BabbageEra) <a href="src/Cooked.MockChain.Balancing.html#balancedTx" class="link">Source</a> <a href="#v:balancedTx" class="selflink">#</a></p><div class="doc"><p>Take the output of <code><a href="Cooked-MockChain-Balancing.html#v:balancedTxSkel" title="Cooked.MockChain.Balancing">balancedTxSkel</a></code> and turn it into an actual Cardano
 transaction.</p></div></div><div class="top"><p class="src"><a id="v:ensureTxSkelOutsMinAda" class="def">ensureTxSkelOutsMinAda</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.Balancing.html#ensureTxSkelOutsMinAda" class="link">Source</a> <a href="#v:ensureTxSkelOutsMinAda" class="selflink">#</a></p><div class="doc"><p>Ensure that the transaction outputs have the necessary minimum amount of
 Ada on them. This will only be applied if the <code><a href="Cooked-Skeleton.html#v:txOptEnsureMinAda" title="Cooked.Skeleton">txOptEnsureMinAda</a></code> is set to
 <code>True</code>.</p></div></div><div class="top"><p class="src"><a id="v:txSkelInputUtxosPV2" class="def">txSkelInputUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#txSkelInputUtxosPV2" class="link">Source</a> <a href="#v:txSkelInputUtxosPV2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:txSkelInputUtxos" class="def">txSkelInputUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#txSkelInputUtxos" class="link">Source</a> <a href="#v:txSkelInputUtxos" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:txSkelReferenceInputUtxosPV2" class="def">txSkelReferenceInputUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#txSkelReferenceInputUtxosPV2" class="link">Source</a> <a href="#v:txSkelReferenceInputUtxosPV2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:txSkelReferenceInputUtxos" class="def">txSkelReferenceInputUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#txSkelReferenceInputUtxos" class="link">Source</a> <a href="#v:txSkelReferenceInputUtxos" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:txSkelInputValidators" class="def">txSkelInputValidators</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> ValidatorHash (Versioned Validator)) <a href="src/Cooked.MockChain.Balancing.html#txSkelInputValidators" class="link">Source</a> <a href="#v:txSkelInputValidators" class="selflink">#</a></p><div class="doc"><p>All validators which protect transaction inputs</p></div></div><div class="top"><p class="src"><a id="v:lookupUtxosPV2" class="def">lookupUtxosPV2</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; [TxOutRef] -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#lookupUtxosPV2" class="link">Source</a> <a href="#v:lookupUtxosPV2" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:lookupUtxos" class="def">lookupUtxos</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; [TxOutRef] -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut) <a href="src/Cooked.MockChain.Balancing.html#lookupUtxos" class="link">Source</a> <a href="#v:lookupUtxos" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:txSkelInputValue" class="def">txSkelInputValue</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m Value <a href="src/Cooked.MockChain.Balancing.html#txSkelInputValue" class="link">Source</a> <a href="#v:txSkelInputValue" class="selflink">#</a></p><div class="doc"><p>look up the UTxOs the transaction consumes, and sum the value contained in
 them.</p></div></div><div class="top"><p class="src"><a id="v:txSkelInputData" class="def">txSkelInputData</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> DatumHash Datum) <a href="src/Cooked.MockChain.Balancing.html#txSkelInputData" class="link">Source</a> <a href="#v:txSkelInputData" class="selflink">#</a></p><div class="doc"><p>Look up the data on UTxOs the transaction consumes.</p></div></div><div class="top"><p class="src"><a id="v:setFeeAndBalance" class="def">setFeeAndBalance</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; m (<a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a>, <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a>) <a href="src/Cooked.MockChain.Balancing.html#setFeeAndBalance" class="link">Source</a> <a href="#v:setFeeAndBalance" class="selflink">#</a></p></div><div class="top"><p class="src"><a id="v:estimateTxSkelFee" class="def">estimateTxSkelFee</a> :: Params -&gt; UTxO EmulatorEra -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> DatumHash Datum -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> TxOutRef TxOut -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Map" title="Distribution.Compat.Prelude.Internal">Map</a> ValidatorHash (Versioned Validator) -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Either" title="Distribution.Compat.Prelude.Internal">Either</a> <a href="Cooked-MockChain-BlockChain.html#t:MockChainError" title="Cooked.MockChain.BlockChain">MockChainError</a> <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> <a href="src/Cooked.MockChain.Balancing.html#estimateTxSkelFee" class="link">Source</a> <a href="#v:estimateTxSkelFee" class="selflink">#</a></p><div class="doc"><p>This funcion is essentially a copy of
 <a href="https://github.com/input-output-hk/plutus-apps/blob/d4255f05477fd8477ee9673e850ebb9ebb8c9657/plutus-ledger/src/Ledger/Fee.hs#L19">https://github.com/input-output-hk/plutus-apps/blob/d4255f05477fd8477ee9673e850ebb9ebb8c9657/plutus-ledger/src/Ledger/Fee.hs#L19</a></p></div></div><div class="top"><p class="src"><a id="v:calcCollateral" class="def">calcCollateral</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; m (<a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Set" title="Distribution.Compat.Prelude.Internal">Set</a> TxOutRef) <a href="src/Cooked.MockChain.Balancing.html#calcCollateral" class="link">Source</a> <a href="#v:calcCollateral" class="selflink">#</a></p><div class="doc"><p>Calculates the collateral for a transaction</p></div></div><div class="top"><p class="src"><a id="v:balanceTxFromAux" class="def">balanceTxFromAux</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-MockChain-BlockChain.html#t:BalanceStage" title="Cooked.MockChain.BlockChain">BalanceStage</a> -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; m <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.Balancing.html#balanceTxFromAux" class="link">Source</a> <a href="#v:balanceTxFromAux" class="selflink">#</a></p></div><div class="top"><p class="src"><span class="keyword">data</span> <a id="t:BalanceTxRes" class="def">BalanceTxRes</a> <a href="src/Cooked.MockChain.Balancing.html#BalanceTxRes" class="link">Source</a> <a href="#t:BalanceTxRes" class="selflink">#</a></p><div class="subs constructors"><p class="caption">Constructors</p><table><tr><td class="src"><a id="v:BalanceTxRes" class="def">BalanceTxRes</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><div class="subs fields"><p class="caption">Fields</p><ul><li><dfn class="src"><a id="v:newInputs" class="def">newInputs</a> :: [(TxOutRef, TxOut)]</dfn><div class="doc"><p>Inputs that need to be added in order to cover the value in the
 transaction outputs</p></div></li><li><dfn class="src"><a id="v:returnValue" class="def">returnValue</a> :: Value</dfn><div class="doc"><p>The <code><a href="Cooked-MockChain-Balancing.html#v:newInputs" title="Cooked.MockChain.Balancing">newInputs</a></code> will add _at least_ the missing value to cover the
 outputs, this is the difference of the input value together with the
 <code><a href="Cooked-MockChain-Balancing.html#v:newInputs" title="Cooked.MockChain.Balancing">newInputs</a></code> and the output value.  This value must be nonnegative in
 every asset class.</p></div></li><li><dfn class="src"><a id="v:availableUtxos" class="def">availableUtxos</a> :: [(TxOutRef, TxOut)]</dfn><div class="doc"><p>Some additional UTxOs that could be used as extra inputs. These all
 belong to the same wallet that was passed to <code><a href="Cooked-MockChain-Balancing.html#v:calcBalanceTx" title="Cooked.MockChain.Balancing">calcBalanceTx</a></code> as an
 argument, and are sorted in decreasing order of their Ada value.</p></div></li></ul></div></td></tr></table></div><div class="subs instances"><h4 class="instances details-toggle-control details-toggle" data-details-id="i:BalanceTxRes">Instances</h4><details id="i:BalanceTxRes" open="open"><summary class="hide-when-js-enabled">Instances details</summary><table><tr><td class="src clearfix"><span class="inst-left"><span class="instance details-toggle-control details-toggle" data-details-id="i:id:BalanceTxRes:Show:1"></span> <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Show" title="Distribution.Compat.Prelude.Internal">Show</a> <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a></span> <a href="src/Cooked.MockChain.Balancing.html#line-345" class="link">Source</a> <a href="#t:BalanceTxRes" class="selflink">#</a></td><td class="doc empty">&nbsp;</td></tr><tr><td colspan="2"><details id="i:id:BalanceTxRes:Show:1"><summary class="hide-when-js-enabled">Instance details</summary><p>Defined in <a href="Cooked-MockChain-Balancing.html">Cooked.MockChain.Balancing</a></p> <div class="subs methods"><p class="caption">Methods</p><p class="src"><a href="#v:showsPrec">showsPrec</a> :: <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Int" title="Distribution.Compat.Prelude.Internal">Int</a> -&gt; <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showsPrec" class="selflink">#</a></p><p class="src"><a href="#v:show">show</a> :: <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:String" title="Distribution.Compat.Prelude.Internal">String</a> <a href="#v:show" class="selflink">#</a></p><p class="src"><a href="#v:showList">showList</a> :: [<a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a>] -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:ShowS" title="Distribution.Compat.Prelude.Internal">ShowS</a> <a href="#v:showList" class="selflink">#</a></p></div></details></td></tr></table></details></div></div><div class="top"><p class="src"><a id="v:calcBalanceTx" class="def">calcBalanceTx</a> :: <a href="Cooked-MockChain-BlockChain.html#t:MonadBlockChainBalancing" title="Cooked.MockChain.BlockChain">MonadBlockChainBalancing</a> m =&gt; <a href="Cooked-MockChain-BlockChain.html#t:BalanceStage" title="Cooked.MockChain.BlockChain">BalanceStage</a> -&gt; <a href="Cooked-Wallet.html#t:Wallet" title="Cooked.Wallet">Wallet</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="Cooked-Skeleton.html#t:Fee" title="Cooked.Skeleton">Fee</a> -&gt; m <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a> <a href="src/Cooked.MockChain.Balancing.html#calcBalanceTx" class="link">Source</a> <a href="#v:calcBalanceTx" class="selflink">#</a></p><div class="doc"><p>Calculate the changes needed to balance a transaction with money from a
 given wallet.  Every transaction that is sent to the chain must be balanced,
 that is: <code>inputs + mints == outputs + fee + burns</code>.</p></div></div><div class="top"><p class="src"><a id="v:applyBalanceTx" class="def">applyBalanceTx</a> :: PubKeyHash -&gt; <a href="Cooked-MockChain-Balancing.html#t:BalanceTxRes" title="Cooked.MockChain.Balancing">BalanceTxRes</a> -&gt; <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> -&gt; <a href="http://hackage.haskell.org/packages/archive/Cabal/latest/doc/html/Distribution-Compat-Prelude-Internal.html#t:Maybe" title="Distribution.Compat.Prelude.Internal">Maybe</a> <a href="Cooked-Skeleton.html#t:TxSkel" title="Cooked.Skeleton">TxSkel</a> <a href="src/Cooked.MockChain.Balancing.html#applyBalanceTx" class="link">Source</a> <a href="#v:applyBalanceTx" class="selflink">#</a></p><div class="doc"><p>Once we calculated what is needed to balance a transaction <code>skel</code>, we still
 need to apply those changes to <code>skel</code>. Because of the <code><a href="Pl.html#v:minAdaTxOut" title="Pl">minAdaTxOut</a></code>
 constraint, this might not be possible: imagine the leftover is less than
 <code><a href="Pl.html#v:minAdaTxOut" title="Pl">minAdaTxOut</a></code>, but the transaction has no output addressed to the
 balancing wallet. If we just create a new ouput for the balancing wallet and
 place the leftover there, the resulting transaction will fail to validate
 with <a href="LessThanMinAdaPerUTxO.html">LessThanMinAdaPerUTxO</a> error. Instead, we need to consume yet another
 UTxO belonging to the wallet to then create the output with the proper
 leftover. If the wallet has no UTxO, then there's no way to balance this
 transaction.</p></div></div></div></div><div id="footer"><p>Produced by <a href="http://www.haskell.org/haddock/">Haddock</a> version 2.24.2</p></div></body></html>