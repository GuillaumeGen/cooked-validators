<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-4"></span><span>
</span><span id="line-5"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Attack.DoubleSat</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-6"></span><span>
</span><span id="line-7"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-8"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Attack.Tweak.html"><span class="hs-identifier">Cooked.Attack.Tweak</span></a></span><span>
</span><span id="line-9"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Monad.Direct.html"><span class="hs-identifier">Cooked.MockChain.Monad.Direct</span></a></span><span>
</span><span id="line-10"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.MockChain.Wallet.html"><span class="hs-identifier">Cooked.MockChain.Wallet</span></a></span><span>
</span><span id="line-11"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.html"><span class="hs-identifier">Cooked.Tx.Constraints</span></a></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">L</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Numeric</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-18"></span><span>
</span><span id="line-19"></span><span class="hs-comment">{- Note: What is a double satisfaction attack?

A double satisfaction attack consists in trying to satisfy the requirements for
what conceptually are two transactions in a single transaction, and doing so
incompletely. It succeeds whenever the requirements of two validators ovelap,
but the required outputs of the transaction are not sufficiently unique, so that
both validators see them as satisfying &quot;their&quot; requirement.

The mechanism is explained very well in the following analogy from the Plutus
documentation: &quot;Suppose that two tax auditors from two different departments
come to visit you in turn to see if you&#8217;ve paid your taxes. You come up with a
clever scheme to confuse them. Your tax liability to both departments is $10, so
you make a single payment to the tax office&#8217;s bank account for $10. When the
auditors arrive, you show them your books, containing the payment to the tax
office. They both leave satisfied.&quot;

The double satisfaction attack 'doubleSatAttack' provided by this module works
by going through the foci of some optic on the 'TxSkel' representing the
transaction from the left to the right, and adding some extra 'Constraints'
depending on each focus and the current 'MockChainSt'ate. For example, we can
add

- one or more 'SpendsScript's, depending on 'SpendsScript' constraints on the original transaction,
- one or more 'Mints's, depending on a 'SpendsScript' on the original transaction,
- one or more 'SpendsScript's, depending on 'PaysScript' constraints on the original transaction,
- ...
-}</span><span>
</span><span id="line-46"></span><span>
</span><span id="line-47"></span><span class="hs-comment">-- | How to combine extra constraints added for different reasons in the</span><span>
</span><span id="line-48"></span><span class="hs-comment">-- 'doubleSatAttack'. See the comments there.</span><span>
</span><span id="line-49"></span><span class="hs-keyword">data</span><span> </span><span id="DSSplitMode"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DSSplitMode"><span class="hs-identifier hs-var">DSSplitMode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TryCombinations"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#TryCombinations"><span class="hs-identifier hs-var">TryCombinations</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="AllSeparate"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#AllSeparate"><span class="hs-identifier hs-var">AllSeparate</span></a></span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-comment">-- | Double satisfacion attack. See the comment above for what such an attack is</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- about conceptually.</span><span>
</span><span id="line-53"></span><span class="hs-comment">--</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- This attack consists in adding some extra constraints to a transaction, and</span><span>
</span><span id="line-55"></span><span class="hs-comment">-- hoping that the additional minting policies or validator scripts thereby</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- involved are fooled by what's already present on the transaction. Any extra</span><span>
</span><span id="line-57"></span><span class="hs-comment">-- value contained in new inputs to the transaction is then paid to the</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- attacker.</span><span>
</span><span id="line-59"></span><span id="local-6989586621679573394"><span id="local-6989586621679573395"><span id="local-6989586621679573396"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#doubleSatAttack"><span class="hs-identifier hs-type">doubleSatAttack</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Is</span></span><span> </span><span class="annot"><a href="#local-6989586621679573396"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">A_Traversal</span></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-61"></span><span>  </span><span class="hs-comment">-- | Each focus of this optic is a potential reason to add some extra</span><span>
</span><span id="line-62"></span><span>  </span><span class="hs-comment">-- constraints.</span><span>
</span><span id="line-63"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-64"></span><span>  </span><span class="hs-comment">-- As an example, one could go through the 'PaysScript' constraints for</span><span>
</span><span id="line-65"></span><span>  </span><span class="hs-comment">-- validators of type @t@ with the following traversal:</span><span>
</span><span id="line-66"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-67"></span><span>  </span><span class="hs-comment">-- &gt; paysScriptConstraintsT % paysScriptConstraintTypeP @t</span><span>
</span><span id="line-68"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Optic'</span></span><span> </span><span class="annot"><a href="#local-6989586621679573396"><span class="hs-identifier hs-type">k</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679573395"><span class="hs-identifier hs-type">is</span></a></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679573394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-69"></span><span>  </span><span class="hs-comment">-- | Which constraints to add, for each of the foci. There might be different</span><span>
</span><span id="line-70"></span><span>  </span><span class="hs-comment">-- options for each focus, that's why the return value is a list.</span><span>
</span><span id="line-71"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-72"></span><span>  </span><span class="hs-comment">-- Continuing the example, for each of the focused 'PaysScript' constraints,</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-comment">-- you might want to try adding some 'SpendsScript' constraints to the</span><span>
</span><span id="line-74"></span><span>  </span><span class="hs-comment">-- transaction. Since it might be interesting to try different redeemers on</span><span>
</span><span id="line-75"></span><span>  </span><span class="hs-comment">-- these extra 'SpendsScript' constraints, you can just provide a list of all</span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-comment">-- the options you want to try adding for a given 'PaysScript' that's already</span><span>
</span><span id="line-77"></span><span>  </span><span class="hs-comment">-- on the transaction.</span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.MockChain.Monad.Direct.html#MockChainSt"><span class="hs-identifier hs-type">MockChainSt</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679573394"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>  </span><span class="hs-comment">-- | The wallet of the attacker, where any surplus is paid to.</span><span>
</span><span id="line-80"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-81"></span><span>  </span><span class="hs-comment">-- In the example, the extra value in the added 'SpendsScript' constraints</span><span>
</span><span id="line-82"></span><span>  </span><span class="hs-comment">-- will be paid to the attacker.</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="Cooked.MockChain.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-84"></span><span>  </span><span class="hs-comment">-- | Since there are potentially multiple 'Constraints' produced for each of</span><span>
</span><span id="line-85"></span><span>  </span><span class="hs-comment">-- the foci, the question is whether (and how) to combine additions that were</span><span>
</span><span id="line-86"></span><span>  </span><span class="hs-comment">-- triggered by different foci.</span><span>
</span><span id="line-87"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-88"></span><span>  </span><span class="hs-comment">-- In the example: Let's say that the unmodified transaction had three focused</span><span>
</span><span id="line-89"></span><span>  </span><span class="hs-comment">-- 'PaysScript' constraints (let's denote them by a, b, and c), and that you</span><span>
</span><span id="line-90"></span><span>  </span><span class="hs-comment">-- want to try 2, 3, and 5 additional 'SpendsScript' constraints for each of</span><span>
</span><span id="line-91"></span><span>  </span><span class="hs-comment">-- them, respectively (let's call those a1, a2, and b1, b2, b3, and c1, c2,</span><span>
</span><span id="line-92"></span><span>  </span><span class="hs-comment">-- c3, c4, c5).</span><span>
</span><span id="line-93"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-comment">-- - If you want to try each additional 'SpendsScript' on its own modified</span><span>
</span><span id="line-95"></span><span>  </span><span class="hs-comment">--   transaction, use 'AllSeparate'. Thus, there'll be 2+3+5=10 modified</span><span>
</span><span id="line-96"></span><span>  </span><span class="hs-comment">--   transactions. Namely, for each element of the list</span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-98"></span><span>  </span><span class="hs-comment">-- &gt; [a1, a2, b1, b2, b3, c1, c2, c3, c4, c5]  ,</span><span>
</span><span id="line-99"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-100"></span><span>  </span><span class="hs-comment">--   you'll get one modified transaction that includes that constraint.</span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-102"></span><span>  </span><span class="hs-comment">-- - If you want to try combining all options from one focus with all options</span><span>
</span><span id="line-103"></span><span>  </span><span class="hs-comment">--   from all of the other foci, use 'TryCombinations'. Then, there'll be</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-comment">--   (2+1)*(3+1)*(5+1)=72 possible combinations, if you include all of the</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-comment">--   combinations where /at most/ three (one for each focus) extra constraints</span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-comment">--   are added. One of these combinations is of course the one where nothing</span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-comment">--   is added, and that one is omitted, which brings the grand total down to</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-comment">--   71 modified transactions, the additional 'SpendsScript' constraints of</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-comment">--   which are given by the following list:</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-comment">-- &gt; [ -- one additional constraint (the 10 cases from above)</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-comment">-- &gt;   [a1],</span><span>
</span><span id="line-113"></span><span>  </span><span class="hs-comment">-- &gt;   [a2],</span><span>
</span><span id="line-114"></span><span>  </span><span class="hs-comment">-- &gt;   ...</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-comment">-- &gt;   [c4],</span><span>
</span><span id="line-116"></span><span>  </span><span class="hs-comment">-- &gt;   [c5],</span><span>
</span><span id="line-117"></span><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-comment">-- &gt;   -- two additional constraints, from different foci (2*3 + 2*5 + 3*5 = 31 cases)</span><span>
</span><span id="line-119"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b1],</span><span>
</span><span id="line-120"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b2],</span><span>
</span><span id="line-121"></span><span>  </span><span class="hs-comment">-- &gt;   ...</span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-comment">-- &gt;   [b3, c4],</span><span>
</span><span id="line-123"></span><span>  </span><span class="hs-comment">-- &gt;   [b3, c5],</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-comment">-- &gt;</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-comment">-- &gt;   -- three additional constraints, one from each focus (2*3*5 = 30 cases)</span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b1, c1],</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b1, c2],</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-comment">-- &gt;   ...</span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b3, c4],</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-comment">-- &gt;   [a1, b3, c5]</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-comment">-- &gt; ]</span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-comment">--</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-comment">-- So you see that this attack can branch quite wildly. Use with caution!</span><span>
</span><span id="line-134"></span><span>  </span><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DSSplitMode"><span class="hs-identifier hs-type">DSSplitMode</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><a href="Cooked.Attack.Tweak.Common.html#Tweak"><span class="hs-identifier hs-type">Tweak</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-136"></span><span id="doubleSatAttack"><span class="annot"><span class="annottext">doubleSatAttack :: Optic' k is TxSkel a
-&gt; (MockChainSt -&gt; a -&gt; [Constraints])
-&gt; Wallet
-&gt; DSSplitMode
-&gt; Tweak ()
</span><a href="Cooked.Attack.DoubleSat.html#doubleSatAttack"><span class="hs-identifier hs-var hs-var">doubleSatAttack</span></a></span></span><span> </span><span id="local-6989586621679573392"><span class="annot"><span class="annottext">Optic' k is TxSkel a
</span><a href="#local-6989586621679573392"><span class="hs-identifier hs-var">optic</span></a></span></span><span> </span><span id="local-6989586621679573391"><span class="annot"><span class="annottext">MockChainSt -&gt; a -&gt; [Constraints]
</span><a href="#local-6989586621679573391"><span class="hs-identifier hs-var">extra</span></a></span></span><span> </span><span id="local-6989586621679573390"><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679573390"><span class="hs-identifier hs-var">attacker</span></a></span></span><span> </span><span id="local-6989586621679573389"><span class="annot"><span class="annottext">DSSplitMode
</span><a href="#local-6989586621679573389"><span class="hs-identifier hs-var">mode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-137"></span><span>  </span><span id="local-6989586621679573388"><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679573388"><span class="hs-identifier hs-var">mcst</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Tweak MockChainSt
</span><a href="Cooked.Attack.Tweak.Common.html#mcstTweak"><span class="hs-identifier hs-var">mcstTweak</span></a></span><span>
</span><span id="line-138"></span><span>  </span><span id="local-6989586621679573386"><span class="annot"><span class="annottext">[[Constraints]]
</span><a href="#local-6989586621679573386"><span class="hs-identifier hs-var">extraConstrs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(a -&gt; [Constraints]) -&gt; [a] -&gt; [[Constraints]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MockChainSt -&gt; a -&gt; [Constraints]
</span><a href="#local-6989586621679573391"><span class="hs-identifier hs-var">extra</span></a></span><span> </span><span class="annot"><span class="annottext">MockChainSt
</span><a href="#local-6989586621679573388"><span class="hs-identifier hs-var">mcst</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([a] -&gt; [[Constraints]]) -&gt; Tweak [a] -&gt; Tweak [[Constraints]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx TxSkel [a] -&gt; Tweak [a]
forall k (is :: IxList) a.
Is k A_Getter =&gt;
Optic' k is TxSkel a -&gt; Tweak a
</span><a href="Cooked.Attack.Tweak.Common.html#viewTweak"><span class="hs-identifier hs-var">viewTweak</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Optic' k is TxSkel a -&gt; Optic' A_Lens NoIx TxSkel [a]
forall k (is :: IxList) s t a.
Is k A_Traversal =&gt;
Optic k is s t a a -&gt; Lens s t [a] [a]
</span><span class="hs-identifier hs-var">partsOf</span></span><span> </span><span class="annot"><span class="annottext">Optic' k is TxSkel a
</span><a href="#local-6989586621679573392"><span class="hs-identifier hs-var">optic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">[Tweak ()] -&gt; Tweak ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Foldable t, MonadPlus m) =&gt;
t (m a) -&gt; m a
</span><span class="hs-identifier hs-var">msum</span></span><span> </span><span class="annot"><span class="annottext">([Tweak ()] -&gt; Tweak ()) -&gt; [Tweak ()] -&gt; Tweak ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">(Constraints -&gt; Tweak ()) -&gt; [Constraints] -&gt; [Tweak ()]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span>
</span><span id="line-141"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679573381"><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679573381"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-142"></span><span>          </span><span id="local-6989586621679573380"><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679573380"><span class="hs-identifier hs-var">added</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Tweak Constraints
</span><a href="Cooked.Attack.Tweak.AddConstraints.html#addConstraintsTweak"><span class="hs-identifier hs-var">addConstraintsTweak</span></a></span><span> </span><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679573381"><span class="hs-identifier hs-var">c</span></a></span><span>
</span><span id="line-143"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679573378"><span class="annot"><span class="annottext">addedValue :: Value
</span><a href="#local-6989586621679573378"><span class="hs-identifier hs-var hs-var">addedValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Value
</span><a href="#local-6989586621679573377"><span class="hs-identifier hs-var">constraintBalance</span></a></span><span> </span><span class="annot"><span class="annottext">Constraints
</span><a href="#local-6989586621679573380"><span class="hs-identifier hs-var">added</span></a></span><span>
</span><span id="line-144"></span><span>          </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679573378"><span class="hs-identifier hs-var">addedValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Bool
</span><span class="hs-operator hs-var">`L.gt`</span></span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span>
</span><span id="line-145"></span><span>            </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">OutConstraint -&gt; Tweak ()
</span><a href="Cooked.Attack.Tweak.AddConstraints.html#addOutConstraintTweak"><span class="hs-identifier hs-var">addOutConstraintTweak</span></a></span><span> </span><span class="annot"><span class="annottext">(OutConstraint -&gt; Tweak ()) -&gt; OutConstraint -&gt; Tweak ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Value -&gt; OutConstraint
</span><a href="Cooked.Tx.Constraints.Type.html#paysPK"><span class="hs-identifier hs-var">paysPK</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Wallet -&gt; PubKeyHash
</span><a href="Cooked.MockChain.Wallet.html#walletPKHash"><span class="hs-identifier hs-var">walletPKHash</span></a></span><span> </span><span class="annot"><span class="annottext">Wallet
</span><a href="#local-6989586621679573390"><span class="hs-identifier hs-var">attacker</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679573378"><span class="hs-identifier hs-var">addedValue</span></a></span><span>
</span><span id="line-146"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Tweak ()
forall a. Tweak a
</span><a href="Cooked.Attack.Tweak.Common.html#failingTweak"><span class="hs-identifier hs-var">failingTweak</span></a></span><span>
</span><span id="line-147"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">DSSplitMode
</span><a href="#local-6989586621679573389"><span class="hs-identifier hs-var">mode</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-149"></span><span>          </span><span class="annot"><span class="annottext">DSSplitMode
</span><a href="Cooked.Attack.DoubleSat.html#AllSeparate"><span class="hs-identifier hs-var">AllSeparate</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Constraints -&gt; Constraints -&gt; Bool)
-&gt; [Constraints] -&gt; [Constraints]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nubBy</span></span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Constraints -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#sameConstraints"><span class="hs-identifier hs-var">sameConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraints] -&gt; [Constraints]) -&gt; [Constraints] -&gt; [Constraints]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Constraints]] -&gt; [Constraints]
forall (t :: * -&gt; *) a. Foldable t =&gt; t [a] -&gt; [a]
</span><span class="hs-identifier hs-var">concat</span></span><span> </span><span class="annot"><span class="annottext">[[Constraints]]
</span><a href="#local-6989586621679573386"><span class="hs-identifier hs-var">extraConstrs</span></a></span><span>
</span><span id="line-150"></span><span>          </span><span class="annot"><span class="annottext">DSSplitMode
</span><a href="Cooked.Attack.DoubleSat.html#TryCombinations"><span class="hs-identifier hs-var">TryCombinations</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-151"></span><span>            </span><span class="annot"><span class="annottext">(Constraints -&gt; Constraints -&gt; Bool)
-&gt; [Constraints] -&gt; [Constraints]
forall a. (a -&gt; a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">nubBy</span></span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Constraints -&gt; Bool
</span><a href="Cooked.Tx.Constraints.Type.html#sameConstraints"><span class="hs-identifier hs-var">sameConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">([Constraints] -&gt; [Constraints]) -&gt; [Constraints] -&gt; [Constraints]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-152"></span><span>              </span><span class="annot"><span class="annottext">([Constraints] -&gt; Constraints) -&gt; [[Constraints]] -&gt; [Constraints]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="annot"><span class="annottext">[Constraints] -&gt; Constraints
</span><a href="#local-6989586621679573368"><span class="hs-identifier hs-var">joinConstraints</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraints]] -&gt; [Constraints])
-&gt; [[Constraints]] -&gt; [Constraints]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-153"></span><span>                </span><span class="annot"><span class="annottext">[[Constraints]] -&gt; [[Constraints]]
forall a. [a] -&gt; [a]
</span><span class="hs-identifier hs-var">tail</span></span><span> </span><span class="annot"><span class="annottext">([[Constraints]] -&gt; [[Constraints]])
-&gt; [[Constraints]] -&gt; [[Constraints]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">[[Constraints]] -&gt; [[Constraints]]
forall x. [[x]] -&gt; [[x]]
</span><a href="#local-6989586621679573366"><span class="hs-identifier hs-var">allCombinations</span></a></span><span> </span><span class="annot"><span class="annottext">([[Constraints]] -&gt; [[Constraints]])
-&gt; [[Constraints]] -&gt; [[Constraints]]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">([Constraints] -&gt; [Constraints])
-&gt; [[Constraints]] -&gt; [[Constraints]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Constraints
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; [Constraints] -&gt; [Constraints]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[Constraints]]
</span><a href="#local-6989586621679573386"><span class="hs-identifier hs-var">extraConstrs</span></a></span><span>
</span><span id="line-154"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-155"></span><span>  </span><span class="annot"><span class="annottext">DoubleSatLbl -&gt; Tweak ()
forall x. LabelConstrs x =&gt; x -&gt; Tweak ()
</span><a href="Cooked.Attack.Tweak.Common.html#addLabelTweak"><span class="hs-identifier hs-var">addLabelTweak</span></a></span><span> </span><span class="annot"><span class="annottext">DoubleSatLbl
</span><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span><span>
</span><span id="line-156"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-157"></span><span>    </span><span class="annot"><a href="#local-6989586621679573377"><span class="hs-identifier hs-type">constraintBalance</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">L.Value</span></span><span>
</span><span id="line-158"></span><span>    </span><span id="local-6989586621679573377"><span class="annot"><span class="annottext">constraintBalance :: Constraints -&gt; Value
</span><a href="#local-6989586621679573377"><span class="hs-identifier hs-var hs-var">constraintBalance</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679573363"><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679573363"><span class="hs-identifier hs-var">is</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-type">:=&gt;:</span></a></span><span> </span><span id="local-6989586621679573361"><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679573361"><span class="hs-identifier hs-var">os</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679573360"><span class="hs-identifier hs-var">inValue</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679573358"><span class="hs-identifier hs-var">outValue</span></a></span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-keyword">where</span><span>
</span><span id="line-160"></span><span>        </span><span id="local-6989586621679573360"><span class="annot"><span class="annottext">inValue :: Value
</span><a href="#local-6989586621679573360"><span class="hs-identifier hs-var hs-var">inValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic' A_Traversal NoIx [MiscConstraint] Value
-&gt; [MiscConstraint] -&gt; Value
forall k a (is :: IxList) s.
(Is k A_Fold, Monoid a) =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">foldOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Traversal
  [MiscConstraint] [MiscConstraint] MiscConstraint MiscConstraint
forall (t :: * -&gt; *) a b.
Traversable t =&gt;
Traversal (t a) (t b) a b
</span><span class="hs-identifier hs-var">traversed</span></span><span> </span><span class="annot"><span class="annottext">Traversal
  [MiscConstraint] [MiscConstraint] MiscConstraint MiscConstraint
-&gt; Optic
     An_AffineTraversal NoIx MiscConstraint MiscConstraint Value Value
-&gt; Optic' A_Traversal NoIx [MiscConstraint] Value
forall k m l (ks :: IxList) (is :: IxList) (js :: IxList) s t u v a
       b.
(Is k m, Is l m, m ~ Join k l, ks ~ Append is js) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  An_AffineTraversal NoIx MiscConstraint MiscConstraint Value Value
</span><a href="Cooked.Tx.Constraints.Optics.html#valueAT"><span class="hs-identifier hs-var">valueAT</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint]
</span><a href="#local-6989586621679573363"><span class="hs-identifier hs-var">is</span></a></span><span>
</span><span id="line-161"></span><span>        </span><span id="local-6989586621679573358"><span class="annot"><span class="annottext">outValue :: Value
</span><a href="#local-6989586621679573358"><span class="hs-identifier hs-var hs-var">outValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Optic' A_Traversal NoIx [OutConstraint] Value
-&gt; [OutConstraint] -&gt; Value
forall k a (is :: IxList) s.
(Is k A_Fold, Monoid a) =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">foldOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Traversal
  [OutConstraint] [OutConstraint] OutConstraint OutConstraint
forall (t :: * -&gt; *) a b.
Traversable t =&gt;
Traversal (t a) (t b) a b
</span><span class="hs-identifier hs-var">traversed</span></span><span> </span><span class="annot"><span class="annottext">Traversal
  [OutConstraint] [OutConstraint] OutConstraint OutConstraint
-&gt; Optic A_Lens NoIx OutConstraint OutConstraint Value Value
-&gt; Optic' A_Traversal NoIx [OutConstraint] Value
forall k m l (ks :: IxList) (is :: IxList) (js :: IxList) s t u v a
       b.
(Is k m, Is l m, m ~ Join k l, ks ~ Append is js) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens NoIx OutConstraint OutConstraint Value Value
forall a. HasValue a =&gt; Lens' a Value
</span><a href="Cooked.Tx.Constraints.Optics.html#valueL"><span class="hs-identifier hs-var">valueL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[OutConstraint]
</span><a href="#local-6989586621679573361"><span class="hs-identifier hs-var">os</span></a></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- this function uses 'addConstraintsTweak' to join a list of 'Constraints'</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">-- into one 'Constraints' that specifies eveything that is contained in the</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">-- input.</span><span>
</span><span id="line-166"></span><span>    </span><span class="annot"><a href="#local-6989586621679573368"><span class="hs-identifier hs-type">joinConstraints</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Tx.Constraints.Type.html#Constraints"><span class="hs-identifier hs-type">Constraints</span></a></span><span>
</span><span id="line-167"></span><span>    </span><span id="local-6989586621679573368"><span class="annot"><span class="annottext">joinConstraints :: [Constraints] -&gt; Constraints
</span><a href="#local-6989586621679573368"><span class="hs-identifier hs-var hs-var">joinConstraints</span></a></span></span><span> </span><span id="local-6989586621679573352"><span class="annot"><span class="annottext">[Constraints]
</span><a href="#local-6989586621679573352"><span class="hs-identifier hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Constraints] -&gt; Constraints
forall a. [a] -&gt; a
</span><span class="hs-identifier hs-var">head</span></span><span> </span><span class="annot"><span class="annottext">([Constraints] -&gt; Constraints) -&gt; [Constraints] -&gt; Constraints
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">Tweak () -&gt; MockChainSt -&gt; Constraints -&gt; [Constraints]
forall a. Tweak a -&gt; MockChainSt -&gt; Constraints -&gt; [Constraints]
</span><a href="Cooked.Attack.Tweak.Common.html#applyToConstraints"><span class="hs-identifier hs-var">applyToConstraints</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Constraints -&gt; Tweak Constraints) -&gt; [Constraints] -&gt; Tweak ()
forall (t :: * -&gt; *) (m :: * -&gt; *) a b.
(Foldable t, Monad m) =&gt;
(a -&gt; m b) -&gt; t a -&gt; m ()
</span><span class="hs-identifier hs-var">mapM_</span></span><span> </span><span class="annot"><span class="annottext">Constraints -&gt; Tweak Constraints
</span><a href="Cooked.Attack.Tweak.AddConstraints.html#addConstraintsTweak"><span class="hs-identifier hs-var">addConstraintsTweak</span></a></span><span> </span><span class="annot"><span class="annottext">[Constraints]
</span><a href="#local-6989586621679573352"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MockChainSt
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span> </span><span class="annot"><span class="annottext">(Constraints -&gt; [Constraints]) -&gt; Constraints -&gt; [Constraints]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[MiscConstraint] -&gt; [OutConstraint] -&gt; Constraints
</span><a href="Cooked.Tx.Constraints.Type.html#%3A%3D%3E%3A"><span class="hs-operator hs-var">:=&gt;:</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-168"></span><span>
</span><span id="line-169"></span><span>    </span><span id="local-6989586621679573450"><span class="annot"><a href="#local-6989586621679573366"><span class="hs-identifier hs-type">allCombinations</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679573450"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679573450"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span></span><span>
</span><span id="line-170"></span><span>    </span><span id="local-6989586621679573366"><span class="annot"><span class="annottext">allCombinations :: [[x]] -&gt; [[x]]
</span><a href="#local-6989586621679573366"><span class="hs-identifier hs-var hs-var">allCombinations</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679573347"><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679573347"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679573346"><span class="annot"><span class="annottext">[[x]]
</span><a href="#local-6989586621679573346"><span class="hs-identifier hs-var">ls</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679573345"><span class="annot"><span class="annottext">cs :: [[x]]
</span><a href="#local-6989586621679573345"><span class="hs-identifier hs-var hs-var">cs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[[x]] -&gt; [[x]]
forall x. [[x]] -&gt; [[x]]
</span><a href="#local-6989586621679573366"><span class="hs-identifier hs-var">allCombinations</span></a></span><span> </span><span class="annot"><span class="annottext">[[x]]
</span><a href="#local-6989586621679573346"><span class="hs-identifier hs-var">ls</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">(x -&gt; [[x]]) -&gt; [x] -&gt; [[x]]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679573343"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679573343"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679573343"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">x -&gt; [x] -&gt; [x]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([x] -&gt; [x]) -&gt; [[x]] -&gt; [[x]]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">[[x]]
</span><a href="#local-6989586621679573345"><span class="hs-identifier hs-var">cs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[x]
</span><a href="#local-6989586621679573347"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-171"></span><span>    </span><span class="annot"><a href="#local-6989586621679573366"><span class="hs-identifier hs-var">allCombinations</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">]</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="hs-keyword">data</span><span> </span><span id="DoubleSatLbl"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="DoubleSatLbl"><span class="annot"><a href="Cooked.Attack.DoubleSat.html#DoubleSatLbl"><span class="hs-identifier hs-var">DoubleSatLbl</span></a></span></span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679573339"><span id="local-6989586621679573341"><span class="annot"><span class="annottext">DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
(DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool)
-&gt; (DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool) -&gt; Eq DoubleSatLbl
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c/= :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
== :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
$c== :: DoubleSatLbl -&gt; DoubleSatLbl -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679573332"><span id="local-6989586621679573334"><span id="local-6989586621679573336"><span class="annot"><span class="annottext">Int -&gt; DoubleSatLbl -&gt; ShowS
[DoubleSatLbl] -&gt; ShowS
DoubleSatLbl -&gt; String
(Int -&gt; DoubleSatLbl -&gt; ShowS)
-&gt; (DoubleSatLbl -&gt; String)
-&gt; ([DoubleSatLbl] -&gt; ShowS)
-&gt; Show DoubleSatLbl
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [DoubleSatLbl] -&gt; ShowS
$cshowList :: [DoubleSatLbl] -&gt; ShowS
show :: DoubleSatLbl -&gt; String
$cshow :: DoubleSatLbl -&gt; String
showsPrec :: Int -&gt; DoubleSatLbl -&gt; ShowS
$cshowsPrec :: Int -&gt; DoubleSatLbl -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-175"></span></pre></body></html>