<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-10"></span><span>
</span><span id="line-11"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Output</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-12"></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Ada</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">validatorHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.V2.Typed.Scripts.Validators</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V2.Ledger.Api</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V2.Ledger.Tx</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-21"></span><span>
</span><span id="line-22"></span><span class="hs-comment">-- | A generalisation of 'Pl.TxOut': With the four type families, we can lift</span><span>
</span><span id="line-23"></span><span class="hs-comment">-- some information about who owns the output (a public key, a script...?) and</span><span>
</span><span id="line-24"></span><span class="hs-comment">-- the datum (do we have an inline datum, a datum hash, nothing...?) to the type</span><span>
</span><span id="line-25"></span><span class="hs-comment">-- level.</span><span>
</span><span id="line-26"></span><span class="hs-keyword">class</span><span> </span><span id="IsAbstractOutput"><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-var">IsAbstractOutput</span></a></span></span><span> </span><span id="local-6989586621679505330"><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-comment">-- The owner type can be, in particular, a 'TypedValidator a' or a</span><span>
</span><span id="line-28"></span><span>  </span><span class="hs-comment">-- 'PubkeyHash'</span><span>
</span><span id="line-29"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OwnerType"><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-var">OwnerType</span></a></span></span><span> </span><span id="local-6989586621679505330"><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-30"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DatumType"><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-var">DatumType</span></a></span></span><span> </span><span id="local-6989586621679505330"><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-31"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValueType"><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-var">ValueType</span></a></span></span><span> </span><span id="local-6989586621679505330"><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-32"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ReferenceScriptType"><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-var">ReferenceScriptType</span></a></span></span><span> </span><span id="local-6989586621679505330"><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span></span><span>
</span><span id="line-33"></span><span>  </span><span id="outputOwnerL"><span class="annot"><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-type">outputOwnerL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>  </span><span id="outputStakingCredentialL"><span class="annot"><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-type">outputStakingCredentialL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.StakingCredential</span></span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>  </span><span id="outputDatumL"><span class="annot"><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-type">outputDatumL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span>  </span><span id="outputValueL"><span class="annot"><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-type">outputValueL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span>  </span><span id="outputReferenceScriptL"><span class="annot"><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-type">outputReferenceScriptL</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505330"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span class="hs-keyword">class</span><span> </span><span id="ToCredential"><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-var">ToCredential</span></a></span></span><span> </span><span id="local-6989586621679505387"><span class="annot"><a href="#local-6989586621679505387"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-40"></span><span>  </span><span id="toCredential"><span class="annot"><a href="Cooked.Output.html#toCredential"><span class="hs-identifier hs-type">toCredential</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505387"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Credential</span></span><span>
</span><span id="line-41"></span><span>
</span><span id="line-42"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Credential</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-43"></span><span>  </span><span id="local-6989586621679505203"><span class="annot"><span class="annottext">toCredential :: Credential -&gt; Credential
</span><a href="#local-6989586621679505203"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Credential
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span id="local-6989586621679505201"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505201"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-46"></span><span>  </span><span id="local-6989586621679505199"><span class="annot"><span class="annottext">toCredential :: TypedValidator a -&gt; Credential
</span><a href="#local-6989586621679505199"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; Credential
</span><span class="hs-identifier hs-var">Pl.ScriptCredential</span></span><span> </span><span class="annot"><span class="annottext">(ValidatorHash -&gt; Credential)
-&gt; (TypedValidator a -&gt; ValidatorHash)
-&gt; TypedValidator a
-&gt; Credential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; ValidatorHash
forall a. TypedValidator a -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Pl.validatorHash</span></span></span><span>
</span><span id="line-47"></span><span>
</span><span id="line-48"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-49"></span><span>  </span><span id="local-6989586621679505194"><span class="annot"><span class="annottext">toCredential :: PubKeyHash -&gt; Credential
</span><a href="#local-6989586621679505194"><span class="hs-identifier hs-var hs-var hs-var hs-var">toCredential</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Credential
</span><span class="hs-identifier hs-var">Pl.PubKeyCredential</span></span><span>
</span><span id="line-50"></span><span>
</span><span id="line-51"></span><span class="hs-keyword">class</span><span> </span><span id="ToOutputDatum"><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-var">ToOutputDatum</span></a></span></span><span> </span><span id="local-6989586621679505375"><span class="annot"><a href="#local-6989586621679505375"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-52"></span><span>  </span><span id="toOutputDatum"><span class="annot"><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-type">toOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505375"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-55"></span><span>  </span><span id="local-6989586621679505189"><span class="annot"><span class="annottext">toOutputDatum :: OutputDatum -&gt; OutputDatum
</span><a href="#local-6989586621679505189"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDatum -&gt; OutputDatum
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-58"></span><span>  </span><span id="local-6989586621679505187"><span class="annot"><span class="annottext">toOutputDatum :: Datum -&gt; OutputDatum
</span><a href="#local-6989586621679505187"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatum</span></span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-61"></span><span>  </span><span id="local-6989586621679505184"><span class="annot"><span class="annottext">toOutputDatum :: () -&gt; OutputDatum
</span><a href="#local-6989586621679505184"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDatum -&gt; () -&gt; OutputDatum
forall a b. a -&gt; b -&gt; a
</span><span class="hs-identifier hs-var">const</span></span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Pl.NoOutputDatum</span></span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumHash</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-64"></span><span>  </span><span id="local-6989586621679505180"><span class="annot"><span class="annottext">toOutputDatum :: DatumHash -&gt; OutputDatum
</span><a href="#local-6989586621679505180"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatumHash</span></span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span id="local-6989586621679505178"><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679505178"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-type">ResolvedOrInlineDatum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505178"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-67"></span><span>  </span><span id="local-6989586621679505176"><span class="annot"><span class="annottext">toOutputDatum :: ResolvedOrInlineDatum a -&gt; OutputDatum
</span><a href="#local-6989586621679505176"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-type">ResolvedOrInlineDatum</span></a></span><span> </span><span id="local-6989586621679505174"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505174"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatum</span></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; OutputDatum) -&gt; (a -&gt; Datum) -&gt; a -&gt; OutputDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; (a -&gt; BuiltinData) -&gt; a -&gt; Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; OutputDatum) -&gt; a -&gt; OutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679505174"><span class="hs-identifier hs-var">x</span></a></span></span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">class</span><span> </span><span id="ToValue"><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-var">ToValue</span></a></span></span><span> </span><span id="local-6989586621679505360"><span class="annot"><a href="#local-6989586621679505360"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-70"></span><span>  </span><span id="toValue"><span class="annot"><a href="Cooked.Output.html#toValue"><span class="hs-identifier hs-type">toValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505360"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-71"></span><span>
</span><span id="line-72"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-type">ToValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-73"></span><span>  </span><span id="local-6989586621679505168"><span class="annot"><span class="annottext">toValue :: Value -&gt; Value
</span><a href="#local-6989586621679505168"><span class="hs-identifier hs-var hs-var hs-var hs-var">toValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-74"></span><span>
</span><span id="line-75"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-type">ToValue</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Ada</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-76"></span><span>  </span><span id="local-6989586621679505166"><span class="annot"><span class="annottext">toValue :: Ada -&gt; Value
</span><a href="#local-6989586621679505166"><span class="hs-identifier hs-var hs-var hs-var hs-var">toValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ada -&gt; Value
</span><span class="hs-identifier hs-var">Pl.toValue</span></span><span>
</span><span id="line-77"></span><span>
</span><span id="line-78"></span><span class="hs-keyword">class</span><span> </span><span id="ToScript"><span class="annot"><a href="Cooked.Output.html#ToScript"><span class="hs-identifier hs-var">ToScript</span></a></span></span><span> </span><span id="local-6989586621679505355"><span class="annot"><a href="#local-6989586621679505355"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-79"></span><span>  </span><span id="toScript"><span class="annot"><a href="Cooked.Output.html#toScript"><span class="hs-identifier hs-type">toScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505355"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Script</span></span><span>
</span><span id="line-80"></span><span>
</span><span id="line-81"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScript"><span class="hs-identifier hs-type">ToScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Script</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-82"></span><span>  </span><span id="local-6989586621679505161"><span class="annot"><span class="annottext">toScript :: Versioned Script -&gt; Versioned Script
</span><a href="#local-6989586621679505161"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; Versioned Script
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScript"><span class="hs-identifier hs-type">ToScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-85"></span><span>  </span><span id="local-6989586621679505159"><span class="annot"><span class="annottext">toScript :: Versioned Validator -&gt; Versioned Script
</span><a href="#local-6989586621679505159"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScript</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span> </span><span id="local-6989586621679505156"><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679505156"><span class="hs-identifier hs-var">script</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679505155"><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679505155"><span class="hs-identifier hs-var">version</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Script -&gt; Language -&gt; Versioned Script
forall script. script -&gt; Language -&gt; Versioned script
</span><span class="hs-identifier hs-var">Pl.Versioned</span></span><span> </span><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679505156"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="annot"><span class="annottext">Language
</span><a href="#local-6989586621679505155"><span class="hs-identifier hs-var">version</span></a></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span id="local-6989586621679505154"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScript"><span class="hs-identifier hs-type">ToScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505154"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-88"></span><span>  </span><span id="local-6989586621679505152"><span class="annot"><span class="annottext">toScript :: TypedValidator a -&gt; Versioned Script
</span><a href="#local-6989586621679505152"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; Versioned Script
forall a. ToScript a =&gt; a -&gt; Versioned Script
</span><a href="Cooked.Output.html#toScript"><span class="hs-identifier hs-var">toScript</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Validator -&gt; Versioned Script)
-&gt; (TypedValidator a -&gt; Versioned Validator)
-&gt; TypedValidator a
-&gt; Versioned Script
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Versioned Validator
forall a. TypedValidator a -&gt; Versioned Validator
</span><span class="hs-identifier hs-var">Pl.vValidatorScript</span></span></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="hs-keyword">class</span><span> </span><span id="ToScriptHash"><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-var">ToScriptHash</span></a></span></span><span> </span><span id="local-6989586621679505347"><span class="annot"><a href="#local-6989586621679505347"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-91"></span><span>  </span><span id="toScriptHash"><span class="annot"><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-type">toScriptHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505347"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span>
</span><span id="line-92"></span><span>
</span><span id="line-93"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-94"></span><span>  </span><span id="local-6989586621679505147"><span class="annot"><span class="annottext">toScriptHash :: ScriptHash -&gt; ScriptHash
</span><a href="#local-6989586621679505147"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ScriptHash -&gt; ScriptHash
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-95"></span><span>
</span><span id="line-96"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Script</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-97"></span><span>  </span><span id="local-6989586621679505145"><span class="annot"><span class="annottext">toScriptHash :: Versioned Script -&gt; ScriptHash
</span><a href="#local-6989586621679505145"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; ScriptHash
</span><span class="hs-identifier hs-var">Pl.scriptHash</span></span><span>
</span><span id="line-98"></span><span>
</span><span id="line-99"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-100"></span><span>  </span><span id="local-6989586621679505142"><span class="annot"><span class="annottext">toScriptHash :: Versioned Validator -&gt; ScriptHash
</span><a href="#local-6989586621679505142"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Script -&gt; ScriptHash
forall a. ToScriptHash a =&gt; a -&gt; ScriptHash
</span><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">(Versioned Script -&gt; ScriptHash)
-&gt; (Versioned Validator -&gt; Versioned Script)
-&gt; Versioned Validator
-&gt; ScriptHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; Versioned Script
forall a. ToScript a =&gt; a -&gt; Versioned Script
</span><a href="Cooked.Output.html#toScript"><span class="hs-identifier hs-var">toScript</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-103"></span><span>  </span><span id="local-6989586621679505140"><span class="annot"><span class="annottext">toScriptHash :: ValidatorHash -&gt; ScriptHash
</span><a href="#local-6989586621679505140"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScriptHash</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></span><span> </span><span id="local-6989586621679505138"><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679505138"><span class="hs-identifier hs-var">h</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinByteString -&gt; ScriptHash
</span><span class="hs-identifier hs-var">Pl.ScriptHash</span></span><span> </span><span class="annot"><span class="annottext">BuiltinByteString
</span><a href="#local-6989586621679505138"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span id="local-6989586621679505136"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505136"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-106"></span><span>  </span><span id="local-6989586621679505134"><span class="annot"><span class="annottext">toScriptHash :: TypedValidator a -&gt; ScriptHash
</span><a href="#local-6989586621679505134"><span class="hs-identifier hs-var hs-var hs-var hs-var">toScriptHash</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; ScriptHash
forall a. ToScriptHash a =&gt; a -&gt; ScriptHash
</span><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ValidatorHash -&gt; ScriptHash)
-&gt; (TypedValidator a -&gt; ValidatorHash)
-&gt; TypedValidator a
-&gt; ScriptHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; ValidatorHash
forall a. TypedValidator a -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Pl.validatorHash</span></span></span><span>
</span><span id="line-107"></span><span>
</span><span id="line-108"></span><span class="hs-comment">-- | An output that can be translated into its script-perspective (as seen on the 'TxInfo') representation</span><span>
</span><span id="line-109"></span><span class="hs-keyword">type</span><span> </span><span id="IsOnchainOutput"><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-var">IsOnchainOutput</span></a></span></span><span> </span><span id="local-6989586621679505133"><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-type">ToValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505133"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span id="local-6989586621679505316"><span class="annot"><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-type">outputAddress</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505316"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505316"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679505316"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span></span><span>
</span><span id="line-118"></span><span id="outputAddress"><span class="annot"><span class="annottext">outputAddress :: o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var hs-var">outputAddress</span></a></span></span><span> </span><span id="local-6989586621679505131"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505131"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential -&gt; Maybe StakingCredential -&gt; Address
</span><span class="hs-identifier hs-var">Pl.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OwnerType o -&gt; Credential
forall a. ToCredential a =&gt; a -&gt; Credential
</span><a href="Cooked.Output.html#toCredential"><span class="hs-identifier hs-var">toCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505131"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens NoIx o (OwnerType o) -&gt; OwnerType o
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (OwnerType o)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505131"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">o
-&gt; Optic' A_Lens NoIx o (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span id="local-6989586621679505314"><span class="annot"><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-type">outputOutputDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505314"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505314"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679505314"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span></span><span>
</span><span id="line-121"></span><span id="outputOutputDatum"><span class="annot"><span class="annottext">outputOutputDatum :: o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var hs-var">outputOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumType o -&gt; OutputDatum
forall a. ToOutputDatum a =&gt; a -&gt; OutputDatum
</span><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-var">toOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(DatumType o -&gt; OutputDatum)
-&gt; (o -&gt; DatumType o) -&gt; o -&gt; OutputDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens NoIx o (DatumType o) -&gt; DatumType o
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (DatumType o)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-122"></span><span>
</span><span id="line-123"></span><span id="local-6989586621679505315"><span class="annot"><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-type">outputValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505315"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-type">ToValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505315"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679505315"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span></span><span>
</span><span id="line-124"></span><span id="outputValue"><span class="annot"><span class="annottext">outputValue :: o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var hs-var">outputValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ValueType o -&gt; Value
forall a. ToValue a =&gt; a -&gt; Value
</span><a href="Cooked.Output.html#toValue"><span class="hs-identifier hs-var">toValue</span></a></span><span> </span><span class="annot"><span class="annottext">(ValueType o -&gt; Value) -&gt; (o -&gt; ValueType o) -&gt; o -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens NoIx o (ValueType o) -&gt; ValueType o
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (ValueType o)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>
</span><span id="line-126"></span><span id="local-6989586621679505313"><span class="annot"><a href="Cooked.Output.html#outputReferenceScript"><span class="hs-identifier hs-type">outputReferenceScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505313"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505313"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679505313"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span></span><span>
</span><span id="line-127"></span><span id="outputReferenceScript"><span class="annot"><span class="annottext">outputReferenceScript :: o -&gt; Maybe ScriptHash
</span><a href="Cooked.Output.html#outputReferenceScript"><span class="hs-identifier hs-var hs-var">outputReferenceScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReferenceScriptType o -&gt; ScriptHash
forall a. ToScriptHash a =&gt; a -&gt; ScriptHash
</span><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ReferenceScriptType o -&gt; ScriptHash)
-&gt; Maybe (ReferenceScriptType o) -&gt; Maybe ScriptHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (ReferenceScriptType o) -&gt; Maybe ScriptHash)
-&gt; (o -&gt; Maybe (ReferenceScriptType o)) -&gt; o -&gt; Maybe ScriptHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
-&gt; Optic' A_Lens NoIx o (Maybe (ReferenceScriptType o))
-&gt; Maybe (ReferenceScriptType o)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx o (Maybe (ReferenceScriptType o))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>
</span><span id="line-129"></span><span class="hs-comment">-- | Return the output as it is seen by a validator. In particular the</span><span>
</span><span id="line-130"></span><span class="hs-comment">-- correctness of this specification will depend on the 'IsOnchainOutput' instance, so</span><span>
</span><span id="line-131"></span><span class="hs-comment">-- make sure you get these instances (in particular the functions 'outputAddress',</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- 'outputOutputDatum', and 'outputValue') right!</span><span>
</span><span id="line-133"></span><span id="local-6989586621679505124"><span class="annot"><a href="Cooked.Output.html#outputTxOut"><span class="hs-identifier hs-type">outputTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505124"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679505124"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span></span><span>
</span><span id="line-134"></span><span id="outputTxOut"><span class="annot"><span class="annottext">outputTxOut :: o -&gt; TxOut
</span><a href="Cooked.Output.html#outputTxOut"><span class="hs-identifier hs-var hs-var">outputTxOut</span></a></span></span><span> </span><span id="local-6989586621679505122"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505122"><span class="hs-identifier hs-var">o</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-135"></span><span>  </span><span class="annot"><span class="annottext">Address -&gt; Value -&gt; OutputDatum -&gt; Maybe ScriptHash -&gt; TxOut
</span><span class="hs-identifier hs-var">Pl.TxOut</span></span><span>
</span><span id="line-136"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505122"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505122"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-138"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505122"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o -&gt; Maybe ScriptHash
forall o.
(IsAbstractOutput o, ToScriptHash (ReferenceScriptType o)) =&gt;
o -&gt; Maybe ScriptHash
</span><a href="Cooked.Output.html#outputReferenceScript"><span class="hs-identifier hs-var">outputReferenceScript</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679505122"><span class="hs-identifier hs-var">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-comment">-- ** 'Pl.TxOut's are outputs</span><span>
</span><span id="line-142"></span><span>
</span><span id="line-143"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-144"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OwnerType"><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-var">OwnerType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Credential</span></span><span>
</span><span id="line-145"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DatumType"><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-var">DatumType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span>
</span><span id="line-146"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValueType"><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-var">ValueType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ReferenceScriptType"><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-var">ReferenceScriptType</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span>
</span><span id="line-148"></span><span>  </span><span id="local-6989586621679505114"><span class="annot"><span class="annottext">outputOwnerL :: Lens' TxOut (OwnerType TxOut)
</span><a href="#local-6989586621679505114"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputOwnerL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>    </span><span class="annot"><span class="annottext">LensVL TxOut TxOut Address Address
-&gt; Lens TxOut TxOut Address Address
forall s t a b. LensVL s t a b -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lensVL</span></span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut Address Address
</span><span class="hs-identifier hs-var">Pl.outAddress</span></span><span>
</span><span id="line-150"></span><span>      </span><span class="annot"><span class="annottext">Lens TxOut TxOut Address Address
-&gt; Optic A_Lens NoIx Address Address Credential Credential
-&gt; Optic A_Lens NoIx TxOut TxOut Credential Credential
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Credential)
-&gt; (Address -&gt; Credential -&gt; Address)
-&gt; Optic A_Lens NoIx Address Address Credential Credential
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span>
</span><span id="line-151"></span><span>        </span><span class="annot"><span class="annottext">Address -&gt; Credential
</span><span class="hs-identifier hs-var hs-var">Pl.addressCredential</span></span><span>
</span><span id="line-152"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505108"><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679505108"><span class="hs-identifier hs-var">addr</span></a></span></span><span> </span><span id="local-6989586621679505107"><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679505107"><span class="hs-identifier hs-var">cred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Address
</span><a href="#local-6989586621679505108"><span class="hs-identifier hs-var">addr</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">addressCredential :: Credential
</span><span class="hs-identifier hs-var">Pl.addressCredential</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Credential
</span><a href="#local-6989586621679505107"><span class="hs-identifier hs-var">cred</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-153"></span><span>  </span><span id="local-6989586621679505106"><span class="annot"><span class="annottext">outputDatumL :: Lens' TxOut (DatumType TxOut)
</span><a href="#local-6989586621679505106"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputDatumL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut OutputDatum OutputDatum
-&gt; Lens TxOut TxOut OutputDatum OutputDatum
forall s t a b. LensVL s t a b -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lensVL</span></span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut OutputDatum OutputDatum
</span><span class="hs-identifier hs-var">Pl.outDatum</span></span><span>
</span><span id="line-154"></span><span>  </span><span id="local-6989586621679505104"><span class="annot"><span class="annottext">outputStakingCredentialL :: Lens' TxOut (Maybe StakingCredential)
</span><a href="#local-6989586621679505104"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputStakingCredentialL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-155"></span><span>    </span><span class="annot"><span class="annottext">(TxOut -&gt; Maybe StakingCredential)
-&gt; (TxOut -&gt; Maybe StakingCredential -&gt; TxOut)
-&gt; Lens' TxOut (Maybe StakingCredential)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span>
</span><span id="line-156"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address -&gt; Maybe StakingCredential
</span><span class="hs-identifier hs-var hs-var">Pl.addressStakingCredential</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Maybe StakingCredential)
-&gt; (TxOut -&gt; Address) -&gt; TxOut -&gt; Maybe StakingCredential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><span class="hs-identifier hs-var hs-var">Pl.txOutAddress</span></span><span class="hs-special">)</span><span>
</span><span id="line-157"></span><span>      </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679505101"><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679505101"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505100"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679505100"><span class="hs-identifier hs-var">mStCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-158"></span><span>          </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679505101"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">txOutAddress :: Address
</span><span class="hs-identifier hs-var">Pl.txOutAddress</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxOut -&gt; Address
</span><span class="hs-identifier hs-var hs-var">Pl.txOutAddress</span></span><span> </span><span class="annot"><span class="annottext">TxOut
</span><a href="#local-6989586621679505101"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">addressStakingCredential :: Maybe StakingCredential
</span><span class="hs-identifier hs-var">Pl.addressStakingCredential</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679505100"><span class="hs-identifier hs-var">mStCred</span></a></span><span class="hs-special">}</span><span class="hs-special">}</span><span>
</span><span id="line-159"></span><span>      </span><span class="hs-special">)</span><span>
</span><span id="line-160"></span><span>  </span><span id="local-6989586621679505099"><span class="annot"><span class="annottext">outputValueL :: Lens' TxOut (ValueType TxOut)
</span><a href="#local-6989586621679505099"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputValueL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut Value Value -&gt; Lens TxOut TxOut Value Value
forall s t a b. LensVL s t a b -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lensVL</span></span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut Value Value
</span><span class="hs-identifier hs-var">Pl.outValue</span></span><span>
</span><span id="line-161"></span><span>  </span><span id="local-6989586621679505097"><span class="annot"><span class="annottext">outputReferenceScriptL :: Lens' TxOut (Maybe (ReferenceScriptType TxOut))
</span><a href="#local-6989586621679505097"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputReferenceScriptL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut (Maybe ScriptHash) (Maybe ScriptHash)
-&gt; Lens TxOut TxOut (Maybe ScriptHash) (Maybe ScriptHash)
forall s t a b. LensVL s t a b -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lensVL</span></span><span> </span><span class="annot"><span class="annottext">LensVL TxOut TxOut (Maybe ScriptHash) (Maybe ScriptHash)
</span><span class="hs-identifier hs-var">Pl.outReferenceScript</span></span><span>
</span><span id="line-162"></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- ** A concrete type for outputs</span><span>
</span><span id="line-164"></span><span>
</span><span id="line-165"></span><span class="hs-keyword">data</span><span> </span><span id="ConcreteOutput"><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span></span><span> </span><span id="local-6989586621679505095"><span class="annot"><a href="#local-6989586621679505095"><span class="hs-identifier hs-type">ownerType</span></a></span></span><span> </span><span id="local-6989586621679505094"><span class="annot"><a href="#local-6989586621679505094"><span class="hs-identifier hs-type">datumType</span></a></span></span><span> </span><span id="local-6989586621679505093"><span class="annot"><a href="#local-6989586621679505093"><span class="hs-identifier hs-type">valueType</span></a></span></span><span> </span><span id="local-6989586621679505092"><span class="annot"><a href="#local-6989586621679505092"><span class="hs-identifier hs-type">referenceScriptType</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-166"></span><span>  </span><span id="local-6989586621679505247"><span id="local-6989586621679505248"><span id="local-6989586621679505249"><span id="local-6989586621679505250"><span id="ConcreteOutput"><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="concreteOutputOwner"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; ownerType
</span><a href="Cooked.Output.html#concreteOutputOwner"><span class="hs-identifier hs-var hs-var">concreteOutputOwner</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505250"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-168"></span><span>      </span><span id="concreteOutputStakingCredential"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe StakingCredential
</span><a href="Cooked.Output.html#concreteOutputStakingCredential"><span class="hs-identifier hs-var hs-var">concreteOutputStakingCredential</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.StakingCredential</span></span><span class="hs-special">,</span><span>
</span><span id="line-169"></span><span>      </span><span id="concreteOutputValue"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; valueType
</span><a href="Cooked.Output.html#concreteOutputValue"><span class="hs-identifier hs-var hs-var">concreteOutputValue</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505248"><span class="hs-identifier hs-type">valueType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>      </span><span id="concreteOutputDatum"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; datumType
</span><a href="Cooked.Output.html#concreteOutputDatum"><span class="hs-identifier hs-var hs-var">concreteOutputDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679505249"><span class="hs-identifier hs-type">datumType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-171"></span><span>      </span><span id="concreteOutputReferenceScript"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe referenceScriptType
</span><a href="Cooked.Output.html#concreteOutputReferenceScript"><span class="hs-identifier hs-var hs-var">concreteOutputReferenceScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679505247"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-173"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505250"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505249"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505248"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505247"><span class="hs-identifier hs-type">referenceScriptType</span></a></span></span></span></span></span><span>
</span><span id="line-174"></span><span>
</span><span id="line-175"></span><span id="local-6989586621679505076"><span id="local-6989586621679505078"><span id="local-6989586621679505080"><span id="local-6989586621679505082"><span id="local-6989586621679505083"><span id="local-6989586621679505084"><span id="local-6989586621679505085"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679505085"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679505084"><span class="hs-identifier hs-type">datumType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679505083"><span class="hs-identifier hs-type">valueType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679505082"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505085"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505084"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505083"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505082"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-176"></span><span>
</span><span id="line-177"></span><span id="local-6989586621679505067"><span id="local-6989586621679505069"><span id="local-6989586621679505071"><span id="local-6989586621679505072"><span id="local-6989586621679505073"><span id="local-6989586621679505074"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679505074"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679505073"><span class="hs-identifier hs-type">datumType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679505072"><span class="hs-identifier hs-type">valueType</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679505071"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505074"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505073"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505072"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505071"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span id="local-6989586621679505062"><span id="local-6989586621679505063"><span id="local-6989586621679505064"><span id="local-6989586621679505065"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-180"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="OwnerType"><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-var">OwnerType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="DatumType"><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-var">DatumType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span>
</span><span id="line-182"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ValueType"><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-var">ValueType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">type</span><span> </span><span id="ReferenceScriptType"><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-var">ReferenceScriptType</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505065"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505064"><span class="hs-identifier hs-type">datumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505063"><span class="hs-identifier hs-type">valueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="#local-6989586621679505062"><span class="hs-identifier hs-type">referenceScriptType</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span id="local-6989586621679505056"><span class="annot"><span class="annottext">outputOwnerL :: Lens'
  (ConcreteOutput ownerType datumType valueType referenceScriptType)
  (OwnerType
     (ConcreteOutput ownerType datumType valueType referenceScriptType))
</span><a href="#local-6989586621679505056"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputOwnerL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType datumType valueType referenceScriptType
 -&gt; ownerType)
-&gt; (ConcreteOutput
      ownerType datumType valueType referenceScriptType
    -&gt; ownerType
    -&gt; ConcreteOutput
         ownerType datumType valueType referenceScriptType)
-&gt; Lens
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     ownerType
     ownerType
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; ownerType
forall ownerType datumType valueType referenceScriptType.
ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; ownerType
</span><a href="Cooked.Output.html#concreteOutputOwner"><span class="hs-identifier hs-var hs-var">concreteOutputOwner</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505055"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505055"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505054"><span class="annot"><span class="annottext">ownerType
</span><a href="#local-6989586621679505054"><span class="hs-identifier hs-var">owner</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505055"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">concreteOutputOwner :: ownerType
</span><a href="Cooked.Output.html#concreteOutputOwner"><span class="hs-identifier hs-var">concreteOutputOwner</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ownerType
</span><a href="#local-6989586621679505054"><span class="hs-identifier hs-var">owner</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-185"></span><span>  </span><span id="local-6989586621679505053"><span class="annot"><span class="annottext">outputStakingCredentialL :: Lens'
  (ConcreteOutput ownerType datumType valueType referenceScriptType)
  (Maybe StakingCredential)
</span><a href="#local-6989586621679505053"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputStakingCredentialL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType datumType valueType referenceScriptType
 -&gt; Maybe StakingCredential)
-&gt; (ConcreteOutput
      ownerType datumType valueType referenceScriptType
    -&gt; Maybe StakingCredential
    -&gt; ConcreteOutput
         ownerType datumType valueType referenceScriptType)
-&gt; Lens'
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (Maybe StakingCredential)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe StakingCredential
forall ownerType datumType valueType referenceScriptType.
ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe StakingCredential
</span><a href="Cooked.Output.html#concreteOutputStakingCredential"><span class="hs-identifier hs-var hs-var">concreteOutputStakingCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505052"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505052"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505051"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679505051"><span class="hs-identifier hs-var">mStCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505052"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">concreteOutputStakingCredential :: Maybe StakingCredential
</span><a href="Cooked.Output.html#concreteOutputStakingCredential"><span class="hs-identifier hs-var">concreteOutputStakingCredential</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679505051"><span class="hs-identifier hs-var">mStCred</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-186"></span><span>  </span><span id="local-6989586621679505050"><span class="annot"><span class="annottext">outputDatumL :: Lens'
  (ConcreteOutput ownerType datumType valueType referenceScriptType)
  (DatumType
     (ConcreteOutput ownerType datumType valueType referenceScriptType))
</span><a href="#local-6989586621679505050"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputDatumL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType datumType valueType referenceScriptType
 -&gt; datumType)
-&gt; (ConcreteOutput
      ownerType datumType valueType referenceScriptType
    -&gt; datumType
    -&gt; ConcreteOutput
         ownerType datumType valueType referenceScriptType)
-&gt; Lens
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     datumType
     datumType
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; datumType
forall ownerType datumType valueType referenceScriptType.
ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; datumType
</span><a href="Cooked.Output.html#concreteOutputDatum"><span class="hs-identifier hs-var hs-var">concreteOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505049"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505049"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505048"><span class="annot"><span class="annottext">datumType
</span><a href="#local-6989586621679505048"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505049"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">concreteOutputDatum :: datumType
</span><a href="Cooked.Output.html#concreteOutputDatum"><span class="hs-identifier hs-var">concreteOutputDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">datumType
</span><a href="#local-6989586621679505048"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-187"></span><span>  </span><span id="local-6989586621679505047"><span class="annot"><span class="annottext">outputValueL :: Lens'
  (ConcreteOutput ownerType datumType valueType referenceScriptType)
  (ValueType
     (ConcreteOutput ownerType datumType valueType referenceScriptType))
</span><a href="#local-6989586621679505047"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputValueL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType datumType valueType referenceScriptType
 -&gt; valueType)
-&gt; (ConcreteOutput
      ownerType datumType valueType referenceScriptType
    -&gt; valueType
    -&gt; ConcreteOutput
         ownerType datumType valueType referenceScriptType)
-&gt; Lens
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     valueType
     valueType
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; valueType
forall ownerType datumType valueType referenceScriptType.
ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; valueType
</span><a href="Cooked.Output.html#concreteOutputValue"><span class="hs-identifier hs-var hs-var">concreteOutputValue</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505046"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505046"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505045"><span class="annot"><span class="annottext">valueType
</span><a href="#local-6989586621679505045"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505046"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">concreteOutputValue :: valueType
</span><a href="Cooked.Output.html#concreteOutputValue"><span class="hs-identifier hs-var">concreteOutputValue</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">valueType
</span><a href="#local-6989586621679505045"><span class="hs-identifier hs-var">value</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span><span>
</span><span id="line-188"></span><span>  </span><span id="local-6989586621679505044"><span class="annot"><span class="annottext">outputReferenceScriptL :: Lens'
  (ConcreteOutput ownerType datumType valueType referenceScriptType)
  (Maybe
     (ReferenceScriptType
        (ConcreteOutput
           ownerType datumType valueType referenceScriptType)))
</span><a href="#local-6989586621679505044"><span class="hs-identifier hs-var hs-var hs-var hs-var">outputReferenceScriptL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType datumType valueType referenceScriptType
 -&gt; Maybe referenceScriptType)
-&gt; (ConcreteOutput
      ownerType datumType valueType referenceScriptType
    -&gt; Maybe referenceScriptType
    -&gt; ConcreteOutput
         ownerType datumType valueType referenceScriptType)
-&gt; Lens
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (ConcreteOutput ownerType datumType valueType referenceScriptType)
     (Maybe referenceScriptType)
     (Maybe referenceScriptType)
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe referenceScriptType
forall ownerType datumType valueType referenceScriptType.
ConcreteOutput ownerType datumType valueType referenceScriptType
-&gt; Maybe referenceScriptType
</span><a href="Cooked.Output.html#concreteOutputReferenceScript"><span class="hs-identifier hs-var hs-var">concreteOutputReferenceScript</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679505043"><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505043"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span id="local-6989586621679505042"><span class="annot"><span class="annottext">Maybe referenceScriptType
</span><a href="#local-6989586621679505042"><span class="hs-identifier hs-var">mRefScript</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="#local-6989586621679505043"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">concreteOutputReferenceScript :: Maybe referenceScriptType
</span><a href="Cooked.Output.html#concreteOutputReferenceScript"><span class="hs-identifier hs-var">concreteOutputReferenceScript</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe referenceScriptType
</span><a href="#local-6989586621679505042"><span class="hs-identifier hs-var">mRefScript</span></a></span><span class="hs-special">}</span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- ** A few special concrete outputs</span><span>
</span><span id="line-191"></span><span>
</span><span id="line-192"></span><span class="hs-comment">-- | A public key output that only has Ada and no datum</span><span>
</span><span id="line-193"></span><span class="hs-keyword">type</span><span> </span><span id="PKAdaOnlyOutput"><span class="annot"><a href="Cooked.Output.html#PKAdaOnlyOutput"><span class="hs-identifier hs-var">PKAdaOnlyOutput</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Ada</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span>
</span><span id="line-194"></span><span>
</span><span id="line-195"></span><span class="hs-comment">-- | A public key output where we don't know anything about the datum: It is a</span><span>
</span><span id="line-196"></span><span class="hs-comment">-- general 'Pl.OutputDatum'</span><span>
</span><span id="line-197"></span><span class="hs-keyword">type</span><span> </span><span id="PKOutputMaybeDatum"><span class="annot"><a href="Cooked.Output.html#PKOutputMaybeDatum"><span class="hs-identifier hs-var">PKOutputMaybeDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span>
</span><span id="line-198"></span><span>
</span><span id="line-199"></span><span class="hs-comment">-- | An output that belongs to a typed validator and has an inline datum of the</span><span>
</span><span id="line-200"></span><span class="hs-comment">-- appropriate type.</span><span>
</span><span id="line-201"></span><span class="hs-keyword">type</span><span> </span><span id="ScriptOutputWithInlineDatum"><span class="annot"><a href="Cooked.Output.html#ScriptOutputWithInlineDatum"><span class="hs-identifier hs-var">ScriptOutputWithInlineDatum</span></a></span></span><span> </span><span id="local-6989586621679505038"><span class="annot"><a href="#local-6989586621679505038"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505038"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679505038"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span><span>
</span><span id="line-202"></span><span>
</span><span id="line-203"></span><span class="hs-comment">-- TODO et cetera</span><span>
</span><span id="line-204"></span><span>
</span><span id="line-205"></span><span class="hs-comment">-- ** Functions to translate between different output types</span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span id="local-6989586621679505037"><span class="annot"><a href="Cooked.Output.html#toOutputWithReferenceScriptHash"><span class="hs-identifier hs-type">toOutputWithReferenceScriptHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-208"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToScriptHash"><span class="hs-identifier hs-type">ToScriptHash</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505037"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptHash</span></span></span><span>
</span><span id="line-211"></span><span id="toOutputWithReferenceScriptHash"><span class="annot"><span class="annottext">toOutputWithReferenceScriptHash :: output
-&gt; ConcreteOutput
     (OwnerType output) (DatumType output) (ValueType output) ScriptHash
</span><a href="Cooked.Output.html#toOutputWithReferenceScriptHash"><span class="hs-identifier hs-var hs-var">toOutputWithReferenceScriptHash</span></a></span></span><span> </span><span id="local-6989586621679505035"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-212"></span><span>  </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; DatumType output
-&gt; Maybe ScriptHash
-&gt; ConcreteOutput
     (OwnerType output) (DatumType output) (ValueType output) ScriptHash
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-213"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-214"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-216"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (DatumType output) -&gt; DatumType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (DatumType output)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-217"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReferenceScriptType output -&gt; ScriptHash
forall a. ToScriptHash a =&gt; a -&gt; ScriptHash
</span><a href="Cooked.Output.html#toScriptHash"><span class="hs-identifier hs-var">toScriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">(ReferenceScriptType output -&gt; ScriptHash)
-&gt; Maybe (ReferenceScriptType output) -&gt; Maybe ScriptHash
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505035"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-comment">-- | Test if there is no datum on an output. If there is no datum, return an</span><span>
</span><span id="line-220"></span><span class="hs-comment">-- output with the same 'OwnerType', but with @()@ as its 'DatumType'.</span><span>
</span><span id="line-221"></span><span id="local-6989586621679505034"><span class="annot"><a href="Cooked.Output.html#isOutputWithoutDatum"><span class="hs-identifier hs-type">isOutputWithoutDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-222"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505034"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><a href="#local-6989586621679505034"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505034"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505034"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505034"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-225"></span><span id="isOutputWithoutDatum"><span class="annot"><span class="annottext">isOutputWithoutDatum :: output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        ()
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOutputWithoutDatum"><span class="hs-identifier hs-var hs-var">isOutputWithoutDatum</span></a></span></span><span> </span><span id="local-6989586621679505032"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-226"></span><span>  </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Pl.NoOutputDatum</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-227"></span><span>    </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType output)
  ()
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        ()
        (ValueType output)
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType output)
   ()
   (ValueType output)
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType output)
         ()
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     (OwnerType output)
     ()
     (ValueType output)
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        ()
        (ValueType output)
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-228"></span><span>      </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; ()
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     ()
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-229"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-230"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-232"></span><span>        </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-233"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505032"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>  </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     ()
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-235"></span><span>
</span><span id="line-236"></span><span class="hs-comment">-- ** Functions to translate between different output types</span><span>
</span><span id="line-237"></span><span>
</span><span id="line-238"></span><span class="hs-comment">-- | Test if the output carries some inlined datum (lose the type information</span><span>
</span><span id="line-239"></span><span class="hs-comment">-- about the datum in favour of Plutus' 'Datum' type).</span><span>
</span><span id="line-240"></span><span id="local-6989586621679505031"><span class="annot"><a href="Cooked.Output.html#isOutputWithInlineDatumUntyped"><span class="hs-identifier hs-type">isOutputWithInlineDatumUntyped</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-241"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505031"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-242"></span><span>  </span><span class="annot"><a href="#local-6989586621679505031"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505031"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505031"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505031"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-244"></span><span id="isOutputWithInlineDatumUntyped"><span class="annot"><span class="annottext">isOutputWithInlineDatumUntyped :: output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        Datum
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOutputWithInlineDatumUntyped"><span class="hs-identifier hs-var hs-var">isOutputWithInlineDatumUntyped</span></a></span></span><span> </span><span id="local-6989586621679505029"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-245"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span> </span><span id="local-6989586621679505028"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679505028"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-247"></span><span>      </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType output)
  Datum
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        Datum
        (ValueType output)
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType output)
   Datum
   (ValueType output)
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType output)
         Datum
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     (OwnerType output)
     Datum
     (ValueType output)
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        Datum
        (ValueType output)
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-248"></span><span>        </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; Datum
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     Datum
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-249"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-250"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-251"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-252"></span><span>          </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679505028"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-253"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505029"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>    </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     Datum
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-255"></span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Test if the output carries some inlined datum.</span><span>
</span><span id="line-257"></span><span id="local-6989586621679505027"><span class="annot"><a href="Cooked.Output.html#isOutputWithInlineDatum"><span class="hs-identifier hs-type">isOutputWithInlineDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-258"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505027"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-259"></span><span>  </span><span class="annot"><a href="#local-6989586621679505027"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679505027"><span class="hs-identifier hs-type">output</span></a></span></span><span>
</span><span id="line-261"></span><span id="isOutputWithInlineDatum"><span class="annot"><span class="annottext">isOutputWithInlineDatum :: output -&gt; Maybe output
</span><a href="Cooked.Output.html#isOutputWithInlineDatum"><span class="hs-identifier hs-var hs-var">isOutputWithInlineDatum</span></a></span></span><span> </span><span id="local-6989586621679505025"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505025"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-262"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505025"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-263"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">output -&gt; Maybe output
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505025"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-264"></span><span>    </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe output
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-265"></span><span>
</span><span id="line-266"></span><span class="hs-comment">-- | Test if the output carries some datum hash.</span><span>
</span><span id="line-267"></span><span id="local-6989586621679505024"><span class="annot"><a href="Cooked.Output.html#isOutputWithDatumHash"><span class="hs-identifier hs-type">isOutputWithDatumHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-268"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505024"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-269"></span><span>  </span><span class="annot"><a href="#local-6989586621679505024"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505024"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505024"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505024"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-271"></span><span id="isOutputWithDatumHash"><span class="annot"><span class="annottext">isOutputWithDatumHash :: output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        DatumHash
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOutputWithDatumHash"><span class="hs-identifier hs-var hs-var">isOutputWithDatumHash</span></a></span></span><span> </span><span id="local-6989586621679505022"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-273"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatumHash</span></span><span> </span><span id="local-6989586621679505021"><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679505021"><span class="hs-identifier hs-var">hash</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>      </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType output)
  DatumHash
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        DatumHash
        (ValueType output)
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType output)
   DatumHash
   (ValueType output)
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType output)
         DatumHash
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     (OwnerType output)
     DatumHash
     (ValueType output)
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        DatumHash
        (ValueType output)
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-275"></span><span>        </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; DatumHash
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     DatumHash
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-276"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-277"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Address -&gt; Maybe StakingCredential
</span><span class="hs-identifier hs-var hs-var">Pl.addressStakingCredential</span></span><span> </span><span class="annot"><span class="annottext">(Address -&gt; Maybe StakingCredential)
-&gt; (output -&gt; Address) -&gt; output -&gt; Maybe StakingCredential
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">output -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">(output -&gt; Maybe StakingCredential)
-&gt; output -&gt; Maybe StakingCredential
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-278"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>          </span><span class="annot"><span class="annottext">DatumHash
</span><a href="#local-6989586621679505021"><span class="hs-identifier hs-var">hash</span></a></span><span>
</span><span id="line-280"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505022"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-281"></span><span>    </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     DatumHash
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-282"></span><span>
</span><span id="line-283"></span><span class="hs-comment">-- | Test if the value carried by an output verifies a given predicate.</span><span>
</span><span id="line-284"></span><span id="local-6989586621679505020"><span class="annot"><a href="Cooked.Output.html#isOutputWithValueSuchThat"><span class="hs-identifier hs-type">isOutputWithValueSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-285"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505020"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-286"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505020"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>  </span><span class="annot"><a href="#local-6989586621679505020"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-288"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679505020"><span class="hs-identifier hs-type">output</span></a></span></span><span>
</span><span id="line-289"></span><span id="isOutputWithValueSuchThat"><span class="annot"><span class="annottext">isOutputWithValueSuchThat :: (ValueType output -&gt; Bool) -&gt; output -&gt; Maybe output
</span><a href="Cooked.Output.html#isOutputWithValueSuchThat"><span class="hs-identifier hs-var hs-var">isOutputWithValueSuchThat</span></a></span></span><span> </span><span id="local-6989586621679505018"><span class="annot"><span class="annottext">ValueType output -&gt; Bool
</span><a href="#local-6989586621679505018"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679505017"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505017"><span class="hs-identifier hs-var">out</span></a></span></span><span>
</span><span id="line-290"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ValueType output -&gt; Bool
</span><a href="#local-6989586621679505018"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505017"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">output -&gt; Maybe output
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505017"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-291"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe output
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-292"></span><span>
</span><span id="line-293"></span><span class="hs-comment">-- | Test if the datum carried by an output verifies a given predicate.</span><span>
</span><span id="line-294"></span><span id="local-6989586621679505016"><span class="annot"><a href="Cooked.Output.html#isOutputWithDatumSuchThat"><span class="hs-identifier hs-type">isOutputWithDatumSuchThat</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-295"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsAbstractOutput"><span class="hs-identifier hs-type">IsAbstractOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505016"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-296"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505016"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-297"></span><span>  </span><span class="annot"><a href="#local-6989586621679505016"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-298"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679505016"><span class="hs-identifier hs-type">output</span></a></span></span><span>
</span><span id="line-299"></span><span id="isOutputWithDatumSuchThat"><span class="annot"><span class="annottext">isOutputWithDatumSuchThat :: (DatumType output -&gt; Bool) -&gt; output -&gt; Maybe output
</span><a href="Cooked.Output.html#isOutputWithDatumSuchThat"><span class="hs-identifier hs-var hs-var">isOutputWithDatumSuchThat</span></a></span></span><span> </span><span id="local-6989586621679505014"><span class="annot"><span class="annottext">DatumType output -&gt; Bool
</span><a href="#local-6989586621679505014"><span class="hs-identifier hs-var">predicate</span></a></span></span><span> </span><span id="local-6989586621679505013"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505013"><span class="hs-identifier hs-var">out</span></a></span></span><span>
</span><span id="line-300"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">DatumType output -&gt; Bool
</span><a href="#local-6989586621679505014"><span class="hs-identifier hs-var">predicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505013"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (DatumType output) -&gt; DatumType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (DatumType output)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">output -&gt; Maybe output
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505013"><span class="hs-identifier hs-var">out</span></a></span><span>
</span><span id="line-301"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">otherwise</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe output
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-302"></span><span>
</span><span id="line-303"></span><span class="hs-comment">-- | Wrapper type to make clear that the datum is a resolved or inline datum</span><span>
</span><span id="line-304"></span><span class="hs-keyword">newtype</span><span> </span><span id="ResolvedOrInlineDatum"><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-var">ResolvedOrInlineDatum</span></a></span></span><span> </span><span id="local-6989586621679505234"><span class="annot"><a href="#local-6989586621679505234"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ResolvedOrInlineDatum"><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-var">ResolvedOrInlineDatum</span></a></span></span><span> </span><span class="annot"><a href="#local-6989586621679505234"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679505007"><span id="local-6989586621679505009"><span id="local-6989586621679505011"><span class="annot"><span class="annottext">Int -&gt; ResolvedOrInlineDatum a -&gt; ShowS
[ResolvedOrInlineDatum a] -&gt; ShowS
ResolvedOrInlineDatum a -&gt; String
(Int -&gt; ResolvedOrInlineDatum a -&gt; ShowS)
-&gt; (ResolvedOrInlineDatum a -&gt; String)
-&gt; ([ResolvedOrInlineDatum a] -&gt; ShowS)
-&gt; Show (ResolvedOrInlineDatum a)
forall a. Show a =&gt; Int -&gt; ResolvedOrInlineDatum a -&gt; ShowS
forall a. Show a =&gt; [ResolvedOrInlineDatum a] -&gt; ShowS
forall a. Show a =&gt; ResolvedOrInlineDatum a -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [ResolvedOrInlineDatum a] -&gt; ShowS
$cshowList :: forall a. Show a =&gt; [ResolvedOrInlineDatum a] -&gt; ShowS
show :: ResolvedOrInlineDatum a -&gt; String
$cshow :: forall a. Show a =&gt; ResolvedOrInlineDatum a -&gt; String
showsPrec :: Int -&gt; ResolvedOrInlineDatum a -&gt; ShowS
$cshowsPrec :: forall a. Show a =&gt; Int -&gt; ResolvedOrInlineDatum a -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679505003"><span id="local-6989586621679505005"><span class="annot"><span class="annottext">ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
(ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool)
-&gt; (ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool)
-&gt; Eq (ResolvedOrInlineDatum a)
forall a.
Eq a =&gt;
ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
$c/= :: forall a.
Eq a =&gt;
ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
== :: ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
$c== :: forall a.
Eq a =&gt;
ResolvedOrInlineDatum a -&gt; ResolvedOrInlineDatum a -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>
</span><span id="line-306"></span><span class="hs-comment">-- | Test if an output has an inline datum of a certain type. In most</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- applications, it will make sense to use this with 'filteredUtxosWithDatums',</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- and not with 'filteredUtxos'.</span><span>
</span><span id="line-309"></span><span class="annot"><a href="Cooked.Output.html#isOutputWithDatumOfType"><span class="hs-identifier hs-type">isOutputWithDatumOfType</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-310"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679505216"><span class="annot"><a href="#local-6989586621679505216"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679505215"><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-311"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679505216"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-312"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span><span>
</span><span id="line-313"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-314"></span><span>  </span><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-315"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-type">ResolvedOrInlineDatum</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505216"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505215"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-316"></span><span id="isOutputWithDatumOfType"><span class="annot"><span class="annottext">isOutputWithDatumOfType :: output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (ResolvedOrInlineDatum a)
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOutputWithDatumOfType"><span class="hs-identifier hs-var hs-var">isOutputWithDatumOfType</span></a></span></span><span> </span><span id="local-6989586621679505001"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; OutputDatum
forall o.
(IsAbstractOutput o, ToOutputDatum (DatumType o)) =&gt;
o -&gt; OutputDatum
</span><a href="Cooked.Output.html#outputOutputDatum"><span class="hs-identifier hs-var">outputOutputDatum</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-317"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatumHash</span></span><span> </span><span class="annot"><span class="annottext">DatumHash
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     (ResolvedOrInlineDatum a)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-318"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.OutputDatum</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span> </span><span id="local-6989586621679505000"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679505000"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-319"></span><span>    </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; ResolvedOrInlineDatum a
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     (ResolvedOrInlineDatum a)
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-320"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-321"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-322"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-323"></span><span>      </span><span class="annot"><span class="annottext">(ResolvedOrInlineDatum a
 -&gt; Maybe (ReferenceScriptType output)
 -&gt; ConcreteOutput
      (OwnerType output)
      (ResolvedOrInlineDatum a)
      (ValueType output)
      (ReferenceScriptType output))
-&gt; (a -&gt; ResolvedOrInlineDatum a)
-&gt; a
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     (ResolvedOrInlineDatum a)
     (ValueType output)
     (ReferenceScriptType output)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; ResolvedOrInlineDatum a
forall a. a -&gt; ResolvedOrInlineDatum a
</span><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-var">ResolvedOrInlineDatum</span></a></span><span>
</span><span id="line-324"></span><span>      </span><span class="annot"><span class="annottext">(a
 -&gt; Maybe (ReferenceScriptType output)
 -&gt; ConcreteOutput
      (OwnerType output)
      (ResolvedOrInlineDatum a)
      (ValueType output)
      (ReferenceScriptType output))
-&gt; Maybe a
-&gt; Maybe
     (Maybe (ReferenceScriptType output)
      -&gt; ConcreteOutput
           (OwnerType output)
           (ResolvedOrInlineDatum a)
           (ValueType output)
           (ReferenceScriptType output))
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><span class="hs-identifier hs-var">Pl.fromBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679505000"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-325"></span><span>      </span><span class="annot"><span class="annottext">Maybe
  (Maybe (ReferenceScriptType output)
   -&gt; ConcreteOutput
        (OwnerType output)
        (ResolvedOrInlineDatum a)
        (ValueType output)
        (ReferenceScriptType output))
-&gt; Maybe (Maybe (ReferenceScriptType output))
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (ResolvedOrInlineDatum a)
        (ValueType output)
        (ReferenceScriptType output))
forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;*&gt;</span></span><span> </span><span class="annot"><span class="annottext">Maybe (ReferenceScriptType output)
-&gt; Maybe (Maybe (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679505001"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Pl.NoOutputDatum</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     (ResolvedOrInlineDatum a)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-327"></span><span>
</span><span id="line-328"></span><span class="hs-comment">-- | Test if the owner an output is a specific script. If it is, return an</span><span>
</span><span id="line-329"></span><span class="hs-comment">-- output with the validator type as its 'OwnerType'.</span><span>
</span><span id="line-330"></span><span id="local-6989586621679505221"><span id="local-6989586621679505223"><span class="annot"><a href="Cooked.Output.html#isScriptOutputFrom"><span class="hs-identifier hs-type">isScriptOutputFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-331"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505223"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-332"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505221"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-333"></span><span>  </span><span class="annot"><a href="#local-6989586621679505223"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-334"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679505221"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505223"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505223"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679505223"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span><span>
</span><span id="line-335"></span><span id="isScriptOutputFrom"><span class="annot"><span class="annottext">isScriptOutputFrom :: TypedValidator a
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isScriptOutputFrom"><span class="hs-identifier hs-var hs-var">isScriptOutputFrom</span></a></span></span><span> </span><span id="local-6989586621679504997"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679504997"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span id="local-6989586621679504996"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504996"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-336"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504996"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-337"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.ScriptCredential</span></span><span> </span><span id="local-6989586621679504995"><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679504995"><span class="hs-identifier hs-var">scriptHash</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679504994"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679504994"><span class="hs-identifier hs-var">mStCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-338"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">ValidatorHash
</span><a href="#local-6989586621679504995"><span class="hs-identifier hs-var">scriptHash</span></a></span><span> </span><span class="annot"><span class="annottext">ValidatorHash -&gt; ValidatorHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; ValidatorHash
forall a. TypedValidator a -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Pl.validatorHash</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679504997"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-339"></span><span>        </span><span class="hs-keyword">then</span><span>
</span><span id="line-340"></span><span>          </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a)
  (DatumType output)
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (TypedValidator a)
   (DatumType output)
   (ValueType output)
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         (TypedValidator a)
         (DatumType output)
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     (TypedValidator a)
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-341"></span><span>            </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; DatumType output
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (TypedValidator a)
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-342"></span><span>              </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679504997"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-343"></span><span>              </span><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679504994"><span class="hs-identifier hs-var">mStCred</span></a></span><span>
</span><span id="line-344"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504996"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-345"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504996"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (DatumType output) -&gt; DatumType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (DatumType output)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-346"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504996"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-347"></span><span>        </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (TypedValidator a)
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (TypedValidator a)
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | like 'isScriptOutputFrom', but also makes sure that the output has an</span><span>
</span><span id="line-351"></span><span class="hs-comment">-- inline datum of the correct type. In most applications, it will make sense to</span><span>
</span><span id="line-352"></span><span class="hs-comment">-- use this with 'filteredUtxosWithDatums', and not with 'filteredUtxos'.</span><span>
</span><span id="line-353"></span><span class="annot"><a href="Cooked.Output.html#isScriptOutputFrom%27"><span class="hs-identifier hs-type">isScriptOutputFrom'</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-354"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679504992"><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span id="local-6989586621679504991"><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-355"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-356"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-357"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-359"></span><span>    </span><span class="annot"><a href="Cooked.Output.html#ToValue"><span class="hs-identifier hs-type">ToValue</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-361"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-362"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-363"></span><span>  </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-364"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ResolvedOrInlineDatum"><span class="hs-identifier hs-type">ResolvedOrInlineDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-365"></span><span id="isScriptOutputFrom%27"><span class="annot"><span class="annottext">isScriptOutputFrom' :: TypedValidator a
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (ResolvedOrInlineDatum (DatumType a))
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isScriptOutputFrom%27"><span class="hs-identifier hs-var hs-var">isScriptOutputFrom'</span></a></span></span><span> </span><span id="local-6989586621679504990"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679504990"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-366"></span><span>  </span><span class="hs-comment">-- what's all this madness witht the type annotations?</span><span>
</span><span id="line-367"></span><span>  </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
forall output a.
IsOnchainOutput output =&gt;
TypedValidator a
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isScriptOutputFrom"><span class="hs-identifier hs-var">isScriptOutputFrom</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679504990"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><span class="annottext">(output
 -&gt; Maybe
      (ConcreteOutput
         (TypedValidator a)
         (DatumType output)
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; (ConcreteOutput
      (TypedValidator a)
      (DatumType output)
      (ValueType output)
      (ReferenceScriptType output)
    -&gt; Maybe
         (ConcreteOutput
            (TypedValidator a)
            (ResolvedOrInlineDatum (DatumType a))
            (ValueType output)
            (ReferenceScriptType output)))
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        (TypedValidator a)
        (ResolvedOrInlineDatum (DatumType a))
        (ValueType output)
        (ReferenceScriptType output))
forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&gt;=&gt;</span></span><span> </span><span class="annot"><span class="annottext">(FromData (DatumType a),
 IsOnchainOutput
   (ConcreteOutput
      (TypedValidator a)
      (DatumType output)
      (ValueType output)
      (ReferenceScriptType output))) =&gt;
ConcreteOutput
  (TypedValidator a)
  (DatumType output)
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType
           (ConcreteOutput
              (TypedValidator a)
              (DatumType output)
              (ValueType output)
              (ReferenceScriptType output)))
        (ResolvedOrInlineDatum (DatumType a))
        (ValueType
           (ConcreteOutput
              (TypedValidator a)
              (DatumType output)
              (ValueType output)
              (ReferenceScriptType output)))
        (ReferenceScriptType
           (ConcreteOutput
              (TypedValidator a)
              (DatumType output)
              (ValueType output)
              (ReferenceScriptType output))))
forall a output.
(FromData a, IsOnchainOutput output) =&gt;
output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (ResolvedOrInlineDatum a)
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOutputWithDatumOfType"><span class="hs-identifier hs-var">isOutputWithDatumOfType</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679504992"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504991"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span>
</span><span id="line-369"></span><span>
</span><span id="line-370"></span><span class="hs-comment">-- | Test if the owner an output is a specific public key. If it is, return an</span><span>
</span><span id="line-371"></span><span class="hs-comment">-- output of the same 'DatumType', but with 'Pl.PubKeyHash' as its 'OwnerType'.</span><span>
</span><span id="line-372"></span><span id="local-6989586621679504988"><span class="annot"><a href="Cooked.Output.html#isPKOutputFrom"><span class="hs-identifier hs-type">isPKOutputFrom</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504988"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-374"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>  </span><span class="annot"><a href="#local-6989586621679504988"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-376"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504988"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504988"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504988"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-377"></span><span id="isPKOutputFrom"><span class="annot"><span class="annottext">isPKOutputFrom :: PubKeyHash
-&gt; output
-&gt; Maybe
     (ConcreteOutput
        PubKeyHash
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isPKOutputFrom"><span class="hs-identifier hs-var hs-var">isPKOutputFrom</span></a></span></span><span> </span><span id="local-6989586621679504986"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679504986"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679504985"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">output -&gt; Address
forall o.
(IsAbstractOutput o, ToCredential (OwnerType o)) =&gt;
o -&gt; Address
</span><a href="Cooked.Output.html#outputAddress"><span class="hs-identifier hs-var">outputAddress</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-378"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.Address</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyCredential</span></span><span> </span><span id="local-6989586621679504984"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679504984"><span class="hs-identifier hs-var">pkh'</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679504983"><span class="annot"><span class="annottext">Maybe StakingCredential
</span><a href="#local-6989586621679504983"><span class="hs-identifier hs-var">_mStCred</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679504986"><span class="hs-identifier hs-var">pkh</span></a></span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; PubKeyHash -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679504984"><span class="hs-identifier hs-var">pkh'</span></a></span><span>
</span><span id="line-380"></span><span>      </span><span class="hs-keyword">then</span><span>
</span><span id="line-381"></span><span>        </span><span class="annot"><span class="annottext">ConcreteOutput
  PubKeyHash
  (DatumType output)
  (ValueType output)
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        PubKeyHash
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   PubKeyHash
   (DatumType output)
   (ValueType output)
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         PubKeyHash
         (DatumType output)
         (ValueType output)
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     PubKeyHash
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        PubKeyHash
        (DatumType output)
        (ValueType output)
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-382"></span><span>          </span><span class="annot"><span class="annottext">PubKeyHash
-&gt; Maybe StakingCredential
-&gt; ValueType output
-&gt; DatumType output
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     PubKeyHash
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-383"></span><span>            </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679504986"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-384"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-385"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (ValueType output) -&gt; ValueType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (ValueType output)
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (DatumType output) -&gt; DatumType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (DatumType output)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-387"></span><span>            </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504985"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-388"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     PubKeyHash
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-389"></span><span>  </span><span class="annot"><span class="annottext">Address
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     PubKeyHash
     (DatumType output)
     (ValueType output)
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-390"></span><span>
</span><span id="line-391"></span><span class="hs-comment">-- | Test if the value on an output contains only Ada, and adapt the return type</span><span>
</span><span id="line-392"></span><span class="hs-comment">-- accordingly if it is so.</span><span>
</span><span id="line-393"></span><span id="local-6989586621679504982"><span class="annot"><a href="Cooked.Output.html#isOnlyAdaOutput"><span class="hs-identifier hs-type">isOnlyAdaOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-394"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504982"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-395"></span><span>  </span><span class="annot"><a href="#local-6989586621679504982"><span class="hs-identifier hs-type">output</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504982"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504982"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Ada</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679504982"><span class="hs-identifier hs-type">output</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span><span>
</span><span id="line-397"></span><span id="isOnlyAdaOutput"><span class="annot"><span class="annottext">isOnlyAdaOutput :: output
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (DatumType output)
        Ada
        (ReferenceScriptType output))
</span><a href="Cooked.Output.html#isOnlyAdaOutput"><span class="hs-identifier hs-var hs-var">isOnlyAdaOutput</span></a></span></span><span> </span><span id="local-6989586621679504980"><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-398"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Bool
</span><span class="hs-identifier hs-var">Pl.isAdaOnlyValue</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-399"></span><span>    </span><span class="hs-keyword">then</span><span>
</span><span id="line-400"></span><span>      </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType output)
  (DatumType output)
  Ada
  (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (DatumType output)
        Ada
        (ReferenceScriptType output))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType output)
   (DatumType output)
   Ada
   (ReferenceScriptType output)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType output)
         (DatumType output)
         Ada
         (ReferenceScriptType output)))
-&gt; ConcreteOutput
     (OwnerType output)
     (DatumType output)
     Ada
     (ReferenceScriptType output)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType output)
        (DatumType output)
        Ada
        (ReferenceScriptType output))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-401"></span><span>        </span><span class="annot"><span class="annottext">OwnerType output
-&gt; Maybe StakingCredential
-&gt; Ada
-&gt; DatumType output
-&gt; Maybe (ReferenceScriptType output)
-&gt; ConcreteOutput
     (OwnerType output)
     (DatumType output)
     Ada
     (ReferenceScriptType output)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-402"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (OwnerType output) -&gt; OwnerType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (OwnerType output)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-403"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Value -&gt; Ada
</span><span class="hs-identifier hs-var">Pl.fromValue</span></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Ada) -&gt; Value -&gt; Ada
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">output -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-405"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (DatumType output) -&gt; DatumType output
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (DatumType output)
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">output
</span><a href="#local-6989586621679504980"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">output
-&gt; Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
-&gt; Maybe (ReferenceScriptType output)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens NoIx output (Maybe (ReferenceScriptType output))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput
     (OwnerType output)
     (DatumType output)
     Ada
     (ReferenceScriptType output))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-408"></span></pre></body></html>