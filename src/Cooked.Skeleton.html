<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="%24con2tag_AnugrESDRHv8OrcJQfOvmJ"><span id="%24con2tag_ErFNxoOFbLg3ZUzGvtVK7d"></span></span><span class="hs-pragma">{-# LANGUAGE AllowAmbiguousTypes #-}</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE GADTs #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE GeneralizedNewtypeDeriving #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE RecordWildCards #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-11"></span><span class="hs-pragma">{-# LANGUAGE StandaloneDeriving #-}</span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# LANGUAGE TemplateHaskell #-}</span><span>
</span><span id="line-13"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications #-}</span><span>
</span><span id="line-14"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies #-}</span><span>
</span><span id="line-15"></span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cooked.Skeleton</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-17"></span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Cardano.Api</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">C</span></span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Control.Monad</span></span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Output.html"><span class="hs-identifier">Cooked.Output</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Pretty.Class.html"><span class="hs-identifier">Cooked.Pretty.Class</span></a></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Cooked.Wallet.html"><span class="hs-identifier">Cooked.Wallet</span></a></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Default</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Either.Combinators</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Function</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.List</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.List.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEList</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Map</span></span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.NonEmpty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NEMap</span></span><span class="hs-special">)</span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Map.NonEmpty</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">NEMap</span></span><span>
</span><span id="line-32"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Maybe</span></span><span>
</span><span id="line-33"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Set</span></span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Data.Set</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-35"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Scripts</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">validatorHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-36"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">validatorHash</span></span><span class="hs-special">)</span><span>
</span><span id="line-37"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Ledger.Typed.Scripts</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-38"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.Core</span></span><span>
</span><span id="line-39"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Optics.TH</span></span><span>
</span><span id="line-40"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Ada</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-41"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.Script.Utils.Value</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">adaSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">adaToken</span></span><span class="hs-special">)</span><span>
</span><span id="line-42"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V1.Ledger.Interval</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-43"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V2.Ledger.Api</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span> </span><span class="hs-keyword">hiding</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TxOut</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">adaSymbol</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">adaToken</span></span><span class="hs-special">)</span><span>
</span><span id="line-44"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">Plutus.V2.Ledger.Tx</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><span class="hs-identifier">PlutusTx.Prelude</span></span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Pl</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonZero</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Type.Reflection</span></span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-comment">-- For Template Haskell reasons, the most intersting thing in this module (the</span><span>
</span><span id="line-50"></span><span class="hs-comment">-- definition of 'TxSkel') is at the very bottom of this file</span><span>
</span><span id="line-51"></span><span class="hs-comment">--</span><span>
</span><span id="line-52"></span><span class="hs-comment">-- We'll use TH to generate optics for the types in this file, and the naming</span><span>
</span><span id="line-53"></span><span class="hs-comment">-- convention will be that the optic's names will be the corresponding field's</span><span>
</span><span id="line-54"></span><span class="hs-comment">-- names, followed by</span><span>
</span><span id="line-55"></span><span class="hs-comment">--</span><span>
</span><span id="line-56"></span><span class="hs-comment">-- - an 'L' for lenses</span><span>
</span><span id="line-57"></span><span class="hs-comment">--</span><span>
</span><span id="line-58"></span><span class="hs-comment">-- - an 'AT' for affine traversals</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="hs-comment">-- * Transaction labels</span><span>
</span><span id="line-61"></span><span>
</span><span id="line-62"></span><span class="hs-keyword">type</span><span> </span><span id="LabelConstrs"><span class="annot"><a href="Cooked.Skeleton.html#LabelConstrs"><span class="hs-identifier hs-var">LabelConstrs</span></a></span></span><span> </span><span id="local-6989586621679499432"><span class="annot"><a href="#local-6989586621679499432"><span class="hs-identifier hs-type">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679499432"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499432"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679499432"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="#local-6989586621679499432"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span>
</span><span id="line-64"></span><span class="hs-keyword">data</span><span> </span><span id="TxLabel"><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-var">TxLabel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-65"></span><span>  </span><span id="local-6989586621679499431"><span id="TxLabel"><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-var">TxLabel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#LabelConstrs"><span class="hs-identifier hs-type">LabelConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499431"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499431"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span></span><span>
</span><span id="line-66"></span><span>
</span><span id="line-67"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499427"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-68"></span><span>  </span><span id="local-6989586621679499425"><span class="annot"><span class="annottext">TxLabel
</span><a href="#local-6989586621679499425"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679499424"><span class="annot"><span class="annottext">== :: TxLabel -&gt; TxLabel -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679499423"><span class="annot"><span class="annottext">TxLabel
</span><a href="#local-6989586621679499423"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxLabel -&gt; TxLabel -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">TxLabel
</span><a href="#local-6989586621679499425"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TxLabel
</span><a href="#local-6989586621679499423"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499417"><span id="local-6989586621679499420"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-71"></span><span>  </span><span id="local-6989586621679499415"><span class="annot"><span class="annottext">show :: TxLabel -&gt; String
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span><span> </span><span id="local-6989586621679499413"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499413"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">x -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499413"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-72"></span><span>
</span><span id="line-73"></span><span class="hs-comment">{- note: How to write 'Ord' instances for types with existential type variables in
 their constructors?

The idea of the 'Ord' instances for 'TxLabel', 'MintsConstraint', and
'TxSkelIn' is illustrated by the instance for 'TxLabel' below: Sort by the
type representation of the existential type variable first, and then by the
concrete value within each of the possible instances of the existential.

This means:

- If the type(representation) of a is strictly smaller than the type of b, then
  a&lt;b.

- If the types of a and b are the same, compare a and b normally.

- If the type of a is strictly greater than the type of b, then a&gt;b.

-}</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499399"><span id="local-6989586621679499401"><span id="local-6989586621679499403"><span id="local-6989586621679499405"><span id="local-6989586621679499407"><span id="local-6989586621679499409"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-93"></span><span>  </span><span id="local-6989586621679499397"><span class="annot"><span class="annottext">compare :: TxLabel -&gt; TxLabel -&gt; Ordering
</span><a href="#local-6989586621679499397"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span><span> </span><span id="local-6989586621679499396"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499396"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span><span> </span><span id="local-6989586621679499395"><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499395"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeTypeRep -&gt; SomeTypeRep -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep x -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; TypeRep x
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499396"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep x -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">x -&gt; TypeRep x
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499395"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-95"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-96"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-97"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">x -&gt; TypeRep x
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499396"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep x -&gt; TypeRep x -&gt; Maybe (x :~~: x)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">x -&gt; TypeRep x
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499395"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">x :~~: x
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">x -&gt; x -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">x
</span><a href="#local-6989586621679499396"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">x
x
</span><a href="#local-6989586621679499395"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-99"></span><span>        </span><span class="hs-comment">-- This can never happen, since 'eqTypeRep' is implemented in terms of</span><span>
</span><span id="line-100"></span><span>        </span><span class="hs-comment">-- '==' on the type representation:</span><span>
</span><span id="line-101"></span><span>        </span><span class="annot"><span class="annottext">Maybe (x :~~: x)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ordering
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type representations compare as EQ, but are not eqTypeRep&quot;</span></span><span>
</span><span id="line-102"></span><span>
</span><span id="line-103"></span><span class="hs-comment">-- * Transaction options</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span class="hs-comment">-- | Whether to adjust existing public key outputs during transaction</span><span>
</span><span id="line-106"></span><span class="hs-comment">-- balancing. TODO: Why do we need these two options? Are they just historical</span><span>
</span><span id="line-107"></span><span class="hs-comment">-- baggage?</span><span>
</span><span id="line-108"></span><span class="hs-keyword">data</span><span> </span><span id="BalanceOutputPolicy"><span class="annot"><a href="Cooked.Skeleton.html#BalanceOutputPolicy"><span class="hs-identifier hs-var">BalanceOutputPolicy</span></a></span></span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Try to adjust an existing public key output with the change. If no</span><span>
</span><span id="line-110"></span><span>    </span><span class="hs-comment">--   suitable output can be found, create a new change output.</span><span>
</span><span id="line-111"></span><span>    </span><span id="AdjustExistingOutput"><span class="annot"><a href="Cooked.Skeleton.html#AdjustExistingOutput"><span class="hs-identifier hs-var">AdjustExistingOutput</span></a></span></span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="hs-comment">-- | Do not change the existing outputs, always create a new change</span><span>
</span><span id="line-113"></span><span>    </span><span class="hs-comment">--   output.</span><span>
</span><span id="line-114"></span><span>    </span><span id="DontAdjustExistingOutput"><span class="annot"><a href="Cooked.Skeleton.html#DontAdjustExistingOutput"><span class="hs-identifier hs-var">DontAdjustExistingOutput</span></a></span></span><span>
</span><span id="line-115"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499385"><span id="local-6989586621679499387"><span class="annot"><span class="annottext">BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
(BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; Eq BalanceOutputPolicy
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c/= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
== :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c== :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499370"><span id="local-6989586621679499372"><span id="local-6989586621679499374"><span id="local-6989586621679499376"><span id="local-6989586621679499378"><span id="local-6989586621679499380"><span id="local-6989586621679499382"><span class="annot"><span class="annottext">Eq BalanceOutputPolicy
Eq BalanceOutputPolicy
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool)
-&gt; (BalanceOutputPolicy
    -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy)
-&gt; (BalanceOutputPolicy
    -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy)
-&gt; Ord BalanceOutputPolicy
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
$cmin :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
max :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
$cmax :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; BalanceOutputPolicy
&gt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&gt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&gt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&gt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&lt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&lt;= :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
&lt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
$c&lt; :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Bool
compare :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
$ccompare :: BalanceOutputPolicy -&gt; BalanceOutputPolicy -&gt; Ordering
$cp1Ord :: Eq BalanceOutputPolicy
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499364"><span id="local-6989586621679499366"><span id="local-6989586621679499368"><span class="annot"><span class="annottext">Int -&gt; BalanceOutputPolicy -&gt; ShowS
[BalanceOutputPolicy] -&gt; ShowS
BalanceOutputPolicy -&gt; String
(Int -&gt; BalanceOutputPolicy -&gt; ShowS)
-&gt; (BalanceOutputPolicy -&gt; String)
-&gt; ([BalanceOutputPolicy] -&gt; ShowS)
-&gt; Show BalanceOutputPolicy
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BalanceOutputPolicy] -&gt; ShowS
$cshowList :: [BalanceOutputPolicy] -&gt; ShowS
show :: BalanceOutputPolicy -&gt; String
$cshow :: BalanceOutputPolicy -&gt; String
showsPrec :: Int -&gt; BalanceOutputPolicy -&gt; ShowS
$cshowsPrec :: Int -&gt; BalanceOutputPolicy -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-116"></span><span>
</span><span id="line-117"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#BalanceOutputPolicy"><span class="hs-identifier hs-type">BalanceOutputPolicy</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-118"></span><span>  </span><span id="local-6989586621679499361"><span class="annot"><span class="annottext">def :: BalanceOutputPolicy
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalanceOutputPolicy
</span><a href="Cooked.Skeleton.html#AdjustExistingOutput"><span class="hs-identifier hs-var">AdjustExistingOutput</span></a></span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="hs-comment">-- | Which wallet to use to provide outputs for balancing and collaterals.</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- Either the first signer or an explicit wallet. In the second case, this</span><span>
</span><span id="line-122"></span><span class="hs-comment">-- wallet must be a signer of the transaction.</span><span>
</span><span id="line-123"></span><span class="hs-keyword">data</span><span> </span><span id="BalancingWallet"><span class="annot"><a href="Cooked.Skeleton.html#BalancingWallet"><span class="hs-identifier hs-var">BalancingWallet</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="BalanceWithFirstSigner"><span class="annot"><a href="Cooked.Skeleton.html#BalanceWithFirstSigner"><span class="hs-identifier hs-var">BalanceWithFirstSigner</span></a></span></span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span id="BalanceWith"><span class="annot"><a href="Cooked.Skeleton.html#BalanceWith"><span class="hs-identifier hs-var">BalanceWith</span></a></span></span><span> </span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499354"><span id="local-6989586621679499356"><span class="annot"><span class="annottext">BalancingWallet -&gt; BalancingWallet -&gt; Bool
(BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; Eq BalancingWallet
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c/= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
== :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c== :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499339"><span id="local-6989586621679499341"><span id="local-6989586621679499343"><span id="local-6989586621679499345"><span id="local-6989586621679499347"><span id="local-6989586621679499349"><span id="local-6989586621679499351"><span class="annot"><span class="annottext">Eq BalancingWallet
Eq BalancingWallet
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Ordering)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; Bool)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet)
-&gt; (BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet)
-&gt; Ord BalancingWallet
BalancingWallet -&gt; BalancingWallet -&gt; Bool
BalancingWallet -&gt; BalancingWallet -&gt; Ordering
BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet
$cmin :: BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet
max :: BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet
$cmax :: BalancingWallet -&gt; BalancingWallet -&gt; BalancingWallet
&gt;= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c&gt;= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
&gt; :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c&gt; :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
&lt;= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c&lt;= :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
&lt; :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
$c&lt; :: BalancingWallet -&gt; BalancingWallet -&gt; Bool
compare :: BalancingWallet -&gt; BalancingWallet -&gt; Ordering
$ccompare :: BalancingWallet -&gt; BalancingWallet -&gt; Ordering
$cp1Ord :: Eq BalancingWallet
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499333"><span id="local-6989586621679499335"><span id="local-6989586621679499337"><span class="annot"><span class="annottext">Int -&gt; BalancingWallet -&gt; ShowS
[BalancingWallet] -&gt; ShowS
BalancingWallet -&gt; String
(Int -&gt; BalancingWallet -&gt; ShowS)
-&gt; (BalancingWallet -&gt; String)
-&gt; ([BalancingWallet] -&gt; ShowS)
-&gt; Show BalancingWallet
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [BalancingWallet] -&gt; ShowS
$cshowList :: [BalancingWallet] -&gt; ShowS
show :: BalancingWallet -&gt; String
$cshow :: BalancingWallet -&gt; String
showsPrec :: Int -&gt; BalancingWallet -&gt; ShowS
$cshowsPrec :: Int -&gt; BalancingWallet -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>
</span><span id="line-128"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#BalancingWallet"><span class="hs-identifier hs-type">BalancingWallet</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-129"></span><span>  </span><span id="local-6989586621679499331"><span class="annot"><span class="annottext">def :: BalancingWallet
</span><a href="#local-6989586621679499331"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalancingWallet
</span><a href="Cooked.Skeleton.html#BalanceWithFirstSigner"><span class="hs-identifier hs-var">BalanceWithFirstSigner</span></a></span><span>
</span><span id="line-130"></span><span>
</span><span id="line-131"></span><span class="hs-comment">-- | Wraps a function that will be applied to a transaction right before</span><span>
</span><span id="line-132"></span><span class="hs-comment">-- submitting it.</span><span>
</span><span id="line-133"></span><span class="hs-keyword">newtype</span><span> </span><span id="RawModTx"><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-var">RawModTx</span></a></span></span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="hs-comment">-- | Apply modification on transaction after balancing, fee calculation, and</span><span>
</span><span id="line-135"></span><span>    </span><span class="hs-comment">-- final signing areperformed</span><span>
</span><span id="line-136"></span><span>    </span><span id="RawModTxAfterBalancing"><span class="annot"><a href="Cooked.Skeleton.html#RawModTxAfterBalancing"><span class="hs-identifier hs-var">RawModTxAfterBalancing</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span class="hs-special">)</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499327"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">RawModTx
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621679499326"><span class="annot"><span class="annottext">== :: RawModTx -&gt; RawModTx -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">RawModTx
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499321"><span id="local-6989586621679499324"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-142"></span><span>  </span><span id="local-6989586621679499320"><span class="annot"><span class="annottext">show :: RawModTx -&gt; String
</span><a href="#local-6989586621679499320"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#RawModTxAfterBalancing"><span class="hs-identifier hs-type">RawModTxAfterBalancing</span></a></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; Tx BabbageEra
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;RawModTxAfterBalancing&quot;</span></span><span>
</span><span id="line-143"></span><span>
</span><span id="line-144"></span><span class="hs-comment">-- | Applies a list of modifications right before the transaction is</span><span>
</span><span id="line-145"></span><span class="hs-comment">-- submitted. The leftmost function in the argument list is applied first.</span><span>
</span><span id="line-146"></span><span class="annot"><a href="Cooked.Skeleton.html#applyRawModOnBalancedTx"><span class="hs-identifier hs-type">applyRawModOnBalancedTx</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.Tx</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">C.BabbageEra</span></span><span>
</span><span id="line-147"></span><span id="applyRawModOnBalancedTx"><span class="annot"><span class="annottext">applyRawModOnBalancedTx :: [RawModTx] -&gt; Tx BabbageEra -&gt; Tx BabbageEra
</span><a href="Cooked.Skeleton.html#applyRawModOnBalancedTx"><span class="hs-identifier hs-var hs-var">applyRawModOnBalancedTx</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; Tx BabbageEra
forall a. a -&gt; a
</span><span class="hs-identifier hs-var">id</span></span><span>
</span><span id="line-148"></span><span class="annot"><a href="Cooked.Skeleton.html#applyRawModOnBalancedTx"><span class="hs-identifier hs-var">applyRawModOnBalancedTx</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#RawModTxAfterBalancing"><span class="hs-identifier hs-type">RawModTxAfterBalancing</span></a></span><span> </span><span id="local-6989586621679499317"><span class="annot"><span class="annottext">Tx BabbageEra -&gt; Tx BabbageEra
</span><a href="#local-6989586621679499317"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span class="annot"><span class="hs-glyph hs-type">:</span></span><span> </span><span id="local-6989586621679499316"><span class="annot"><span class="annottext">[RawModTx]
</span><a href="#local-6989586621679499316"><span class="hs-identifier hs-var">fs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[RawModTx] -&gt; Tx BabbageEra -&gt; Tx BabbageEra
</span><a href="Cooked.Skeleton.html#applyRawModOnBalancedTx"><span class="hs-identifier hs-var">applyRawModOnBalancedTx</span></a></span><span> </span><span class="annot"><span class="annottext">[RawModTx]
</span><a href="#local-6989586621679499316"><span class="hs-identifier hs-var">fs</span></a></span><span> </span><span class="annot"><span class="annottext">(Tx BabbageEra -&gt; Tx BabbageEra)
-&gt; (Tx BabbageEra -&gt; Tx BabbageEra)
-&gt; Tx BabbageEra
-&gt; Tx BabbageEra
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Tx BabbageEra -&gt; Tx BabbageEra
</span><a href="#local-6989586621679499317"><span class="hs-identifier hs-var">f</span></a></span><span>
</span><span id="line-149"></span><span>
</span><span id="line-150"></span><span class="hs-comment">-- | Set of options to modify the behavior of generating and validating some transaction. Some of these</span><span>
</span><span id="line-151"></span><span class="hs-comment">-- options only have an effect when running in the 'Plutus.Contract.Contract', some only have an effect when</span><span>
</span><span id="line-152"></span><span class="hs-comment">-- running in 'MockChainT'. If nothing is explicitely stated, the option has an effect independently of the</span><span>
</span><span id="line-153"></span><span class="hs-comment">-- running context.</span><span>
</span><span id="line-154"></span><span class="hs-comment">--</span><span>
</span><span id="line-155"></span><span class="hs-comment">-- TODO Refactor field names to avoid clashes on common terms such as &quot;collateral&quot; or &quot;balance&quot;</span><span>
</span><span id="line-156"></span><span class="hs-keyword">data</span><span> </span><span id="TxOpts"><span class="annot"><a href="Cooked.Skeleton.html#TxOpts"><span class="hs-identifier hs-var">TxOpts</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="TxOpts"><span class="annot"><a href="Cooked.Skeleton.html#TxOpts"><span class="hs-identifier hs-var">TxOpts</span></a></span></span><span>
</span><span id="line-157"></span><span>  </span><span class="hs-special">{</span><span> </span><span class="hs-comment">-- | Performs an adjustment to unbalanced transactions, making sure every</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-comment">-- UTxO that is produced has the necessary minimum amount of Ada.</span><span>
</span><span id="line-159"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-160"></span><span>    </span><span class="hs-comment">-- By default, this is set to @False@, given this is the default behavior in Plutus:</span><span>
</span><span id="line-161"></span><span>    </span><span class="hs-comment">-- https://github.com/input-output-hk/plutus-apps/issues/143#issuecomment-1013012744</span><span>
</span><span id="line-162"></span><span>    </span><span id="txOptEnsureMinAda"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Skeleton.html#txOptEnsureMinAda"><span class="hs-identifier hs-var hs-var">txOptEnsureMinAda</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-163"></span><span>    </span><span class="hs-comment">-- | When submitting a transaction for real (i.e., running in the 'Plutus.Contract.Contract' monad),</span><span>
</span><span id="line-164"></span><span>    </span><span class="hs-comment">--  it is common to call 'Plutus.Contract.Request.awaitTxConfirmed' after 'Plutus.Contract.Request.submitTxConstraints'.</span><span>
</span><span id="line-165"></span><span>    </span><span class="hs-comment">--  If you /do NOT/ wish to do so, please set this to @False@.</span><span>
</span><span id="line-166"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-167"></span><span>    </span><span class="hs-comment">--  /This has NO effect when running outside of 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-168"></span><span>    </span><span class="hs-comment">--  By default, this is set to @True@.</span><span>
</span><span id="line-169"></span><span>    </span><span id="txOptAwaitTxConfirmed"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Skeleton.html#txOptAwaitTxConfirmed"><span class="hs-identifier hs-var hs-var">txOptAwaitTxConfirmed</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-170"></span><span>    </span><span class="hs-comment">-- | Whether to increase the slot counter automatically on this submission.</span><span>
</span><span id="line-171"></span><span>    </span><span class="hs-comment">-- This is useful for modelling transactions that could be submitted in parallel in reality, so there</span><span>
</span><span id="line-172"></span><span>    </span><span class="hs-comment">-- should be no explicit ordering of what comes first. One good example is in the Crowdfunding use case contract.</span><span>
</span><span id="line-173"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-174"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-175"></span><span>    </span><span class="hs-comment">--  By default, this is set to @True@.</span><span>
</span><span id="line-176"></span><span>    </span><span id="txOptAutoSlotIncrease"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Skeleton.html#txOptAutoSlotIncrease"><span class="hs-identifier hs-var hs-var">txOptAutoSlotIncrease</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-177"></span><span>    </span><span class="hs-comment">-- | Applies an arbitrary modification to a transaction after it has been</span><span>
</span><span id="line-178"></span><span>    </span><span class="hs-comment">-- potentially adjusted ('txOptEnsureMinAda) and balanced. This is prefixed</span><span>
</span><span id="line-179"></span><span>    </span><span class="hs-comment">-- with /unsafe/ to draw attention to the fact that modifying a transaction</span><span>
</span><span id="line-180"></span><span>    </span><span class="hs-comment">-- at that stage might make it invalid. Still, this offers a hook for being</span><span>
</span><span id="line-181"></span><span>    </span><span class="hs-comment">-- able to alter a transaction in unforeseen ways. It is mostly used to test</span><span>
</span><span id="line-182"></span><span>    </span><span class="hs-comment">-- contracts that have been written for custom PABs.</span><span>
</span><span id="line-183"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-184"></span><span>    </span><span class="hs-comment">-- One interesting use of this function is to observe a transaction just</span><span>
</span><span id="line-185"></span><span>    </span><span class="hs-comment">-- before it is being sent for validation, with @unsafeModTx =</span><span>
</span><span id="line-186"></span><span>    </span><span class="hs-comment">-- [RawModTxAfterBalancing Debug.Trace.traceShowId]@.</span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.  By</span><span>
</span><span id="line-189"></span><span>    </span><span class="hs-comment">-- default, this is set to the empty list.</span><span>
</span><span id="line-190"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-191"></span><span>    </span><span class="hs-comment">-- The leftmost function in the list is applied first.</span><span>
</span><span id="line-192"></span><span>    </span><span id="txOptUnsafeModTx"><span class="annot"><span class="annottext">TxOpts -&gt; [RawModTx]
</span><a href="Cooked.Skeleton.html#txOptUnsafeModTx"><span class="hs-identifier hs-var hs-var">txOptUnsafeModTx</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.html#RawModTx"><span class="hs-identifier hs-type">RawModTx</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-193"></span><span>    </span><span class="hs-comment">-- | Whether to balance the transaction or not. Balancing</span><span>
</span><span id="line-194"></span><span>    </span><span class="hs-comment">--  ensures that @input + mint = output + fees + burns@, if you decide to</span><span>
</span><span id="line-195"></span><span>    </span><span class="hs-comment">--  set @balance = false@ you will have trouble satisfying that equation by</span><span>
</span><span id="line-196"></span><span>    </span><span class="hs-comment">--  hand because @fees@ are variable. You will likely see a</span><span>
</span><span id="line-197"></span><span>    </span><span class="hs-comment">--  @ValueNotPreserved@ error and should adjust the fees accordingly.</span><span>
</span><span id="line-198"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-comment">-- By default, this is set to @True@.</span><span>
</span><span id="line-201"></span><span>    </span><span id="txOptBalance"><span class="annot"><span class="annottext">TxOpts -&gt; Bool
</span><a href="Cooked.Skeleton.html#txOptBalance"><span class="hs-identifier hs-var hs-var">txOptBalance</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Bool</span></span><span class="hs-special">,</span><span>
</span><span id="line-202"></span><span>    </span><span class="hs-comment">-- | The 'BalanceOutputPolicy' to apply when balancing the transaction.</span><span>
</span><span id="line-203"></span><span>    </span><span class="hs-comment">--</span><span>
</span><span id="line-204"></span><span>    </span><span class="hs-comment">-- /This has NO effect when running in 'Plutus.Contract.Contract'/.</span><span>
</span><span id="line-205"></span><span>    </span><span class="hs-comment">-- By default, this is set to @AdjustExistingOutput@.</span><span>
</span><span id="line-206"></span><span>    </span><span id="txOptBalanceOutputPolicy"><span class="annot"><span class="annottext">TxOpts -&gt; BalanceOutputPolicy
</span><a href="Cooked.Skeleton.html#txOptBalanceOutputPolicy"><span class="hs-identifier hs-var hs-var">txOptBalanceOutputPolicy</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#BalanceOutputPolicy"><span class="hs-identifier hs-type">BalanceOutputPolicy</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-207"></span><span>    </span><span class="hs-comment">-- | Which wallet to use to provide outputs for balancing and collaterals.</span><span>
</span><span id="line-208"></span><span>    </span><span class="hs-comment">-- Either the first signer by default, or an explicit wallet. In the second</span><span>
</span><span id="line-209"></span><span>    </span><span class="hs-comment">-- case, this wallet must be a signer of the transaction. This option WILL</span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-comment">-- NOT ensure that it is added in case it is not already present in the</span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-comment">-- list of signers.</span><span>
</span><span id="line-212"></span><span>    </span><span id="txOptBalanceWallet"><span class="annot"><span class="annottext">TxOpts -&gt; BalancingWallet
</span><a href="Cooked.Skeleton.html#txOptBalanceWallet"><span class="hs-identifier hs-var hs-var">txOptBalanceWallet</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#BalancingWallet"><span class="hs-identifier hs-type">BalancingWallet</span></a></span><span>
</span><span id="line-213"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-214"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499303"><span id="local-6989586621679499305"><span class="annot"><span class="annottext">TxOpts -&gt; TxOpts -&gt; Bool
(TxOpts -&gt; TxOpts -&gt; Bool)
-&gt; (TxOpts -&gt; TxOpts -&gt; Bool) -&gt; Eq TxOpts
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxOpts -&gt; TxOpts -&gt; Bool
$c/= :: TxOpts -&gt; TxOpts -&gt; Bool
== :: TxOpts -&gt; TxOpts -&gt; Bool
$c== :: TxOpts -&gt; TxOpts -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499297"><span id="local-6989586621679499299"><span id="local-6989586621679499301"><span class="annot"><span class="annottext">Int -&gt; TxOpts -&gt; ShowS
[TxOpts] -&gt; ShowS
TxOpts -&gt; String
(Int -&gt; TxOpts -&gt; ShowS)
-&gt; (TxOpts -&gt; String) -&gt; ([TxOpts] -&gt; ShowS) -&gt; Show TxOpts
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxOpts] -&gt; ShowS
$cshowList :: [TxOpts] -&gt; ShowS
show :: TxOpts -&gt; String
$cshow :: TxOpts -&gt; String
showsPrec :: Int -&gt; TxOpts -&gt; ShowS
$cshowsPrec :: Int -&gt; TxOpts -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-215"></span><span>
</span><span id="line-216"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Default</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-217"></span><span>  </span><span id="local-6989586621679499295"><span class="annot"><span class="annottext">def :: TxOpts
</span><a href="#local-6989586621679499295"><span class="hs-identifier hs-var hs-var hs-var hs-var">def</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-218"></span><span>    </span><span class="annot"><span class="annottext">TxOpts :: Bool
-&gt; Bool
-&gt; Bool
-&gt; [RawModTx]
-&gt; Bool
-&gt; BalanceOutputPolicy
-&gt; BalancingWallet
-&gt; TxOpts
</span><a href="Cooked.Skeleton.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span>
</span><span id="line-219"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txOptEnsureMinAda :: Bool
</span><a href="Cooked.Skeleton.html#txOptEnsureMinAda"><span class="hs-identifier hs-var">txOptEnsureMinAda</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span class="hs-special">,</span><span>
</span><span id="line-220"></span><span>        </span><span class="annot"><span class="annottext">txOptAwaitTxConfirmed :: Bool
</span><a href="Cooked.Skeleton.html#txOptAwaitTxConfirmed"><span class="hs-identifier hs-var">txOptAwaitTxConfirmed</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-221"></span><span>        </span><span class="annot"><span class="annottext">txOptAutoSlotIncrease :: Bool
</span><a href="Cooked.Skeleton.html#txOptAutoSlotIncrease"><span class="hs-identifier hs-var">txOptAutoSlotIncrease</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-222"></span><span>        </span><span class="annot"><span class="annottext">txOptUnsafeModTx :: [RawModTx]
</span><a href="Cooked.Skeleton.html#txOptUnsafeModTx"><span class="hs-identifier hs-var">txOptUnsafeModTx</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-223"></span><span>        </span><span class="annot"><span class="annottext">txOptBalance :: Bool
</span><a href="Cooked.Skeleton.html#txOptBalance"><span class="hs-identifier hs-var">txOptBalance</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span class="hs-special">,</span><span>
</span><span id="line-224"></span><span>        </span><span class="annot"><span class="annottext">txOptBalanceOutputPolicy :: BalanceOutputPolicy
</span><a href="Cooked.Skeleton.html#txOptBalanceOutputPolicy"><span class="hs-identifier hs-var">txOptBalanceOutputPolicy</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalanceOutputPolicy
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-225"></span><span>        </span><span class="annot"><span class="annottext">txOptBalanceWallet :: BalancingWallet
</span><a href="Cooked.Skeleton.html#txOptBalanceWallet"><span class="hs-identifier hs-var">txOptBalanceWallet</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BalancingWallet
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span>
</span><span id="line-226"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-227"></span><span>
</span><span id="line-228"></span><span class="hs-comment">-- * Description of the Minting</span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span class="hs-keyword">type</span><span> </span><span id="MintsConstrs"><span class="annot"><a href="Cooked.Skeleton.html#MintsConstrs"><span class="hs-identifier hs-var">MintsConstrs</span></a></span></span><span> </span><span id="local-6989586621679499293"><span class="annot"><a href="#local-6989586621679499293"><span class="hs-identifier hs-type">redeemer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-231"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679499293"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-232"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679499293"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499293"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499293"><span class="hs-identifier hs-type">redeemer</span></a></span><span>
</span><span id="line-235"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-keyword">data</span><span> </span><span id="MintsRedeemer"><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-var">MintsRedeemer</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-238"></span><span>  </span><span id="NoMintsRedeemer"><span class="annot"><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span>
</span><span id="line-239"></span><span>  </span><span id="local-6989586621679499290"><span id="SomeMintsRedeemer"><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-var">SomeMintsRedeemer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsConstrs"><span class="hs-identifier hs-type">MintsConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499290"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499290"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span></span><span>
</span><span id="line-240"></span><span>
</span><span id="line-241"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499284"><span id="local-6989586621679499287"><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-242"></span><span>  </span><span id="local-6989586621679499283"><span class="annot"><span class="annottext">show :: MintsRedeemer -&gt; String
</span><a href="#local-6989586621679499283"><span class="hs-identifier hs-var hs-var hs-var hs-var">show</span></a></span></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;NoMintsRedeemer&quot;</span></span><span>
</span><span id="line-243"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-type">SomeMintsRedeemer</span></a></span><span> </span><span id="local-6989586621679499282"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499282"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;(SomeMintsRedeemer &quot;</span></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; String
forall a. Show a =&gt; a -&gt; String
</span><span class="hs-identifier hs-var">show</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499282"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">String -&gt; ShowS
forall a. [a] -&gt; [a] -&gt; [a]
</span><span class="hs-operator hs-var">++</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;)&quot;</span></span><span>
</span><span id="line-244"></span><span>
</span><span id="line-245"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499279"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-246"></span><span>  </span><span id="local-6989586621679499278"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499278"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679499277"><span class="annot"><span class="annottext">== :: MintsRedeemer -&gt; MintsRedeemer -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679499276"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499276"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MintsRedeemer -&gt; MintsRedeemer -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499278"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499276"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499262"><span id="local-6989586621679499264"><span id="local-6989586621679499266"><span id="local-6989586621679499268"><span id="local-6989586621679499270"><span id="local-6989586621679499272"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-249"></span><span>  </span><span id="local-6989586621679499261"><span class="annot"><span class="annottext">compare :: MintsRedeemer -&gt; MintsRedeemer -&gt; Ordering
</span><a href="#local-6989586621679499261"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-250"></span><span>  </span><span class="hs-comment">-- The next two clauses are ugly, but necessary, since minting with no</span><span>
</span><span id="line-251"></span><span>  </span><span class="hs-comment">-- redeemer is represented as minting with the unit redeemer on-chain.</span><span>
</span><span id="line-252"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-type">SomeMintsRedeemer</span></a></span><span> </span><span id="local-6989586621679499260"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499260"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-253"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier hs-var">Pl.unitRedeemer</span></span><span> </span><span class="annot"><span class="annottext">Redeemer -&gt; Redeemer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Redeemer
</span><span class="hs-identifier hs-var">Pl.Redeemer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">redeemer -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499260"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-254"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-255"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-256"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-type">SomeMintsRedeemer</span></a></span><span> </span><span id="local-6989586621679499256"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499256"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="Cooked.Skeleton.html#NoMintsRedeemer"><span class="hs-identifier hs-var">NoMintsRedeemer</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-257"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Redeemer
</span><span class="hs-identifier hs-var">Pl.unitRedeemer</span></span><span> </span><span class="annot"><span class="annottext">Redeemer -&gt; Redeemer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Redeemer
</span><span class="hs-identifier hs-var">Pl.Redeemer</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">redeemer -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499256"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-258"></span><span>      </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-259"></span><span>      </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-260"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-type">SomeMintsRedeemer</span></a></span><span> </span><span id="local-6989586621679499255"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499255"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#SomeMintsRedeemer"><span class="hs-identifier hs-type">SomeMintsRedeemer</span></a></span><span> </span><span id="local-6989586621679499254"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499254"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeTypeRep -&gt; SomeTypeRep -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep redeemer -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="annot"><span class="annottext">(TypeRep redeemer -&gt; SomeTypeRep)
-&gt; TypeRep redeemer -&gt; SomeTypeRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499255"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep redeemer -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="annot"><span class="annottext">(TypeRep redeemer -&gt; SomeTypeRep)
-&gt; TypeRep redeemer -&gt; SomeTypeRep
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499254"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-262"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-263"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-264"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499255"><span class="hs-identifier hs-var">a</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep redeemer
-&gt; TypeRep redeemer -&gt; Maybe (redeemer :~~: redeemer)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499254"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-265"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">redeemer :~~: redeemer
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Data -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">Pl.toData</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499255"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">Pl.toData</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499254"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-266"></span><span>        </span><span class="annot"><span class="annottext">Maybe (redeemer :~~: redeemer)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ordering
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Type representations compare as EQ, but are not eqTypeRep&quot;</span></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span class="hs-comment">-- | A description of what a transaction mints: For every policy, there can only</span><span>
</span><span id="line-269"></span><span class="hs-comment">-- be one redeemer, and if there is a redeemer, there mus be some token names,</span><span>
</span><span id="line-270"></span><span class="hs-comment">-- each with a non-zero amount of tokens.</span><span>
</span><span id="line-271"></span><span class="hs-keyword">type</span><span> </span><span id="TxSkelMints"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-var">TxSkelMints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-272"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span>
</span><span id="line-273"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">)</span><span>
</span><span id="line-274"></span><span>    </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NEMap</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Combining 'TxSkelMints' in a sensible way. In particular, this means that</span><span>
</span><span id="line-277"></span><span class="hs-comment">--</span><span>
</span><span id="line-278"></span><span class="hs-comment">-- &gt; Map.fromList [(pol, (red, NEMap.fromList [(tName, 1)]))]</span><span>
</span><span id="line-279"></span><span class="hs-comment">--</span><span>
</span><span id="line-280"></span><span class="hs-comment">-- and</span><span>
</span><span id="line-281"></span><span class="hs-comment">--</span><span>
</span><span id="line-282"></span><span class="hs-comment">-- &gt; Map.fromList [(pol, (red, NEMap.fromList [(tName, -1)]))]</span><span>
</span><span id="line-283"></span><span class="hs-comment">--</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- will combine to become the empty 'TxSkelMints' (and similar examples, where</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- the values add up to zero, see the comment at the definition of</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- 'addToTxSkelMints').</span><span>
</span><span id="line-287"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679499248"><span id="local-6989586621679499250"><span class="annot"><span class="hs-identifier hs-type">Semigroup</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621679499246"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499246"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679499245"><span class="annot"><span class="annottext">&lt;&gt; :: TxSkelMints -&gt; TxSkelMints -&gt; TxSkelMints
</span><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></span></span><span> </span><span id="local-6989586621679499244"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499244"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-289"></span><span>    </span><span class="annot"><span class="annottext">(TxSkelMints
 -&gt; (Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)
 -&gt; TxSkelMints)
-&gt; TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
-&gt; TxSkelMints
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl</span></span><span>
</span><span id="line-290"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((Versioned MintingPolicy, MintsRedeemer, TokenName,
  NonZero Integer)
 -&gt; TxSkelMints -&gt; TxSkelMints)
-&gt; TxSkelMints
-&gt; (Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)
-&gt; TxSkelMints
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><span class="hs-identifier hs-var">flip</span></span><span> </span><span class="annot"><span class="annottext">(Versioned MintingPolicy, MintsRedeemer, TokenName,
 NonZero Integer)
-&gt; TxSkelMints -&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#addToTxSkelMints"><span class="hs-identifier hs-var">addToTxSkelMints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-291"></span><span>      </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499246"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-292"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
</span><a href="Cooked.Skeleton.html#txSkelMintsToList"><span class="hs-identifier hs-var">txSkelMintsToList</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499244"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-293"></span><span>
</span><span id="line-294"></span><span class="hs-keyword">instance</span><span> </span><span class="hs-pragma">{-# OVERLAPPING</span><span> </span><span class="hs-pragma">#-}</span><span> </span><span id="local-6989586621679499234"><span id="local-6989586621679499236"><span class="annot"><span class="hs-identifier hs-type">Monoid</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-295"></span><span>  </span><span id="local-6989586621679499232"><span class="annot"><span class="annottext">mempty :: TxSkelMints
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-296"></span><span>
</span><span id="line-297"></span><span class="hs-comment">-- | Add a new entry to a 'TxSkelMints'. There are a few wrinkles:</span><span>
</span><span id="line-298"></span><span class="hs-comment">--</span><span>
</span><span id="line-299"></span><span class="hs-comment">-- (1) If for a given policy, redeemer, and token name, there are @n@ tokens in</span><span>
</span><span id="line-300"></span><span class="hs-comment">-- the argument 'TxSkelMints', and you add @-n@ tokens, the corresponding entry</span><span>
</span><span id="line-301"></span><span class="hs-comment">-- in the &quot;inner map&quot; of the policy will disappear (obviously, because all of</span><span>
</span><span id="line-302"></span><span class="hs-comment">-- its values have to be non-zero). If that also means that the inner map</span><span>
</span><span id="line-303"></span><span class="hs-comment">-- becomes empty, the policy will disappear from the 'TxSkelMints' altogether.</span><span>
</span><span id="line-304"></span><span class="hs-comment">--</span><span>
</span><span id="line-305"></span><span class="hs-comment">-- (2) If a policy is already present on the argument 'TxSkelMints' with a</span><span>
</span><span id="line-306"></span><span class="hs-comment">-- redeemer @a@, and you add a mint with a different redeemer @b@, the old</span><span>
</span><span id="line-307"></span><span class="hs-comment">-- redeemer is thrown away. This is because, on the plutus-apps 'Tx' type, every</span><span>
</span><span id="line-308"></span><span class="hs-comment">-- minting policy can have only one redeemer per transaction. The values</span><span>
</span><span id="line-309"></span><span class="hs-comment">-- associated with the token names of that policy are added as described above,</span><span>
</span><span id="line-310"></span><span class="hs-comment">-- though. This means that any pre-exixting values will be minted with a new</span><span>
</span><span id="line-311"></span><span class="hs-comment">-- redeemer.</span><span>
</span><span id="line-312"></span><span class="hs-comment">--</span><span>
</span><span id="line-313"></span><span class="hs-comment">-- If, for some reason, you really want to generate a 'TxSkelMints' that has</span><span>
</span><span id="line-314"></span><span class="hs-comment">-- both a negative and a positive entry of the same asset class and redeemer,</span><span>
</span><span id="line-315"></span><span class="hs-comment">-- you'll have to do so manually. Note, however, that even if you do so, NO</span><span>
</span><span id="line-316"></span><span class="hs-comment">-- VALIDATOR OR MINTING POLICY WILL EVER GET TO SEE A TRANSACTION WITH SUCH</span><span>
</span><span id="line-317"></span><span class="hs-comment">-- CONFLICTING INFORMATION. This is not a design decision/limitation of</span><span>
</span><span id="line-318"></span><span class="hs-comment">-- cooked-validators: The Cardano API 'TxBodyContent' type, that we're</span><span>
</span><span id="line-319"></span><span class="hs-comment">-- translating everything into eventually, stores minting information as a</span><span>
</span><span id="line-320"></span><span class="hs-comment">-- minted value together with a map from policy IDs to witnesses (which</span><span>
</span><span id="line-321"></span><span class="hs-comment">-- represent the used redeemers). That means that we can only store _one_</span><span>
</span><span id="line-322"></span><span class="hs-comment">-- redeemer per minting policy, and no conflicting mints of the same asset</span><span>
</span><span id="line-323"></span><span class="hs-comment">-- class, since they'll just cancel.</span><span>
</span><span id="line-324"></span><span class="annot"><a href="Cooked.Skeleton.html#addToTxSkelMints"><span class="hs-identifier hs-type">addToTxSkelMints</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-325"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-326"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-327"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span>
</span><span id="line-328"></span><span id="addToTxSkelMints"><span class="annot"><span class="annottext">addToTxSkelMints :: (Versioned MintingPolicy, MintsRedeemer, TokenName,
 NonZero Integer)
-&gt; TxSkelMints -&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#addToTxSkelMints"><span class="hs-identifier hs-var hs-var">addToTxSkelMints</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499230"><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499229"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499229"><span class="hs-identifier hs-var">red</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499228"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span id="local-6989586621679499226"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499226"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679499225"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-329"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
-&gt; Versioned MintingPolicy
-&gt; Maybe (MintsRedeemer, NEMap TokenName (NonZero Integer))
forall k a. Ord k =&gt; Map k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">Map.!?</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-330"></span><span>    </span><span class="annot"><span class="annottext">Maybe (MintsRedeemer, NEMap TokenName (NonZero Integer))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-331"></span><span>      </span><span class="hs-comment">-- The policy isn't yet in the given 'TxSkelMints', so we can just add a</span><span>
</span><span id="line-332"></span><span>      </span><span class="hs-comment">-- new entry:</span><span>
</span><span id="line-333"></span><span>      </span><span class="annot"><span class="annottext">Versioned MintingPolicy
-&gt; (MintsRedeemer, NEMap TokenName (NonZero Integer))
-&gt; TxSkelMints
-&gt; TxSkelMints
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499229"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; NonZero Integer -&gt; NEMap TokenName (NonZero Integer)
forall k a. k -&gt; a -&gt; NEMap k a
</span><span class="hs-identifier hs-var">NEMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; NonZero Integer
forall a. a -&gt; NonZero a
</span><span class="hs-identifier hs-var">NonZero</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499226"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-334"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499221"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499221"><span class="hs-identifier hs-var">_oldRed</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499220"><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499220"><span class="hs-identifier hs-var">innerMap</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-335"></span><span>      </span><span class="hs-comment">-- Ignore the old redeemer: If it's the same as the new one, nothing will</span><span>
</span><span id="line-336"></span><span>      </span><span class="hs-comment">-- change, if not, the new redeemer will be kept.</span><span>
</span><span id="line-337"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499220"><span class="hs-identifier hs-var">innerMap</span></a></span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
-&gt; TokenName -&gt; Maybe (NonZero Integer)
forall k a. Ord k =&gt; NEMap k a -&gt; k -&gt; Maybe a
</span><span class="hs-operator hs-var">NEMap.!?</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-338"></span><span>        </span><span class="annot"><span class="annottext">Maybe (NonZero Integer)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-339"></span><span>          </span><span class="hs-comment">-- The given token name has not yet occurred for the given</span><span>
</span><span id="line-340"></span><span>          </span><span class="hs-comment">-- policy. This means that we can just add the new tokens to the</span><span>
</span><span id="line-341"></span><span>          </span><span class="hs-comment">-- inner map:</span><span>
</span><span id="line-342"></span><span>          </span><span class="annot"><span class="annottext">Versioned MintingPolicy
-&gt; (MintsRedeemer, NEMap TokenName (NonZero Integer))
-&gt; TxSkelMints
-&gt; TxSkelMints
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499229"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
-&gt; NonZero Integer
-&gt; NEMap TokenName (NonZero Integer)
-&gt; NEMap TokenName (NonZero Integer)
forall k a. Ord k =&gt; k -&gt; a -&gt; NEMap k a -&gt; NEMap k a
</span><span class="hs-identifier hs-var">NEMap.insert</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; NonZero Integer
forall a. a -&gt; NonZero a
</span><span class="hs-identifier hs-var">NonZero</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499226"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499220"><span class="hs-identifier hs-var">innerMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-343"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span id="local-6989586621679499217"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499217"><span class="hs-identifier hs-var">oldAmount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-344"></span><span>          </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679499216"><span class="annot"><span class="annottext">newAmount :: Integer
</span><a href="#local-6989586621679499216"><span class="hs-identifier hs-var hs-var">newAmount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499217"><span class="hs-identifier hs-var">oldAmount</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">+</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499226"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-345"></span><span>           </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499216"><span class="hs-identifier hs-var">newAmount</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>
</span><span id="line-346"></span><span>                </span><span class="hs-keyword">then</span><span> </span><span class="hs-comment">-- If the sum of the old amount of tokens and the additional</span><span>
</span><span id="line-347"></span><span>                </span><span class="hs-comment">-- tokens is non-zero, we can just update the amount in the</span><span>
</span><span id="line-348"></span><span>                </span><span class="hs-comment">-- inner map:</span><span>
</span><span id="line-349"></span><span>                  </span><span class="annot"><span class="annottext">Versioned MintingPolicy
-&gt; (MintsRedeemer, NEMap TokenName (NonZero Integer))
-&gt; TxSkelMints
-&gt; TxSkelMints
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499229"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
-&gt; NonZero Integer
-&gt; NEMap TokenName (NonZero Integer)
-&gt; NEMap TokenName (NonZero Integer)
forall k a. Ord k =&gt; k -&gt; a -&gt; NEMap k a -&gt; NEMap k a
</span><span class="hs-identifier hs-var">NEMap.insert</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; NonZero Integer
forall a. a -&gt; NonZero a
</span><span class="hs-identifier hs-var">NonZero</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499216"><span class="hs-identifier hs-var">newAmount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499220"><span class="hs-identifier hs-var">innerMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-350"></span><span>                </span><span class="hs-keyword">else</span><span> </span><span class="hs-comment">-- If the sum is zero, we'll have to delete the token name</span><span>
</span><span id="line-351"></span><span>                </span><span class="hs-comment">-- from the inner map. If that yields a completely empty</span><span>
</span><span id="line-352"></span><span>                </span><span class="hs-comment">-- inner map, we'll have to remove the entry altogether:</span><span>
</span><span id="line-353"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Map TokenName (NonZero Integer)
-&gt; Maybe (NEMap TokenName (NonZero Integer))
forall k a. Map k a -&gt; Maybe (NEMap k a)
</span><span class="hs-identifier hs-var">NEMap.nonEmptyMap</span></span><span> </span><span class="annot"><span class="annottext">(Map TokenName (NonZero Integer)
 -&gt; Maybe (NEMap TokenName (NonZero Integer)))
-&gt; Map TokenName (NonZero Integer)
-&gt; Maybe (NEMap TokenName (NonZero Integer))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">TokenName
-&gt; NEMap TokenName (NonZero Integer)
-&gt; Map TokenName (NonZero Integer)
forall k a. Ord k =&gt; k -&gt; NEMap k a -&gt; Map k a
</span><span class="hs-identifier hs-var">NEMap.delete</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499228"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499220"><span class="hs-identifier hs-var">innerMap</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-354"></span><span>                  </span><span class="annot"><span class="annottext">Maybe (NEMap TokenName (NonZero Integer))
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy -&gt; TxSkelMints -&gt; TxSkelMints
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.delete</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-355"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679499210"><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499210"><span class="hs-identifier hs-var">newInnerMap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
-&gt; (MintsRedeemer, NEMap TokenName (NonZero Integer))
-&gt; TxSkelMints
-&gt; TxSkelMints
forall k a. Ord k =&gt; k -&gt; a -&gt; Map k a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.insert</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499230"><span class="hs-identifier hs-var">pol</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499229"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499210"><span class="hs-identifier hs-var">newInnerMap</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679499225"><span class="hs-identifier hs-var">mints</span></a></span><span>
</span><span id="line-356"></span><span>
</span><span id="line-357"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelMintsToList"><span class="hs-identifier hs-type">txSkelMintsToList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-358"></span><span id="txSkelMintsToList"><span class="annot"><span class="annottext">txSkelMintsToList :: TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
</span><a href="Cooked.Skeleton.html#txSkelMintsToList"><span class="hs-identifier hs-var hs-var">txSkelMintsToList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-359"></span><span>  </span><span class="annot"><span class="annottext">((Versioned MintingPolicy,
  (MintsRedeemer, NEMap TokenName (NonZero Integer)))
 -&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)])
-&gt; [(Versioned MintingPolicy,
     (MintsRedeemer, NEMap TokenName (NonZero Integer)))]
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
forall (t :: * -&gt; *) a b. Foldable t =&gt; (a -&gt; [b]) -&gt; t a -&gt; [b]
</span><span class="hs-identifier hs-var">concatMap</span></span><span>
</span><span id="line-360"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679499208"><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499208"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499207"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499207"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499206"><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499206"><span class="hs-identifier hs-var">m</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>        </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679499205"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499205"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499204"><span class="annot"><span class="annottext">NonZero Integer
</span><a href="#local-6989586621679499204"><span class="hs-identifier hs-var">n</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499208"><span class="hs-identifier hs-var">p</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499207"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499205"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">NonZero Integer
</span><a href="#local-6989586621679499204"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-362"></span><span>          </span><span class="annot"><span class="annottext">((TokenName, NonZero Integer)
 -&gt; (Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer))
-&gt; [(TokenName, NonZero Integer)]
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">NonEmpty (TokenName, NonZero Integer)
-&gt; [(TokenName, NonZero Integer)]
forall a. NonEmpty a -&gt; [a]
</span><span class="hs-identifier hs-var">NEList.toList</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
-&gt; NonEmpty (TokenName, NonZero Integer)
forall k a. NEMap k a -&gt; NonEmpty (k, a)
</span><span class="hs-identifier hs-var">NEMap.toList</span></span><span> </span><span class="annot"><span class="annottext">NEMap TokenName (NonZero Integer)
</span><a href="#local-6989586621679499206"><span class="hs-identifier hs-var">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-363"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>    </span><span class="annot"><span class="annottext">([(Versioned MintingPolicy,
   (MintsRedeemer, NEMap TokenName (NonZero Integer)))]
 -&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)])
-&gt; (TxSkelMints
    -&gt; [(Versioned MintingPolicy,
         (MintsRedeemer, NEMap TokenName (NonZero Integer)))])
-&gt; TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
-&gt; [(Versioned MintingPolicy,
     (MintsRedeemer, NEMap TokenName (NonZero Integer)))]
forall k a. Map k a -&gt; [(k, a)]
</span><span class="hs-identifier hs-var">Map.toList</span></span><span>
</span><span id="line-365"></span><span>
</span><span id="line-366"></span><span class="hs-comment">-- | This function relies on the 'Monoid' instance of 'TxSkelMints'. So, some</span><span>
</span><span id="line-367"></span><span class="hs-comment">-- non-empty lists (where all amounts for a given asset class an redeemer add up</span><span>
</span><span id="line-368"></span><span class="hs-comment">-- to zero) might be translated into the empty 'TxSkelMints'. (See the comment</span><span>
</span><span id="line-369"></span><span class="hs-comment">-- at the 'Semigroup' instance definition of 'TxSkelMints', and at the</span><span>
</span><span id="line-370"></span><span class="hs-comment">-- definition of 'addToTxSkelMints'.)</span><span>
</span><span id="line-371"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelMintsFromList"><span class="hs-identifier hs-type">txSkelMintsFromList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span>
</span><span id="line-372"></span><span id="txSkelMintsFromList"><span class="annot"><span class="annottext">txSkelMintsFromList :: [(Versioned MintingPolicy, MintsRedeemer, TokenName,
  NonZero Integer)]
-&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#txSkelMintsFromList"><span class="hs-identifier hs-var hs-var">txSkelMintsFromList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-373"></span><span>  </span><span class="annot"><span class="annottext">((Versioned MintingPolicy, MintsRedeemer, TokenName,
  NonZero Integer)
 -&gt; TxSkelMints)
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
-&gt; TxSkelMints
forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><span class="hs-identifier hs-var">foldMap</span></span><span>
</span><span id="line-374"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679499197"><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499197"><span class="hs-identifier hs-var">policy</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499196"><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499196"><span class="hs-identifier hs-var">red</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499195"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499195"><span class="hs-identifier hs-var">tName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499194"><span class="annot"><span class="annottext">NonZero Integer
</span><a href="#local-6989586621679499194"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">Versioned MintingPolicy
-&gt; (MintsRedeemer, NEMap TokenName (NonZero Integer))
-&gt; TxSkelMints
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499197"><span class="hs-identifier hs-var">policy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">MintsRedeemer
</span><a href="#local-6989586621679499196"><span class="hs-identifier hs-var">red</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TokenName -&gt; NonZero Integer -&gt; NEMap TokenName (NonZero Integer)
forall k a. k -&gt; a -&gt; NEMap k a
</span><span class="hs-identifier hs-var">NEMap.singleton</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499195"><span class="hs-identifier hs-var">tName</span></a></span><span> </span><span class="annot"><span class="annottext">NonZero Integer
</span><a href="#local-6989586621679499194"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-376"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-377"></span><span>
</span><span id="line-378"></span><span class="hs-comment">-- | Convert between 'TxSkelMints' and a list of tuples describing eveything</span><span>
</span><span id="line-379"></span><span class="hs-comment">-- that's being minted. This is implemented in terms of 'txSkelMintsFromList'</span><span>
</span><span id="line-380"></span><span class="hs-comment">-- (see the comment at that function). The upshot is that</span><span>
</span><span id="line-381"></span><span class="hs-comment">--</span><span>
</span><span id="line-382"></span><span class="hs-comment">-- &gt; review mintsListIso . view mintsListIso</span><span>
</span><span id="line-383"></span><span class="hs-comment">--</span><span>
</span><span id="line-384"></span><span class="hs-comment">-- is the identity on 'TxSkelMints', but</span><span>
</span><span id="line-385"></span><span class="hs-comment">--</span><span>
</span><span id="line-386"></span><span class="hs-comment">-- &gt; view mintsListIso . review mintsListIso</span><span>
</span><span id="line-387"></span><span class="hs-comment">--</span><span>
</span><span id="line-388"></span><span class="hs-comment">-- is NOT THE IDENTITY on @[(Pl.MintingPolicy, MintsRedeemer, Pl.TokenName,</span><span>
</span><span id="line-389"></span><span class="hs-comment">-- NonZero Integer)]@.</span><span>
</span><span id="line-390"></span><span class="annot"><a href="Cooked.Skeleton.html#mintsListIso"><span class="hs-identifier hs-type">mintsListIso</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso'</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.MintingPolicy</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#MintsRedeemer"><span class="hs-identifier hs-type">MintsRedeemer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TokenName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-391"></span><span id="mintsListIso"><span class="annot"><span class="annottext">mintsListIso :: Iso'
  TxSkelMints
  [(Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)]
</span><a href="Cooked.Skeleton.html#mintsListIso"><span class="hs-identifier hs-var hs-var">mintsListIso</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TxSkelMints
 -&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)])
-&gt; ([(Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)]
    -&gt; TxSkelMints)
-&gt; Iso'
     TxSkelMints
     [(Versioned MintingPolicy, MintsRedeemer, TokenName,
       NonZero Integer)]
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
-&gt; [(Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)]
</span><a href="Cooked.Skeleton.html#txSkelMintsToList"><span class="hs-identifier hs-var">txSkelMintsToList</span></a></span><span> </span><span class="annot"><span class="annottext">[(Versioned MintingPolicy, MintsRedeemer, TokenName,
  NonZero Integer)]
-&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#txSkelMintsFromList"><span class="hs-identifier hs-var">txSkelMintsFromList</span></a></span><span>
</span><span id="line-392"></span><span>
</span><span id="line-393"></span><span class="hs-comment">-- | The value described by a 'TxSkelMints'</span><span>
</span><span id="line-394"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelMintsValue"><span class="hs-identifier hs-type">txSkelMintsValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-395"></span><span id="txSkelMintsValue"><span class="annot"><span class="annottext">txSkelMintsValue :: TxSkelMints -&gt; Value
</span><a href="Cooked.Skeleton.html#txSkelMintsValue"><span class="hs-identifier hs-var hs-var">txSkelMintsValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-396"></span><span>  </span><span class="annot"><span class="annottext">Optic'
  A_Fold
  '[]
  TxSkelMints
  (Versioned MintingPolicy, MintsRedeemer, TokenName,
   NonZero Integer)
-&gt; ((Versioned MintingPolicy, MintsRedeemer, TokenName,
     NonZero Integer)
    -&gt; Value)
-&gt; TxSkelMints
-&gt; Value
forall k m (is :: IxList) s a.
(Is k A_Fold, Monoid m) =&gt;
Optic' k is s a -&gt; (a -&gt; m) -&gt; s -&gt; m
</span><span class="hs-identifier hs-var">foldMapOf</span></span><span>
</span><span id="line-397"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Iso'
  TxSkelMints
  [(Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)]
</span><a href="Cooked.Skeleton.html#mintsListIso"><span class="hs-identifier hs-var">mintsListIso</span></a></span><span> </span><span class="annot"><span class="annottext">Iso'
  TxSkelMints
  [(Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)]
-&gt; Optic
     A_Fold
     '[]
     [(Versioned MintingPolicy, MintsRedeemer, TokenName,
       NonZero Integer)]
     [(Versioned MintingPolicy, MintsRedeemer, TokenName,
       NonZero Integer)]
     (Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)
     (Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)
-&gt; Optic'
     A_Fold
     '[]
     TxSkelMints
     (Versioned MintingPolicy, MintsRedeemer, TokenName,
      NonZero Integer)
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic
  A_Fold
  '[]
  [(Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)]
  [(Versioned MintingPolicy, MintsRedeemer, TokenName,
    NonZero Integer)]
  (Versioned MintingPolicy, MintsRedeemer, TokenName,
   NonZero Integer)
  (Versioned MintingPolicy, MintsRedeemer, TokenName,
   NonZero Integer)
forall (f :: * -&gt; *) a. Foldable f =&gt; Fold (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span class="hs-special">)</span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679499186"><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499186"><span class="hs-identifier hs-var">policy</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">MintsRedeemer
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499185"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499185"><span class="hs-identifier hs-var">tName</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span id="local-6989586621679499184"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499184"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-399"></span><span>        </span><span class="annot"><span class="annottext">AssetClass -&gt; Integer -&gt; Value
</span><span class="hs-identifier hs-var">Pl.assetClassValue</span></span><span>
</span><span id="line-400"></span><span>          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">CurrencySymbol -&gt; TokenName -&gt; AssetClass
</span><span class="hs-identifier hs-var">Pl.assetClass</span></span><span>
</span><span id="line-401"></span><span>              </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Versioned MintingPolicy -&gt; CurrencySymbol
</span><span class="hs-identifier hs-var">Pl.scriptCurrencySymbol</span></span><span> </span><span class="annot"><span class="annottext">Versioned MintingPolicy
</span><a href="#local-6989586621679499186"><span class="hs-identifier hs-var">policy</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-402"></span><span>              </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679499185"><span class="hs-identifier hs-var">tName</span></a></span><span>
</span><span id="line-403"></span><span>          </span><span class="hs-special">)</span><span>
</span><span id="line-404"></span><span>          </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679499184"><span class="hs-identifier hs-var">amount</span></a></span><span>
</span><span id="line-405"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-406"></span><span>
</span><span id="line-407"></span><span class="hs-comment">-- * Transaction outputs</span><span>
</span><span id="line-408"></span><span>
</span><span id="line-409"></span><span class="hs-keyword">class</span><span> </span><span id="IsTxSkelOutAllowedOwner"><span class="annot"><a href="Cooked.Skeleton.html#IsTxSkelOutAllowedOwner"><span class="hs-identifier hs-var">IsTxSkelOutAllowedOwner</span></a></span></span><span> </span><span id="local-6989586621679499616"><span class="annot"><a href="#local-6989586621679499616"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-410"></span><span>  </span><span id="toPKHOrValidator"><span class="annot"><a href="Cooked.Skeleton.html#toPKHOrValidator"><span class="hs-identifier hs-type">toPKHOrValidator</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679499616"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Either</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span class="hs-special">)</span><span>
</span><span id="line-411"></span><span>
</span><span id="line-412"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#IsTxSkelOutAllowedOwner"><span class="hs-identifier hs-type">IsTxSkelOutAllowedOwner</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-413"></span><span>  </span><span id="local-6989586621679499177"><span class="annot"><span class="annottext">toPKHOrValidator :: PubKeyHash -&gt; Either PubKeyHash (Versioned Validator)
</span><a href="#local-6989586621679499177"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPKHOrValidator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PubKeyHash -&gt; Either PubKeyHash (Versioned Validator)
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span id="local-6989586621679499176"><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#IsTxSkelOutAllowedOwner"><span class="hs-identifier hs-type">IsTxSkelOutAllowedOwner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679499176"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-416"></span><span>  </span><span id="local-6989586621679499174"><span class="annot"><span class="annottext">toPKHOrValidator :: TypedValidator a -&gt; Either PubKeyHash (Versioned Validator)
</span><a href="#local-6989586621679499174"><span class="hs-identifier hs-var hs-var hs-var hs-var">toPKHOrValidator</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Versioned Validator -&gt; Either PubKeyHash (Versioned Validator)
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">(Versioned Validator -&gt; Either PubKeyHash (Versioned Validator))
-&gt; (TypedValidator a -&gt; Versioned Validator)
-&gt; TypedValidator a
-&gt; Either PubKeyHash (Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a -&gt; Versioned Validator
forall a. TypedValidator a -&gt; Versioned Validator
</span><span class="hs-identifier hs-var">Pl.vValidatorScript</span></span></span><span>
</span><span id="line-417"></span><span>
</span><span id="line-418"></span><span class="hs-keyword">data</span><span> </span><span id="TxSkelOut"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-var">TxSkelOut</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621679499172"><span id="Pays"><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-420"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- This is needed only for the 'Show' instance of 'TxSkel', which in turn is only needed in tests.</span><span>
</span><span id="line-421"></span><span>      </span><span class="annot"><a href="Cooked.Output.html#IsOnchainOutput"><span class="hs-identifier hs-type">IsOnchainOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-422"></span><span>      </span><span class="annot"><a href="Cooked.Skeleton.html#IsTxSkelOutAllowedOwner"><span class="hs-identifier hs-type">IsTxSkelOutAllowedOwner</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-423"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-424"></span><span>      </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#OwnerType"><span class="hs-identifier hs-type">OwnerType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-425"></span><span>      </span><span class="annot"><a href="Cooked.Output.html#DatumType"><span class="hs-identifier hs-type">DatumType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- see the [note on TxSkelOutData]</span><span>
</span><span id="line-426"></span><span>      </span><span class="annot"><a href="Cooked.Output.html#ValueType"><span class="hs-identifier hs-type">ValueType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span> </span><span class="annot"><span class="hs-glyph hs-type">~</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span class="hs-special">,</span><span> </span><span class="hs-comment">-- needed for the 'txSkelOutValueL'</span><span>
</span><span id="line-427"></span><span>      </span><span class="annot"><a href="Cooked.Output.html#ToScript"><span class="hs-identifier hs-type">ToScript</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ReferenceScriptType"><span class="hs-identifier hs-type">ReferenceScriptType</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-428"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">{</span><span id="producedOutput"><span class="annot"><span class="annottext">()
</span><a href="Cooked.Skeleton.html#producedOutput"><span class="hs-identifier hs-var hs-var">producedOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679499172"><span class="hs-identifier hs-type">o</span></a></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-430"></span><span>    </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span>
</span><span id="line-431"></span><span>
</span><span id="line-432"></span><span class="hs-comment">-- | Since we mostly care about whether the transaction outputs are the same</span><span>
</span><span id="line-433"></span><span class="hs-comment">-- on-chain, this is sufficient:</span><span>
</span><span id="line-434"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499167"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-435"></span><span>  </span><span id="local-6989586621679499166"><span class="annot"><span class="annottext">== :: TxSkelOut -&gt; TxSkelOut -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">(==)</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOut -&gt; TxOut -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">(==)</span></span><span> </span><span class="annot"><span class="annottext">(TxOut -&gt; TxOut -&gt; Bool)
-&gt; (TxSkelOut -&gt; TxOut) -&gt; TxSkelOut -&gt; TxSkelOut -&gt; Bool
forall b c a. (b -&gt; b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; a -&gt; c
</span><span class="hs-operator hs-var">`on`</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; TxOut
</span><a href="Cooked.Skeleton.html#txSkelOutToTxOut"><span class="hs-identifier hs-var">txSkelOutToTxOut</span></a></span><span>
</span><span id="line-436"></span><span>
</span><span id="line-437"></span><span id="local-6989586621679499158"><span id="local-6989586621679499160"><span id="local-6989586621679499162"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span></span></span><span>
</span><span id="line-438"></span><span>
</span><span id="line-439"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutDatumL"><span class="hs-identifier hs-type">txSkelOutDatumL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span>
</span><span id="line-440"></span><span id="txSkelOutDatumL"><span class="annot"><span class="annottext">txSkelOutDatumL :: Lens' TxSkelOut TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#txSkelOutDatumL"><span class="hs-identifier hs-var hs-var">txSkelOutDatumL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-441"></span><span>  </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; TxSkelOutDatum)
-&gt; (TxSkelOut -&gt; TxSkelOutDatum -&gt; TxSkelOut)
-&gt; Lens' TxSkelOut TxSkelOutDatum
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span>
</span><span id="line-442"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499155"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499155"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499155"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o TxSkelOutDatum -&gt; TxSkelOutDatum
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o TxSkelOutDatum
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-443"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499152"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499152"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679499151"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499151"><span class="hs-identifier hs-var">newDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o -&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span> </span><span class="annot"><span class="annottext">(o -&gt; TxSkelOut) -&gt; o -&gt; TxSkelOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499152"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; (o -&gt; o) -&gt; o
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o TxSkelOutDatum TxSkelOutDatum
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o TxSkelOutDatum TxSkelOutDatum
-&gt; TxSkelOutDatum -&gt; o -&gt; o
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499151"><span class="hs-identifier hs-var">newDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-444"></span><span>
</span><span id="line-445"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-type">txSkelOutValueL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-446"></span><span id="txSkelOutValueL"><span class="annot"><span class="annottext">txSkelOutValueL :: Lens' TxSkelOut Value
</span><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-var hs-var">txSkelOutValueL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-447"></span><span>  </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Value)
-&gt; (TxSkelOut -&gt; Value -&gt; TxSkelOut) -&gt; Lens' TxSkelOut Value
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span>
</span><span id="line-448"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499147"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499147"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o -&gt; Value
forall o. (IsAbstractOutput o, ToValue (ValueType o)) =&gt; o -&gt; Value
</span><a href="Cooked.Output.html#outputValue"><span class="hs-identifier hs-var">outputValue</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499147"><span class="hs-identifier hs-var">output</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-449"></span><span>    </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499145"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499145"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679499144"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499144"><span class="hs-identifier hs-var">newValue</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">o -&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span> </span><span class="annot"><span class="annottext">(o -&gt; TxSkelOut) -&gt; o -&gt; TxSkelOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499145"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; (o -&gt; o) -&gt; o
forall a b. a -&gt; (a -&gt; b) -&gt; b
</span><span class="hs-operator hs-var">&amp;</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o Value Value
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span> </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o Value Value -&gt; Value -&gt; o -&gt; o
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; b -&gt; s -&gt; t
</span><span class="hs-operator hs-var">.~</span></span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499144"><span class="hs-identifier hs-var">newValue</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-450"></span><span>
</span><span id="line-451"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutValue"><span class="hs-identifier hs-type">txSkelOutValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-452"></span><span id="txSkelOutValue"><span class="annot"><span class="annottext">txSkelOutValue :: TxSkelOut -&gt; Value
</span><a href="Cooked.Skeleton.html#txSkelOutValue"><span class="hs-identifier hs-var hs-var">txSkelOutValue</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOut -&gt; Lens' TxSkelOut Value -&gt; Value
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Lens' TxSkelOut Value
</span><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-var">txSkelOutValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-453"></span><span>
</span><span id="line-454"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutValidator"><span class="hs-identifier hs-type">txSkelOutValidator</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span class="hs-special">)</span><span>
</span><span id="line-455"></span><span id="txSkelOutValidator"><span class="annot"><span class="annottext">txSkelOutValidator :: TxSkelOut -&gt; Maybe (Versioned Validator)
</span><a href="Cooked.Skeleton.html#txSkelOutValidator"><span class="hs-identifier hs-var hs-var">txSkelOutValidator</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499140"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499140"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Either PubKeyHash (Versioned Validator)
-&gt; Maybe (Versioned Validator)
forall a b. Either a b -&gt; Maybe b
</span><span class="hs-identifier hs-var">rightToMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OwnerType o -&gt; Either PubKeyHash (Versioned Validator)
forall a.
IsTxSkelOutAllowedOwner a =&gt;
a -&gt; Either PubKeyHash (Versioned Validator)
</span><a href="Cooked.Skeleton.html#toPKHOrValidator"><span class="hs-identifier hs-var">toPKHOrValidator</span></a></span><span> </span><span class="annot"><span class="annottext">(OwnerType o -&gt; Either PubKeyHash (Versioned Validator))
-&gt; OwnerType o -&gt; Either PubKeyHash (Versioned Validator)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499140"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o (OwnerType o) -&gt; OwnerType o
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o (OwnerType o)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-456"></span><span>
</span><span id="line-457"></span><span class="hs-keyword">type</span><span> </span><span id="TxSkelOutDatumConstrs"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumConstrs"><span class="hs-identifier hs-var">TxSkelOutDatumConstrs</span></a></span></span><span> </span><span id="local-6989586621679499137"><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499137"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-458"></span><span>
</span><span id="line-459"></span><span class="hs-comment">-- | See the [note on TxSkelOut data]</span><span>
</span><span id="line-460"></span><span class="hs-keyword">data</span><span> </span><span id="TxSkelOutDatum"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-var">TxSkelOutDatum</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-461"></span><span>  </span><span class="hs-comment">-- | use no datum</span><span>
</span><span id="line-462"></span><span>  </span><span id="TxSkelOutNoDatum"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span>
</span><span id="line-463"></span><span>  </span><span class="hs-comment">-- | only include the hash on the transaction</span><span>
</span><span id="line-464"></span><span>  </span><span id="local-6989586621679499135"><span id="TxSkelOutDatumHash"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumConstrs"><span class="hs-identifier hs-type">TxSkelOutDatumConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499135"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499135"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span><span>
</span><span id="line-465"></span><span>  </span><span class="hs-comment">-- | use a 'Pl.OutputDatumHash' on the transaction output, but generate the</span><span>
</span><span id="line-466"></span><span>  </span><span class="hs-comment">-- transaction in such a way that the complete datum is included in the</span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-comment">-- 'txInfoData' seen by validators</span><span>
</span><span id="line-468"></span><span>  </span><span id="local-6989586621679499133"><span id="TxSkelOutDatum"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-var">TxSkelOutDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumConstrs"><span class="hs-identifier hs-type">TxSkelOutDatumConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499133"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499133"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span><span>
</span><span id="line-469"></span><span>  </span><span class="hs-comment">-- | use an inline datum</span><span>
</span><span id="line-470"></span><span>  </span><span id="local-6989586621679499131"><span id="TxSkelOutInlineDatum"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-var">TxSkelOutInlineDatum</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumConstrs"><span class="hs-identifier hs-type">TxSkelOutDatumConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499131"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span><span>
</span><span id="line-471"></span><span>
</span><span id="line-472"></span><span id="local-6989586621679499124"><span id="local-6989586621679499126"><span id="local-6989586621679499128"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span></span></span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499121"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-475"></span><span>  </span><span id="local-6989586621679499120"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499120"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621679499119"><span class="annot"><span class="annottext">== :: TxSkelOutDatum -&gt; TxSkelOutDatum -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span id="local-6989586621679499118"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499118"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; TxSkelOutDatum -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499120"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679499118"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Ordering -&gt; Ordering -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-476"></span><span>
</span><span id="line-477"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499104"><span id="local-6989586621679499106"><span id="local-6989586621679499108"><span id="local-6989586621679499110"><span id="local-6989586621679499112"><span id="local-6989586621679499114"><span class="annot"><span class="hs-identifier hs-type">Ord</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span></span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621679499103"><span class="annot"><span class="annottext">compare :: TxSkelOutDatum -&gt; TxSkelOutDatum -&gt; Ordering
</span><a href="#local-6989586621679499103"><span class="hs-identifier hs-var hs-var hs-var hs-var">compare</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span>
</span><span id="line-479"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span id="local-6989586621679499102"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499102"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span id="local-6989586621679499101"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499101"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-480"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">SomeTypeRep -&gt; SomeTypeRep -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep a -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TypeRep a
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499102"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypeRep a -&gt; SomeTypeRep
forall k (a :: k). TypeRep a -&gt; SomeTypeRep
</span><span class="hs-identifier hs-var">SomeTypeRep</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TypeRep a
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499101"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-481"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-482"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-483"></span><span>      </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">EQ</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">a -&gt; TypeRep a
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499102"><span class="hs-identifier hs-var">d1</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep a -&gt; TypeRep a -&gt; Maybe (a :~~: a)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TypeRep a
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499101"><span class="hs-identifier hs-var">d2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-484"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">a :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; BuiltinData -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499102"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499101"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-485"></span><span>        </span><span class="annot"><span class="annottext">Maybe (a :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">String -&gt; Ordering
forall a. HasCallStack =&gt; String -&gt; a
</span><span class="hs-identifier hs-var">error</span></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;This branch cannot happen: un-equal type representations that compare to EQ&quot;</span></span><span>
</span><span id="line-486"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span id="local-6989586621679499100"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499100"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span id="local-6989586621679499099"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499099"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-487"></span><span>    </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; TxSkelOutDatum -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499100"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499099"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span id="local-6989586621679499098"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499098"><span class="hs-identifier hs-var">d1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span id="local-6989586621679499097"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499097"><span class="hs-identifier hs-var">d2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-489"></span><span>    </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; TxSkelOutDatum -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499098"><span class="hs-identifier hs-var">d1</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499097"><span class="hs-identifier hs-var">d2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-490"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-491"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-492"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-493"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">GT</span></span><span>
</span><span id="line-494"></span><span>  </span><span class="annot"><span class="hs-identifier hs-var">compare</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Ordering
</span><span class="hs-identifier hs-var">LT</span></span><span>
</span><span id="line-495"></span><span>
</span><span id="line-496"></span><span class="hs-comment">{- [note on TxSkelOut data]

On transaction outputs, we have the option to use

1. no datum
2. only a datum hash
3. a &quot;normal&quot; datum
4. an inline datum

These four options are also what the type 'TxSkelOutDatum' records. The
following table explains their differences.

\|                | in the simulated chain state | on the 'txInfoData' | 'Pl.OutputDatum' constructor seen by the validator |
\|----------------+------------------------------+---------------------+----------------------------------------------------|
\| no datum       | no                           | no                  | 'Pl.NoOutputDatum'                                 |
\|----------------+------------------------------+---------------------+----------------------------------------------------|
\| datum hash     | yes                          | no                  | 'Pl.OutputDatumHash'                               |
\|----------------+------------------------------+---------------------+----------------------------------------------------|
\| &quot;normal&quot; datum | yes                          | yes                 | 'Pl.OutputDatumHash'                               |
\|----------------+------------------------------+---------------------+----------------------------------------------------|
\| inline datum   | yes                          | no                  | 'Pl.OutputDatum'                                   |
\|----------------+------------------------------+---------------------+----------------------------------------------------|

That is:

- Whenever there is a datum, we'll store it in the state of our simulated
  chain. This will make it possible to retrieve it later, using functions such
  as 'datumFromHash'.

- Both of the 'TxSkelOutDatumHash' and 'TxSkelOutDatum' constructors will create
  an output that scripts see on the 'txInfo' as having a datum hash. The
  difference is whether that hash will be resolvable using validator functions
  like 'findDatum'.

In summary: On the one hand, there is the function 'txSkelOutDatumComplete'
which extracts the whole datum from a 'TxSkelOut'. On the other hand, there is
'txSkelOutToTxOut', which will return the output as seen on the 'TxInfo' by a
validator, with the correct 'Pl.OutputDatum' on it.
-}</span><span>
</span><span id="line-535"></span><span>
</span><span id="line-536"></span><span class="hs-comment">-- | The transaction output, as seen by a validator. In particular, see the</span><span>
</span><span id="line-537"></span><span class="hs-comment">-- [note on TxSkelOut data].</span><span>
</span><span id="line-538"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutToTxOut"><span class="hs-identifier hs-type">txSkelOutToTxOut</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span>
</span><span id="line-539"></span><span id="txSkelOutToTxOut"><span class="annot"><span class="annottext">txSkelOutToTxOut :: TxSkelOut -&gt; TxOut
</span><a href="Cooked.Skeleton.html#txSkelOutToTxOut"><span class="hs-identifier hs-var hs-var">txSkelOutToTxOut</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499096"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499096"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">o -&gt; TxOut
forall o. IsOnchainOutput o =&gt; o -&gt; TxOut
</span><a href="Cooked.Output.html#outputTxOut"><span class="hs-identifier hs-var">outputTxOut</span></a></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499096"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-540"></span><span>
</span><span id="line-541"></span><span class="hs-comment">-- | See the [note on TxSkelOut data]</span><span>
</span><span id="line-542"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutDatumComplete"><span class="hs-identifier hs-type">txSkelOutDatumComplete</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span>
</span><span id="line-543"></span><span id="txSkelOutDatumComplete"><span class="annot"><span class="annottext">txSkelOutDatumComplete :: TxSkelOut -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutDatumComplete"><span class="hs-identifier hs-var hs-var">txSkelOutDatumComplete</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679499093"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499093"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var">txSkelOutUntypedDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(TxSkelOutDatum -&gt; Maybe Datum) -&gt; TxSkelOutDatum -&gt; Maybe Datum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679499093"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o TxSkelOutDatum -&gt; TxSkelOutDatum
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o TxSkelOutDatum
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span>
</span><span id="line-544"></span><span>
</span><span id="line-545"></span><span class="hs-comment">-- | See the [note on TxSkelOut data]</span><span>
</span><span id="line-546"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToOutputDatum"><span class="hs-identifier hs-type">ToOutputDatum</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-547"></span><span>  </span><span id="local-6989586621679499089"><span class="annot"><span class="annottext">toOutputDatum :: TxSkelOutDatum -&gt; OutputDatum
</span><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-var hs-var hs-var hs-var">toOutputDatum</span></a></span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OutputDatum
</span><span class="hs-identifier hs-var">Pl.NoOutputDatum</span></span><span>
</span><span id="line-548"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-var">toOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span id="local-6989586621679499086"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499086"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatumHash</span></span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; OutputDatum) -&gt; (a -&gt; DatumHash) -&gt; a -&gt; OutputDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><span class="hs-identifier hs-var">Pl.datumHash</span></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; DatumHash) -&gt; (a -&gt; Datum) -&gt; a -&gt; DatumHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; (a -&gt; BuiltinData) -&gt; a -&gt; Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; OutputDatum) -&gt; a -&gt; OutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499086"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-549"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-var">toOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span id="local-6989586621679499082"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499082"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatumHash</span></span><span> </span><span class="annot"><span class="annottext">(DatumHash -&gt; OutputDatum) -&gt; (a -&gt; DatumHash) -&gt; a -&gt; OutputDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><span class="hs-identifier hs-var">Pl.datumHash</span></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; DatumHash) -&gt; (a -&gt; Datum) -&gt; a -&gt; DatumHash
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; (a -&gt; BuiltinData) -&gt; a -&gt; Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; OutputDatum) -&gt; a -&gt; OutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499082"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-550"></span><span>  </span><span class="annot"><a href="Cooked.Output.html#toOutputDatum"><span class="hs-identifier hs-var">toOutputDatum</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span id="local-6989586621679499081"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499081"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; OutputDatum
</span><span class="hs-identifier hs-var">Pl.OutputDatum</span></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; OutputDatum) -&gt; (a -&gt; Datum) -&gt; a -&gt; OutputDatum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; (a -&gt; BuiltinData) -&gt; a -&gt; Datum
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">(a -&gt; OutputDatum) -&gt; a -&gt; OutputDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499081"><span class="hs-identifier hs-var">datum</span></a></span><span>
</span><span id="line-551"></span><span>
</span><span id="line-552"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-type">txSkelOutUntypedDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span>
</span><span id="line-553"></span><span id="txSkelOutUntypedDatum"><span class="annot"><span class="annottext">txSkelOutUntypedDatum :: TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var hs-var">txSkelOutUntypedDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-554"></span><span>  </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe Datum
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-555"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span id="local-6989586621679499079"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499079"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; BuiltinData -&gt; Datum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499079"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-556"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span id="local-6989586621679499078"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499078"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; BuiltinData -&gt; Datum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499078"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-557"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span id="local-6989586621679499077"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499077"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Datum -&gt; Maybe Datum
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">BuiltinData -&gt; Datum
</span><span class="hs-identifier hs-var">Pl.Datum</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Datum) -&gt; BuiltinData -&gt; Datum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; BuiltinData
forall a. ToData a =&gt; a -&gt; BuiltinData
</span><span class="hs-identifier hs-var">Pl.toBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679499077"><span class="hs-identifier hs-var">x</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-558"></span><span>
</span><span id="line-559"></span><span id="local-6989586621679499076"><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutTypedDatum"><span class="hs-identifier hs-type">txSkelOutTypedDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679499076"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="annot"><a href="#local-6989586621679499076"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-560"></span><span id="txSkelOutTypedDatum"><span class="annot"><span class="annottext">txSkelOutTypedDatum :: TxSkelOutDatum -&gt; Maybe a
</span><a href="Cooked.Skeleton.html#txSkelOutTypedDatum"><span class="hs-identifier hs-var hs-var">txSkelOutTypedDatum</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><span class="hs-identifier hs-var">Pl.fromBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">(BuiltinData -&gt; Maybe a)
-&gt; (Datum -&gt; BuiltinData) -&gt; Datum -&gt; Maybe a
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Datum -&gt; BuiltinData
</span><span class="hs-identifier hs-var hs-var">Pl.getDatum</span></span><span> </span><span class="annot"><span class="annottext">(Datum -&gt; Maybe a)
-&gt; (TxSkelOutDatum -&gt; Maybe Datum) -&gt; TxSkelOutDatum -&gt; Maybe a
forall (m :: * -&gt; *) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><span class="hs-operator hs-var">&lt;=&lt;</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var">txSkelOutUntypedDatum</span></a></span><span>
</span><span id="line-561"></span><span>
</span><span id="line-562"></span><span class="hs-comment">-- ** Smart constructors for transaction outputs</span><span>
</span><span id="line-563"></span><span>
</span><span id="line-564"></span><span class="hs-comment">-- | Pay a certain value to a public key, without using a datum.</span><span>
</span><span id="line-565"></span><span class="annot"><a href="Cooked.Skeleton.html#paysPK"><span class="hs-identifier hs-type">paysPK</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span>
</span><span id="line-566"></span><span id="paysPK"><span class="annot"><span class="annottext">paysPK :: PubKeyHash -&gt; Value -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysPK"><span class="hs-identifier hs-var hs-var">paysPK</span></a></span></span><span> </span><span id="local-6989586621679499070"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679499070"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679499069"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499069"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-567"></span><span>  </span><span class="annot"><span class="annottext">ConcreteOutput PubKeyHash TxSkelOutDatum Value (TypedValidator Any)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-568"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (TypedValidator Any)
-&gt; ConcreteOutput
     PubKeyHash TxSkelOutDatum Value (TypedValidator Any)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-569"></span><span>        </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679499070"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-570"></span><span>        </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-571"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499069"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-572"></span><span>        </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span>
</span><span id="line-573"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TypedValidator Any)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Any</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-574"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-575"></span><span>
</span><span id="line-576"></span><span class="hs-comment">-- | Pay a certain value to a public key, without a datum, but including a</span><span>
</span><span id="line-577"></span><span class="hs-comment">-- reference script. This can be used to put reference scripts on chain.</span><span>
</span><span id="line-578"></span><span id="local-6989586621679499067"><span class="annot"><a href="Cooked.Skeleton.html#paysPKWithReferenceScript"><span class="hs-identifier hs-type">paysPKWithReferenceScript</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.PubKeyHash</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679499067"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span>
</span><span id="line-579"></span><span id="paysPKWithReferenceScript"><span class="annot"><span class="annottext">paysPKWithReferenceScript :: PubKeyHash -&gt; Value -&gt; TypedValidator a -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysPKWithReferenceScript"><span class="hs-identifier hs-var hs-var">paysPKWithReferenceScript</span></a></span></span><span> </span><span id="local-6989586621679499065"><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679499065"><span class="hs-identifier hs-var">pkh</span></a></span></span><span> </span><span id="local-6989586621679499064"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499064"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span id="local-6989586621679499063"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499063"><span class="hs-identifier hs-var">refScript</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-580"></span><span>  </span><span class="annot"><span class="annottext">ConcreteOutput PubKeyHash TxSkelOutDatum Value (TypedValidator a)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-581"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">PubKeyHash
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (TypedValidator a)
-&gt; ConcreteOutput
     PubKeyHash TxSkelOutDatum Value (TypedValidator a)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-582"></span><span>        </span><span class="annot"><span class="annottext">PubKeyHash
</span><a href="#local-6989586621679499065"><span class="hs-identifier hs-var">pkh</span></a></span><span>
</span><span id="line-583"></span><span>        </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-584"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499064"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-585"></span><span>        </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span>
</span><span id="line-586"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TypedValidator a -&gt; Maybe (TypedValidator a)
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499063"><span class="hs-identifier hs-var">refScript</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-587"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-588"></span><span>
</span><span id="line-589"></span><span class="hs-comment">-- | Pays a script a certain value with a certain datum, which will be included</span><span>
</span><span id="line-590"></span><span class="hs-comment">-- as a datum hash on the transaction.</span><span>
</span><span id="line-591"></span><span id="local-6989586621679499062"><span class="annot"><a href="Cooked.Skeleton.html#paysScript"><span class="hs-identifier hs-type">paysScript</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-592"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-593"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-595"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-596"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-597"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-598"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-599"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-600"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499062"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-602"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span>
</span><span id="line-603"></span><span id="paysScript"><span class="annot"><span class="annottext">paysScript :: TypedValidator a -&gt; DatumType a -&gt; Value -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysScript"><span class="hs-identifier hs-var hs-var">paysScript</span></a></span></span><span> </span><span id="local-6989586621679499060"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499060"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span id="local-6989586621679499059"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499059"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679499058"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499058"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-604"></span><span>  </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-605"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (TypedValidator Any)
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-606"></span><span>        </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499060"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-607"></span><span>        </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-608"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499058"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-609"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumType a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-var">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499059"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-610"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TypedValidator Any)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Any</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-611"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-612"></span><span>
</span><span id="line-613"></span><span class="hs-comment">-- | Like 'paysScript', but using an inline datum.</span><span>
</span><span id="line-614"></span><span id="local-6989586621679499057"><span class="annot"><a href="Cooked.Skeleton.html#paysScriptInlineDatum"><span class="hs-identifier hs-type">paysScriptInlineDatum</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-615"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-616"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-617"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-618"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-619"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-620"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-621"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-622"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-623"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499057"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-624"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-625"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span>
</span><span id="line-626"></span><span id="paysScriptInlineDatum"><span class="annot"><span class="annottext">paysScriptInlineDatum :: TypedValidator a -&gt; DatumType a -&gt; Value -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysScriptInlineDatum"><span class="hs-identifier hs-var hs-var">paysScriptInlineDatum</span></a></span></span><span> </span><span id="local-6989586621679499055"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499055"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span id="local-6989586621679499054"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499054"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679499053"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499053"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-627"></span><span>  </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-628"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (TypedValidator Any)
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-629"></span><span>        </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499055"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-630"></span><span>        </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-631"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499053"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-632"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumType a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-var">TxSkelOutInlineDatum</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499054"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TypedValidator Any)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Any</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-635"></span><span>
</span><span id="line-636"></span><span class="hs-comment">-- | Like 'paysScript', but won't include the complete datum on the</span><span>
</span><span id="line-637"></span><span class="hs-comment">-- transaction. This is only useful if there's no script that checks the output</span><span>
</span><span id="line-638"></span><span class="hs-comment">-- datum.</span><span>
</span><span id="line-639"></span><span id="local-6989586621679499052"><span class="annot"><a href="Cooked.Skeleton.html#paysScriptDatumHash"><span class="hs-identifier hs-type">paysScriptDatumHash</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-640"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-641"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-642"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-643"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-644"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-645"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-646"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-647"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-648"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499052"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-649"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-650"></span><span>  </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span></span><span>
</span><span id="line-651"></span><span id="paysScriptDatumHash"><span class="annot"><span class="annottext">paysScriptDatumHash :: TypedValidator a -&gt; DatumType a -&gt; Value -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#paysScriptDatumHash"><span class="hs-identifier hs-var hs-var">paysScriptDatumHash</span></a></span></span><span> </span><span id="local-6989586621679499050"><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499050"><span class="hs-identifier hs-var">validator</span></a></span></span><span> </span><span id="local-6989586621679499049"><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499049"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span id="local-6989586621679499048"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499048"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-652"></span><span>  </span><span class="annot"><span class="annottext">ConcreteOutput
  (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-653"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">TypedValidator a
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (TypedValidator Any)
-&gt; ConcreteOutput
     (TypedValidator a) TxSkelOutDatum Value (TypedValidator Any)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-654"></span><span>        </span><span class="annot"><span class="annottext">TypedValidator a
</span><a href="#local-6989586621679499050"><span class="hs-identifier hs-var">validator</span></a></span><span>
</span><span id="line-655"></span><span>        </span><span class="annot"><span class="annottext">Maybe StakingCredential
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-656"></span><span>        </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679499048"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-657"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">DatumType a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">DatumType a
</span><a href="#local-6989586621679499049"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-658"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Maybe (TypedValidator Any)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.TypedValidator</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Any</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-659"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-660"></span><span>
</span><span id="line-661"></span><span class="hs-comment">-- * Redeemers for transaction inputs</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="hs-keyword">type</span><span> </span><span id="SpendsScriptConstrs"><span class="annot"><a href="Cooked.Skeleton.html#SpendsScriptConstrs"><span class="hs-identifier hs-var">SpendsScriptConstrs</span></a></span></span><span> </span><span id="local-6989586621679499047"><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-664"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ToData</span></span><span> </span><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-665"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-666"></span><span>    </span><span class="annot"><a href="Cooked.Pretty.Class.html#PrettyCooked"><span class="hs-identifier hs-type">PrettyCooked</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-667"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Pl.Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-668"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499047"><span class="hs-identifier hs-type">redeemer</span></a></span><span>
</span><span id="line-669"></span><span>  </span><span class="hs-special">)</span><span>
</span><span id="line-670"></span><span>
</span><span id="line-671"></span><span class="hs-keyword">data</span><span> </span><span id="TxSkelRedeemer"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-var">TxSkelRedeemer</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>  </span><span id="TxSkelNoRedeemerForPK"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelNoRedeemerForPK"><span class="hs-identifier hs-var">TxSkelNoRedeemerForPK</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span>
</span><span id="line-673"></span><span>  </span><span id="local-6989586621679499045"><span id="TxSkelRedeemerForScript"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-var">TxSkelRedeemerForScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#SpendsScriptConstrs"><span class="hs-identifier hs-type">SpendsScriptConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499045"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499045"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span></span><span>
</span><span id="line-674"></span><span>  </span><span id="local-6989586621679499043"><span id="TxSkelRedeemerForReferencedScript"><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForReferencedScript"><span class="hs-identifier hs-var">TxSkelRedeemerForReferencedScript</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#SpendsScriptConstrs"><span class="hs-identifier hs-type">SpendsScriptConstrs</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679499043"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499043"><span class="hs-identifier hs-type">redeemer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span></span><span>
</span><span id="line-675"></span><span>
</span><span id="line-676"></span><span id="local-6989586621679499041"><span class="annot"><a href="Cooked.Skeleton.html#txSkelTypedRedeemer"><span class="hs-identifier hs-type">txSkelTypedRedeemer</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499041"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Maybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.RedeemerType</span></span><span> </span><span class="annot"><a href="#local-6989586621679499041"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span><span>
</span><span id="line-677"></span><span id="txSkelTypedRedeemer"><span class="annot"><span class="annottext">txSkelTypedRedeemer :: TxSkelRedeemer -&gt; Maybe (RedeemerType a)
</span><a href="Cooked.Skeleton.html#txSkelTypedRedeemer"><span class="hs-identifier hs-var hs-var">txSkelTypedRedeemer</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-type">TxSkelRedeemerForScript</span></a></span><span> </span><span id="local-6989586621679499039"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499039"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Maybe (RedeemerType a)
forall a. FromData a =&gt; Data -&gt; Maybe a
</span><span class="hs-identifier hs-var">Pl.fromData</span></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Maybe (RedeemerType a))
-&gt; (redeemer -&gt; Data) -&gt; redeemer -&gt; Maybe (RedeemerType a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">Pl.toData</span></span><span> </span><span class="annot"><span class="annottext">(redeemer -&gt; Maybe (RedeemerType a))
-&gt; redeemer -&gt; Maybe (RedeemerType a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499039"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-678"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelTypedRedeemer"><span class="hs-identifier hs-var">txSkelTypedRedeemer</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForReferencedScript"><span class="hs-identifier hs-type">TxSkelRedeemerForReferencedScript</span></a></span><span> </span><span id="local-6989586621679499037"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499037"><span class="hs-identifier hs-var">redeemer</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Maybe (RedeemerType a)
forall a. FromData a =&gt; Data -&gt; Maybe a
</span><span class="hs-identifier hs-var">Pl.fromData</span></span><span> </span><span class="annot"><span class="annottext">(Data -&gt; Maybe (RedeemerType a))
-&gt; (redeemer -&gt; Data) -&gt; redeemer -&gt; Maybe (RedeemerType a)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; Data
forall a. ToData a =&gt; a -&gt; Data
</span><span class="hs-identifier hs-var">Pl.toData</span></span><span> </span><span class="annot"><span class="annottext">(redeemer -&gt; Maybe (RedeemerType a))
-&gt; redeemer -&gt; Maybe (RedeemerType a)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499037"><span class="hs-identifier hs-var">redeemer</span></a></span><span>
</span><span id="line-679"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelTypedRedeemer"><span class="hs-identifier hs-var">txSkelTypedRedeemer</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelRedeemer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe (RedeemerType a)
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-680"></span><span>
</span><span id="line-681"></span><span id="local-6989586621679499031"><span id="local-6989586621679499033"><span id="local-6989586621679499035"><span class="hs-keyword">deriving</span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-682"></span><span>
</span><span id="line-683"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679499028"><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-684"></span><span>  </span><span class="annot"><span class="annottext">TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#TxSkelNoRedeemerForPK"><span class="hs-identifier hs-var">TxSkelNoRedeemerForPK</span></a></span><span> </span><span id="local-6989586621679499027"><span class="annot"><span class="annottext">== :: TxSkelRedeemer -&gt; TxSkelRedeemer -&gt; Bool
</span><span class="hs-operator hs-var hs-var hs-var hs-var">==</span></span></span><span> </span><span class="annot"><span class="annottext">TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#TxSkelNoRedeemerForPK"><span class="hs-identifier hs-var">TxSkelNoRedeemerForPK</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">True</span></span><span>
</span><span id="line-685"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-type">TxSkelRedeemerForScript</span></a></span><span> </span><span id="local-6989586621679499026"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499026"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-type">TxSkelRedeemerForScript</span></a></span><span> </span><span id="local-6989586621679499025"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499025"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-686"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499026"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep redeemer
-&gt; TypeRep redeemer -&gt; Maybe (redeemer :~~: redeemer)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TypeRep redeemer
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499025"><span class="hs-identifier hs-var">r2</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-687"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">redeemer :~~: redeemer
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499026"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; redeemer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">Pl.==</span></span><span> </span><span class="annot"><span class="annottext">redeemer
redeemer
</span><a href="#local-6989586621679499025"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-688"></span><span>      </span><span class="annot"><span class="annottext">Maybe (redeemer :~~: redeemer)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-689"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForReferencedScript"><span class="hs-identifier hs-type">TxSkelRedeemerForReferencedScript</span></a></span><span> </span><span id="local-6989586621679499023"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499023"><span class="hs-identifier hs-var">r1</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemerForReferencedScript"><span class="hs-identifier hs-type">TxSkelRedeemerForReferencedScript</span></a></span><span> </span><span id="local-6989586621679499022"><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499022"><span class="hs-identifier hs-var">r2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-690"></span><span>    </span><span class="annot"><span class="annottext">redeemer -&gt; TxSkelRedeemer
forall redeemer.
SpendsScriptConstrs redeemer =&gt;
redeemer -&gt; TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-var">TxSkelRedeemerForScript</span></a></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499023"><span class="hs-identifier hs-var">r1</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelRedeemer -&gt; TxSkelRedeemer -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">redeemer -&gt; TxSkelRedeemer
forall redeemer.
SpendsScriptConstrs redeemer =&gt;
redeemer -&gt; TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#TxSkelRedeemerForScript"><span class="hs-identifier hs-var">TxSkelRedeemerForScript</span></a></span><span> </span><span class="annot"><span class="annottext">redeemer
</span><a href="#local-6989586621679499022"><span class="hs-identifier hs-var">r2</span></a></span><span>
</span><span id="line-691"></span><span>  </span><span class="annot"><span class="annottext">TxSkelRedeemer
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="hs-operator hs-var">==</span></span><span> </span><span class="annot"><span class="annottext">TxSkelRedeemer
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><span class="hs-identifier hs-var">False</span></span><span>
</span><span id="line-692"></span><span>
</span><span id="line-693"></span><span class="hs-comment">-- * Transaction skeletons</span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span class="hs-keyword">data</span><span> </span><span id="TxSkel"><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-696"></span><span>  </span><span id="TxSkel"><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-var">TxSkel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-697"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="txSkelLabel"><span class="annot"><span class="annottext">TxSkel -&gt; Set TxLabel
</span><a href="Cooked.Skeleton.html#txSkelLabel"><span class="hs-identifier hs-var hs-var">txSkelLabel</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxLabel"><span class="hs-identifier hs-type">TxLabel</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-698"></span><span>      </span><span id="txSkelOpts"><span class="annot"><span class="annottext">TxSkel -&gt; TxOpts
</span><a href="Cooked.Skeleton.html#txSkelOpts"><span class="hs-identifier hs-var hs-var">txSkelOpts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxOpts"><span class="hs-identifier hs-type">TxOpts</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-699"></span><span>      </span><span id="txSkelMints"><span class="annot"><span class="annottext">TxSkel -&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#txSkelMints"><span class="hs-identifier hs-var hs-var">txSkelMints</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelMints"><span class="hs-identifier hs-type">TxSkelMints</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-700"></span><span>      </span><span id="txSkelValidityRange"><span class="annot"><span class="annottext">TxSkel -&gt; POSIXTimeRange
</span><a href="Cooked.Skeleton.html#txSkelValidityRange"><span class="hs-identifier hs-var hs-var">txSkelValidityRange</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.POSIXTimeRange</span></span><span class="hs-special">,</span><span>
</span><span id="line-701"></span><span>      </span><span id="txSkelSigners"><span class="annot"><span class="annottext">TxSkel -&gt; [Wallet]
</span><a href="Cooked.Skeleton.html#txSkelSigners"><span class="hs-identifier hs-var hs-var">txSkelSigners</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Wallet.html#Wallet"><span class="hs-identifier hs-type">Wallet</span></a></span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-702"></span><span>      </span><span id="txSkelIns"><span class="annot"><span class="annottext">TxSkel -&gt; Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var hs-var">txSkelIns</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelRedeemer"><span class="hs-identifier hs-type">TxSkelRedeemer</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-703"></span><span>      </span><span id="txSkelInsReference"><span class="annot"><span class="annottext">TxSkel -&gt; Set TxOutRef
</span><a href="Cooked.Skeleton.html#txSkelInsReference"><span class="hs-identifier hs-var hs-var">txSkelInsReference</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Set</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span class="hs-special">,</span><span>
</span><span id="line-704"></span><span>      </span><span id="txSkelOuts"><span class="annot"><span class="annottext">TxSkel -&gt; [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOuts"><span class="hs-identifier hs-var hs-var">txSkelOuts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-705"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-706"></span><span>    </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-707"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679499007"><span id="local-6989586621679499009"><span id="local-6989586621679499011"><span class="annot"><span class="annottext">Int -&gt; TxSkel -&gt; ShowS
[TxSkel] -&gt; ShowS
TxSkel -&gt; String
(Int -&gt; TxSkel -&gt; ShowS)
-&gt; (TxSkel -&gt; String) -&gt; ([TxSkel] -&gt; ShowS) -&gt; Show TxSkel
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [TxSkel] -&gt; ShowS
$cshowList :: [TxSkel] -&gt; ShowS
show :: TxSkel -&gt; String
$cshow :: TxSkel -&gt; String
showsPrec :: Int -&gt; TxSkel -&gt; ShowS
$cshowsPrec :: Int -&gt; TxSkel -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679499003"><span id="local-6989586621679499005"><span class="annot"><span class="annottext">TxSkel -&gt; TxSkel -&gt; Bool
(TxSkel -&gt; TxSkel -&gt; Bool)
-&gt; (TxSkel -&gt; TxSkel -&gt; Bool) -&gt; Eq TxSkel
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: TxSkel -&gt; TxSkel -&gt; Bool
$c/= :: TxSkel -&gt; TxSkel -&gt; Bool
== :: TxSkel -&gt; TxSkel -&gt; Bool
$c== :: TxSkel -&gt; TxSkel -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-708"></span><span>
</span><span id="line-709"></span><span id="txSkelValidityRangeL"><span id="txSkelSignersL"><span id="txSkelOutsL"><span id="txSkelOptsL"><span id="txSkelMintsL"><span id="txSkelLabelL"><span id="txSkelInsReferenceL"><span id="txSkelInsL"><span class="hs-identifier">makeLensesFor</span><span>
</span><span id="line-710"></span><span>  </span><span class="hs-special">[</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelLabel&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelLabelL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-711"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelOpts&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelOptsL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-712"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelMints&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelMintsL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-713"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelValidityRange&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelValidityRangeL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-714"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelSigners&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelSignersL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-715"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelIns&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelInsL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-716"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelInsReference&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelInsReferenceL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-717"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelInsCollateral&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelInsCollateralL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-718"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelOuts&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelOutsL&quot;</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-719"></span><span>    </span><span class="hs-special">(</span><span class="hs-string">&quot;txSkelFee&quot;</span><span class="hs-special">,</span><span> </span><span class="hs-string">&quot;txSkelFeeL&quot;</span><span class="hs-special">)</span><span>
</span><span id="line-720"></span><span>  </span><span class="hs-special">]</span><span>
</span><span id="line-721"></span><span>  </span><span class="hs-special">''</span><span class="hs-identifier">TxSkel</span></span></span></span></span></span></span></span></span><span>
</span><span id="line-722"></span><span>
</span><span id="line-723"></span><span class="hs-comment">-- | A convenience template where wallet 1 is the default signer of an</span><span>
</span><span id="line-724"></span><span class="hs-comment">-- otherwise empty transaction skeleton.</span><span>
</span><span id="line-725"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelTemplate"><span class="hs-identifier hs-type">txSkelTemplate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-726"></span><span id="txSkelTemplate"><span class="annot"><span class="annottext">txSkelTemplate :: TxSkel
</span><a href="Cooked.Skeleton.html#txSkelTemplate"><span class="hs-identifier hs-var hs-var">txSkelTemplate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-727"></span><span>  </span><span class="annot"><span class="annottext">TxSkel :: Set TxLabel
-&gt; TxOpts
-&gt; TxSkelMints
-&gt; POSIXTimeRange
-&gt; [Wallet]
-&gt; Map TxOutRef TxSkelRedeemer
-&gt; Set TxOutRef
-&gt; [TxSkelOut]
-&gt; TxSkel
</span><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span>
</span><span id="line-728"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="annottext">txSkelLabel :: Set TxLabel
</span><a href="Cooked.Skeleton.html#txSkelLabel"><span class="hs-identifier hs-var">txSkelLabel</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set TxLabel
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-729"></span><span>      </span><span class="annot"><span class="annottext">txSkelOpts :: TxOpts
</span><a href="Cooked.Skeleton.html#txSkelOpts"><span class="hs-identifier hs-var">txSkelOpts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxOpts
forall a. Default a =&gt; a
</span><span class="hs-identifier hs-var">def</span></span><span class="hs-special">,</span><span>
</span><span id="line-730"></span><span>      </span><span class="annot"><span class="annottext">txSkelMints :: TxSkelMints
</span><a href="Cooked.Skeleton.html#txSkelMints"><span class="hs-identifier hs-var">txSkelMints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TxSkelMints
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-731"></span><span>      </span><span class="annot"><span class="annottext">txSkelValidityRange :: POSIXTimeRange
</span><a href="Cooked.Skeleton.html#txSkelValidityRange"><span class="hs-identifier hs-var">txSkelValidityRange</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">POSIXTimeRange
forall a. Interval a
</span><span class="hs-identifier hs-var">Pl.always</span></span><span class="hs-special">,</span><span>
</span><span id="line-732"></span><span>      </span><span class="annot"><span class="annottext">txSkelSigners :: [Wallet]
</span><a href="Cooked.Skeleton.html#txSkelSigners"><span class="hs-identifier hs-var">txSkelSigners</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">,</span><span>
</span><span id="line-733"></span><span>      </span><span class="annot"><span class="annottext">txSkelIns :: Map TxOutRef TxSkelRedeemer
</span><a href="Cooked.Skeleton.html#txSkelIns"><span class="hs-identifier hs-var">txSkelIns</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Map TxOutRef TxSkelRedeemer
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-734"></span><span>      </span><span class="annot"><span class="annottext">txSkelInsReference :: Set TxOutRef
</span><a href="Cooked.Skeleton.html#txSkelInsReference"><span class="hs-identifier hs-var">txSkelInsReference</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set TxOutRef
forall a. Set a
</span><span class="hs-identifier hs-var">Set.empty</span></span><span class="hs-special">,</span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><span class="annottext">txSkelOuts :: [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOuts"><span class="hs-identifier hs-var">txSkelOuts</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-736"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-737"></span><span>
</span><span id="line-738"></span><span class="hs-comment">-- | Return all data on transaction outputs.</span><span>
</span><span id="line-739"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutputData"><span class="hs-identifier hs-type">txSkelOutputData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumHash</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span>
</span><span id="line-740"></span><span id="txSkelOutputData"><span class="annot"><span class="annottext">txSkelOutputData :: TxSkel -&gt; Map DatumHash TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#txSkelOutputData"><span class="hs-identifier hs-var hs-var">txSkelOutputData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-741"></span><span>  </span><span class="annot"><span class="annottext">Optic' A_Fold '[] TxSkel TxSkelOutDatum
-&gt; (TxSkelOutDatum -&gt; Map DatumHash TxSkelOutDatum)
-&gt; TxSkel
-&gt; Map DatumHash TxSkelOutDatum
forall k m (is :: IxList) s a.
(Is k A_Fold, Monoid m) =&gt;
Optic' k is s a -&gt; (a -&gt; m) -&gt; s -&gt; m
</span><span class="hs-identifier hs-var">foldMapOf</span></span><span>
</span><span id="line-742"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOutsL"><span class="hs-identifier hs-var">txSkelOutsL</span></a></span><span>
</span><span id="line-743"></span><span>        </span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
-&gt; Optic A_Fold '[] [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
-&gt; Optic A_Fold '[] TxSkel TxSkel TxSkelOut TxSkelOut
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Fold '[] [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
forall (f :: * -&gt; *) a. Foldable f =&gt; Fold (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span>
</span><span id="line-744"></span><span>        </span><span class="annot"><span class="annottext">Optic A_Fold '[] TxSkel TxSkel TxSkelOut TxSkelOut
-&gt; Lens' TxSkelOut TxSkelOutDatum
-&gt; Optic' A_Fold '[] TxSkel TxSkelOutDatum
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Lens' TxSkelOut TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#txSkelOutDatumL"><span class="hs-identifier hs-var">txSkelOutDatumL</span></a></span><span>
</span><span id="line-745"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-746"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679498990"><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679498990"><span class="hs-identifier hs-var">txSkelOutDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-747"></span><span>        </span><span class="annot"><span class="annottext">Map DatumHash TxSkelOutDatum
-&gt; (Datum -&gt; Map DatumHash TxSkelOutDatum)
-&gt; Maybe Datum
-&gt; Map DatumHash TxSkelOutDatum
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><span class="hs-identifier hs-var">maybe</span></span><span>
</span><span id="line-748"></span><span>          </span><span class="annot"><span class="annottext">Map DatumHash TxSkelOutDatum
forall k a. Map k a
</span><span class="hs-identifier hs-var">Map.empty</span></span><span>
</span><span id="line-749"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679498988"><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679498988"><span class="hs-identifier hs-var">datum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DatumHash -&gt; TxSkelOutDatum -&gt; Map DatumHash TxSkelOutDatum
forall k a. k -&gt; a -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.singleton</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Datum -&gt; DatumHash
</span><span class="hs-identifier hs-var">Pl.datumHash</span></span><span> </span><span class="annot"><span class="annottext">Datum
</span><a href="#local-6989586621679498988"><span class="hs-identifier hs-var">datum</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679498990"><span class="hs-identifier hs-var">txSkelOutDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-750"></span><span>          </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelOutDatum -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutUntypedDatum"><span class="hs-identifier hs-var">txSkelOutUntypedDatum</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="#local-6989586621679498990"><span class="hs-identifier hs-var">txSkelOutDatum</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-751"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-752"></span><span>
</span><span id="line-753"></span><span class="hs-comment">-- Map.singleton (Pl.datumHash &lt;$&gt; txSkelOutUntypedDatum datum) datum)</span><span>
</span><span id="line-754"></span><span>
</span><span id="line-755"></span><span class="hs-keyword">newtype</span><span> </span><span id="Fee"><span class="annot"><a href="Cooked.Skeleton.html#Fee"><span class="hs-identifier hs-var">Fee</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Fee"><span class="annot"><a href="Cooked.Skeleton.html#Fee"><span class="hs-identifier hs-var">Fee</span></a></span></span><span> </span><span class="hs-special">{</span><span id="feeLovelace"><span class="annot"><span class="annottext">Fee -&gt; Integer
</span><a href="Cooked.Skeleton.html#feeLovelace"><span class="hs-identifier hs-var hs-var">feeLovelace</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679498982"><span id="local-6989586621679498984"><span class="annot"><span class="annottext">Fee -&gt; Fee -&gt; Bool
(Fee -&gt; Fee -&gt; Bool) -&gt; (Fee -&gt; Fee -&gt; Bool) -&gt; Eq Fee
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Fee -&gt; Fee -&gt; Bool
$c/= :: Fee -&gt; Fee -&gt; Bool
== :: Fee -&gt; Fee -&gt; Bool
$c== :: Fee -&gt; Fee -&gt; Bool
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498967"><span id="local-6989586621679498969"><span id="local-6989586621679498971"><span id="local-6989586621679498973"><span id="local-6989586621679498975"><span id="local-6989586621679498977"><span id="local-6989586621679498979"><span class="annot"><span class="annottext">Eq Fee
Eq Fee
-&gt; (Fee -&gt; Fee -&gt; Ordering)
-&gt; (Fee -&gt; Fee -&gt; Bool)
-&gt; (Fee -&gt; Fee -&gt; Bool)
-&gt; (Fee -&gt; Fee -&gt; Bool)
-&gt; (Fee -&gt; Fee -&gt; Bool)
-&gt; (Fee -&gt; Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee -&gt; Fee)
-&gt; Ord Fee
Fee -&gt; Fee -&gt; Bool
Fee -&gt; Fee -&gt; Ordering
Fee -&gt; Fee -&gt; Fee
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Fee -&gt; Fee -&gt; Fee
$cmin :: Fee -&gt; Fee -&gt; Fee
max :: Fee -&gt; Fee -&gt; Fee
$cmax :: Fee -&gt; Fee -&gt; Fee
&gt;= :: Fee -&gt; Fee -&gt; Bool
$c&gt;= :: Fee -&gt; Fee -&gt; Bool
&gt; :: Fee -&gt; Fee -&gt; Bool
$c&gt; :: Fee -&gt; Fee -&gt; Bool
&lt;= :: Fee -&gt; Fee -&gt; Bool
$c&lt;= :: Fee -&gt; Fee -&gt; Bool
&lt; :: Fee -&gt; Fee -&gt; Bool
$c&lt; :: Fee -&gt; Fee -&gt; Bool
compare :: Fee -&gt; Fee -&gt; Ordering
$ccompare :: Fee -&gt; Fee -&gt; Ordering
$cp1Ord :: Eq Fee
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498961"><span id="local-6989586621679498963"><span id="local-6989586621679498965"><span class="annot"><span class="annottext">Int -&gt; Fee -&gt; ShowS
[Fee] -&gt; ShowS
Fee -&gt; String
(Int -&gt; Fee -&gt; ShowS)
-&gt; (Fee -&gt; String) -&gt; ([Fee] -&gt; ShowS) -&gt; Show Fee
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Fee] -&gt; ShowS
$cshowList :: [Fee] -&gt; ShowS
show :: Fee -&gt; String
$cshow :: Fee -&gt; String
showsPrec :: Int -&gt; Fee -&gt; ShowS
$cshowsPrec :: Int -&gt; Fee -&gt; ShowS
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498947"><span id="local-6989586621679498949"><span id="local-6989586621679498951"><span id="local-6989586621679498953"><span id="local-6989586621679498955"><span id="local-6989586621679498957"><span id="local-6989586621679498959"><span class="annot"><span class="annottext">Integer -&gt; Fee
Fee -&gt; Fee
Fee -&gt; Fee -&gt; Fee
(Fee -&gt; Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee)
-&gt; (Fee -&gt; Fee)
-&gt; (Integer -&gt; Fee)
-&gt; Num Fee
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
fromInteger :: Integer -&gt; Fee
$cfromInteger :: Integer -&gt; Fee
signum :: Fee -&gt; Fee
$csignum :: Fee -&gt; Fee
abs :: Fee -&gt; Fee
$cabs :: Fee -&gt; Fee
negate :: Fee -&gt; Fee
$cnegate :: Fee -&gt; Fee
* :: Fee -&gt; Fee -&gt; Fee
$c* :: Fee -&gt; Fee -&gt; Fee
- :: Fee -&gt; Fee -&gt; Fee
$c- :: Fee -&gt; Fee -&gt; Fee
+ :: Fee -&gt; Fee -&gt; Fee
$c+ :: Fee -&gt; Fee -&gt; Fee
</span><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-756"></span><span>
</span><span id="line-757"></span><span class="hs-comment">-- | The value in all transaction inputs, plus the negative parts of the minted</span><span>
</span><span id="line-758"></span><span class="hs-comment">-- value. This is the right hand side of the &quot;balancing equation&quot;:</span><span>
</span><span id="line-759"></span><span class="hs-comment">--</span><span>
</span><span id="line-760"></span><span class="hs-comment">-- &gt; mints + inputs = fees + burns + outputs</span><span>
</span><span id="line-761"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutputValue"><span class="hs-identifier hs-type">txSkelOutputValue</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#Fee"><span class="hs-identifier hs-type">Fee</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-762"></span><span id="txSkelOutputValue"><span class="annot"><span class="annottext">txSkelOutputValue :: TxSkel -&gt; Fee -&gt; Value
</span><a href="Cooked.Skeleton.html#txSkelOutputValue"><span class="hs-identifier hs-var hs-var">txSkelOutputValue</span></a></span></span><span> </span><span id="local-6989586621679498944"><span class="annot"><span class="annottext">skel :: TxSkel
</span><a href="#local-6989586621679498944"><span class="hs-identifier hs-var">skel</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="annottext">txSkelMints :: TxSkel -&gt; TxSkelMints
</span><a href="Cooked.Skeleton.html#txSkelMints"><span class="hs-identifier hs-var">txSkelMints</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="local-6989586621679498943"><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679498943"><span class="hs-identifier hs-var">mints</span></a></span></span><span class="hs-special">}</span><span> </span><span id="local-6989586621679498942"><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679498942"><span class="hs-identifier hs-var">fees</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-763"></span><span>  </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Cooked.Skeleton.html#negativePart"><span class="hs-identifier hs-var">negativePart</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TxSkelMints -&gt; Value
</span><a href="Cooked.Skeleton.html#txSkelMintsValue"><span class="hs-identifier hs-var">txSkelMintsValue</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelMints
</span><a href="#local-6989586621679498943"><span class="hs-identifier hs-var">mints</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-764"></span><span>    </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Fold '[] TxSkel Value -&gt; TxSkel -&gt; Value
forall k a (is :: IxList) s.
(Is k A_Fold, Monoid a) =&gt;
Optic' k is s a -&gt; s -&gt; a
</span><span class="hs-identifier hs-var">foldOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOutsL"><span class="hs-identifier hs-var">txSkelOutsL</span></a></span><span> </span><span class="annot"><span class="annottext">Lens' TxSkel [TxSkelOut]
-&gt; Optic A_Fold '[] [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
-&gt; Optic A_Fold '[] TxSkel TxSkel TxSkelOut TxSkelOut
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Fold '[] [TxSkelOut] [TxSkelOut] TxSkelOut TxSkelOut
forall (f :: * -&gt; *) a. Foldable f =&gt; Fold (f a) a
</span><span class="hs-identifier hs-var">folded</span></span><span> </span><span class="annot"><span class="annottext">Optic A_Fold '[] TxSkel TxSkel TxSkelOut TxSkelOut
-&gt; Lens' TxSkelOut Value -&gt; Optic' A_Fold '[] TxSkel Value
forall k l m (is :: IxList) (js :: IxList) (ks :: IxList) s t u v a
       b.
(JoinKinds k l m, AppendIndices is js ks) =&gt;
Optic k is s t u v -&gt; Optic l js u v a b -&gt; Optic m ks s t a b
</span><span class="hs-operator hs-var">%</span></span><span> </span><span class="annot"><span class="annottext">Lens' TxSkelOut Value
</span><a href="Cooked.Skeleton.html#txSkelOutValueL"><span class="hs-identifier hs-var">txSkelOutValueL</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TxSkel
</span><a href="#local-6989586621679498944"><span class="hs-identifier hs-var">skel</span></a></span><span>
</span><span id="line-765"></span><span>    </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Value
</span><span class="hs-identifier hs-var">Pl.lovelaceValueOf</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Fee -&gt; Integer
</span><a href="Cooked.Skeleton.html#feeLovelace"><span class="hs-identifier hs-var hs-var">feeLovelace</span></a></span><span> </span><span class="annot"><span class="annottext">Fee
</span><a href="#local-6989586621679498942"><span class="hs-identifier hs-var">fees</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-766"></span><span>
</span><span id="line-767"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutValidators"><span class="hs-identifier hs-type">txSkelOutValidators</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkel"><span class="hs-identifier hs-type">TxSkel</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.ValidatorHash</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Validator</span></span><span class="hs-special">)</span><span>
</span><span id="line-768"></span><span id="txSkelOutValidators"><span class="annot"><span class="annottext">txSkelOutValidators :: TxSkel -&gt; Map ValidatorHash (Versioned Validator)
</span><a href="Cooked.Skeleton.html#txSkelOutValidators"><span class="hs-identifier hs-var hs-var">txSkelOutValidators</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-769"></span><span>  </span><span class="annot"><span class="annottext">[(ValidatorHash, Versioned Validator)]
-&gt; Map ValidatorHash (Versioned Validator)
forall k a. Ord k =&gt; [(k, a)] -&gt; Map k a
</span><span class="hs-identifier hs-var">Map.fromList</span></span><span>
</span><span id="line-770"></span><span>    </span><span class="annot"><span class="annottext">([(ValidatorHash, Versioned Validator)]
 -&gt; Map ValidatorHash (Versioned Validator))
-&gt; (TxSkel -&gt; [(ValidatorHash, Versioned Validator)])
-&gt; TxSkel
-&gt; Map ValidatorHash (Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Maybe (ValidatorHash, Versioned Validator))
-&gt; [TxSkelOut] -&gt; [(ValidatorHash, Versioned Validator)]
forall a b. (a -&gt; Maybe b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">mapMaybe</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Versioned Validator -&gt; (ValidatorHash, Versioned Validator))
-&gt; Maybe (Versioned Validator)
-&gt; Maybe (ValidatorHash, Versioned Validator)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-identifier hs-var">fmap</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679498935"><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679498935"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Versioned Validator -&gt; ValidatorHash
</span><span class="hs-identifier hs-var">Ledger.Scripts.validatorHash</span></span><span> </span><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679498935"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Versioned Validator
</span><a href="#local-6989586621679498935"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Maybe (Versioned Validator)
 -&gt; Maybe (ValidatorHash, Versioned Validator))
-&gt; (TxSkelOut -&gt; Maybe (Versioned Validator))
-&gt; TxSkelOut
-&gt; Maybe (ValidatorHash, Versioned Validator)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Maybe (Versioned Validator)
</span><a href="Cooked.Skeleton.html#txSkelOutValidator"><span class="hs-identifier hs-var">txSkelOutValidator</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-771"></span><span>    </span><span class="annot"><span class="annottext">([TxSkelOut] -&gt; [(ValidatorHash, Versioned Validator)])
-&gt; (TxSkel -&gt; [TxSkelOut])
-&gt; TxSkel
-&gt; [(ValidatorHash, Versioned Validator)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">TxSkel -&gt; [TxSkelOut]
</span><a href="Cooked.Skeleton.html#txSkelOuts"><span class="hs-identifier hs-var hs-var">txSkelOuts</span></a></span><span>
</span><span id="line-772"></span><span>
</span><span id="line-773"></span><span class="hs-comment">-- -- | All of the '_txSkelRequiredSigners', plus all of the signers required for</span><span>
</span><span id="line-774"></span><span class="hs-comment">-- -- PK inputs on the transaction</span><span>
</span><span id="line-775"></span><span class="hs-comment">-- txSkelAllSigners :: TxSkel -&gt; Set Pl.PubKeyHash</span><span>
</span><span id="line-776"></span><span class="hs-comment">-- txSkelAllSigners skel =</span><span>
</span><span id="line-777"></span><span class="hs-comment">--   (skel ^. txSkelRequiredSignersL)</span><span>
</span><span id="line-778"></span><span class="hs-comment">--     &lt;&gt; foldMapOf</span><span>
</span><span id="line-779"></span><span class="hs-comment">--       (consumedOutputsF % afolding sBelongsToPubKey)</span><span>
</span><span id="line-780"></span><span class="hs-comment">--       Set.singleton</span><span>
</span><span id="line-781"></span><span class="hs-comment">--       skel</span><span>
</span><span id="line-782"></span><span>
</span><span id="line-783"></span><span class="hs-comment">-- * Utilities</span><span>
</span><span id="line-784"></span><span>
</span><span id="line-785"></span><span class="hs-comment">-- ** Working with 'Value's</span><span>
</span><span id="line-786"></span><span>
</span><span id="line-787"></span><span class="annot"><a href="Cooked.Skeleton.html#flattenValueI"><span class="hs-identifier hs-type">flattenValueI</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Iso'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.AssetClass</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Integer</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-788"></span><span id="flattenValueI"><span class="annot"><span class="annottext">flattenValueI :: Iso' Value [(AssetClass, Integer)]
</span><a href="Cooked.Skeleton.html#flattenValueI"><span class="hs-identifier hs-var hs-var">flattenValueI</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-789"></span><span>  </span><span class="annot"><span class="annottext">(Value -&gt; [(AssetClass, Integer)])
-&gt; ([(AssetClass, Integer)] -&gt; Value)
-&gt; Iso' Value [(AssetClass, Integer)]
forall s a b t. (s -&gt; a) -&gt; (b -&gt; t) -&gt; Iso s t a b
</span><span class="hs-identifier hs-var">iso</span></span><span>
</span><span id="line-790"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((CurrencySymbol, TokenName, Integer) -&gt; (AssetClass, Integer))
-&gt; [(CurrencySymbol, TokenName, Integer)]
-&gt; [(AssetClass, Integer)]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><span class="hs-identifier hs-var">map</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679498933"><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679498933"><span class="hs-identifier hs-var">cSymbol</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498932"><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679498932"><span class="hs-identifier hs-var">tName</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498931"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498931"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol -&gt; TokenName -&gt; AssetClass
</span><span class="hs-identifier hs-var">Pl.assetClass</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><a href="#local-6989586621679498933"><span class="hs-identifier hs-var">cSymbol</span></a></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><a href="#local-6989586621679498932"><span class="hs-identifier hs-var">tName</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498931"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(CurrencySymbol, TokenName, Integer)] -&gt; [(AssetClass, Integer)])
-&gt; (Value -&gt; [(CurrencySymbol, TokenName, Integer)])
-&gt; Value
-&gt; [(AssetClass, Integer)]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; [(CurrencySymbol, TokenName, Integer)]
</span><span class="hs-identifier hs-var">Pl.flattenValue</span></span><span class="hs-special">)</span><span>
</span><span id="line-791"></span><span>    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Value -&gt; (AssetClass, Integer) -&gt; Value)
-&gt; Value -&gt; [(AssetClass, Integer)] -&gt; Value
forall (t :: * -&gt; *) b a.
Foldable t =&gt;
(b -&gt; a -&gt; b) -&gt; b -&gt; t a -&gt; b
</span><span class="hs-identifier hs-var">foldl'</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679498928"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679498928"><span class="hs-identifier hs-var">v</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679498927"><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679498927"><span class="hs-identifier hs-var">ac</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679498926"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498926"><span class="hs-identifier hs-var">amount</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679498928"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value -&gt; Value
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><span class="hs-operator hs-var">&lt;&gt;</span></span><span> </span><span class="annot"><span class="annottext">AssetClass -&gt; Integer -&gt; Value
</span><span class="hs-identifier hs-var">Pl.assetClassValue</span></span><span> </span><span class="annot"><span class="annottext">AssetClass
</span><a href="#local-6989586621679498927"><span class="hs-identifier hs-var">ac</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498926"><span class="hs-identifier hs-var">amount</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Value
forall a. Monoid a =&gt; a
</span><span class="hs-identifier hs-var">mempty</span></span><span class="hs-special">)</span><span>
</span><span id="line-792"></span><span>
</span><span id="line-793"></span><span class="hs-comment">-- | The positive part of a value. For every asset class in the given value,</span><span>
</span><span id="line-794"></span><span class="hs-comment">-- this asset class and its amount are included in the output iff the amount is</span><span>
</span><span id="line-795"></span><span class="hs-comment">-- strictly positive. It holds</span><span>
</span><span id="line-796"></span><span class="hs-comment">--</span><span>
</span><span id="line-797"></span><span class="hs-comment">-- &gt; x == positivePart x &lt;&gt; Pl.negate negativePart x</span><span>
</span><span id="line-798"></span><span class="annot"><a href="Cooked.Skeleton.html#positivePart"><span class="hs-identifier hs-type">positivePart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-799"></span><span id="positivePart"><span class="annot"><span class="annottext">positivePart :: Value -&gt; Value
</span><a href="Cooked.Skeleton.html#positivePart"><span class="hs-identifier hs-var hs-var">positivePart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Iso' Value [(AssetClass, Integer)]
-&gt; ([(AssetClass, Integer)] -&gt; [(AssetClass, Integer)])
-&gt; Value
-&gt; Value
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span> </span><span class="annot"><span class="annottext">Iso' Value [(AssetClass, Integer)]
</span><a href="Cooked.Skeleton.html#flattenValueI"><span class="hs-identifier hs-var">flattenValueI</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">((AssetClass, Integer) -&gt; Bool)
-&gt; [(AssetClass, Integer)] -&gt; [(AssetClass, Integer)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="annot"><span class="annottext">(((AssetClass, Integer) -&gt; Bool)
 -&gt; [(AssetClass, Integer)] -&gt; [(AssetClass, Integer)])
-&gt; ((AssetClass, Integer) -&gt; Bool)
-&gt; [(AssetClass, Integer)]
-&gt; [(AssetClass, Integer)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">&lt;</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Bool)
-&gt; ((AssetClass, Integer) -&gt; Integer)
-&gt; (AssetClass, Integer)
-&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(AssetClass, Integer) -&gt; Integer
forall a b. (a, b) -&gt; b
</span><span class="hs-identifier hs-var">snd</span></span><span class="hs-special">)</span><span>
</span><span id="line-800"></span><span>
</span><span id="line-801"></span><span class="hs-comment">-- | The negative part of a value. For every asset class in the given value,</span><span>
</span><span id="line-802"></span><span class="hs-comment">-- this asset class and its negated amount are included in the output iff the</span><span>
</span><span id="line-803"></span><span class="hs-comment">-- amount is strictly negative. It holds</span><span>
</span><span id="line-804"></span><span class="hs-comment">--</span><span>
</span><span id="line-805"></span><span class="hs-comment">-- &gt; x == positivePart x &lt;&gt; Pl.negate negativePart x</span><span>
</span><span id="line-806"></span><span class="annot"><a href="Cooked.Skeleton.html#negativePart"><span class="hs-identifier hs-type">negativePart</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span>
</span><span id="line-807"></span><span id="negativePart"><span class="annot"><span class="annottext">negativePart :: Value -&gt; Value
</span><a href="Cooked.Skeleton.html#negativePart"><span class="hs-identifier hs-var hs-var">negativePart</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
</span><a href="Cooked.Skeleton.html#positivePart"><span class="hs-identifier hs-var">positivePart</span></a></span><span> </span><span class="annot"><span class="annottext">(Value -&gt; Value) -&gt; (Value -&gt; Value) -&gt; Value -&gt; Value
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">Value -&gt; Value
forall a. AdditiveGroup a =&gt; a -&gt; a
</span><span class="hs-identifier hs-var">Pl.negate</span></span><span>
</span><span id="line-808"></span><span>
</span><span id="line-809"></span><span class="hs-comment">-- | Focus the Ada part in a value. This is useful if you want to chcange only</span><span>
</span><span id="line-810"></span><span class="hs-comment">-- that part.</span><span>
</span><span id="line-811"></span><span class="annot"><a href="Cooked.Skeleton.html#adaL"><span class="hs-identifier hs-type">adaL</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Lens'</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Ada</span></span><span>
</span><span id="line-812"></span><span id="adaL"><span class="annot"><span class="annottext">adaL :: Lens' Value Ada
</span><a href="Cooked.Skeleton.html#adaL"><span class="hs-identifier hs-var hs-var">adaL</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-813"></span><span>  </span><span class="annot"><span class="annottext">(Value -&gt; Ada) -&gt; (Value -&gt; Ada -&gt; Value) -&gt; Lens' Value Ada
forall s a b t. (s -&gt; a) -&gt; (s -&gt; b -&gt; t) -&gt; Lens s t a b
</span><span class="hs-identifier hs-var">lens</span></span><span>
</span><span id="line-814"></span><span>    </span><span class="annot"><span class="annottext">Value -&gt; Ada
</span><span class="hs-identifier hs-var">Pl.fromValue</span></span><span>
</span><span id="line-815"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679498919"><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679498919"><span class="hs-identifier hs-var">value</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Lovelace</span></span><span> </span><span id="local-6989586621679498917"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498917"><span class="hs-identifier hs-var">ada</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-816"></span><span>        </span><span class="annot"><span class="annottext">Iso' Value [(AssetClass, Integer)]
-&gt; ([(AssetClass, Integer)] -&gt; [(AssetClass, Integer)])
-&gt; Value
-&gt; Value
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span>
</span><span id="line-817"></span><span>          </span><span class="annot"><span class="annottext">Iso' Value [(AssetClass, Integer)]
</span><a href="Cooked.Skeleton.html#flattenValueI"><span class="hs-identifier hs-var">flattenValueI</span></a></span><span>
</span><span id="line-818"></span><span>          </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679498916"><span class="annot"><span class="annottext">[(AssetClass, Integer)]
</span><a href="#local-6989586621679498916"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(AssetClass, Integer)]
-&gt; AssetClass -&gt; Integer -&gt; [(AssetClass, Integer)]
forall a b. Eq a =&gt; [(a, b)] -&gt; a -&gt; b -&gt; [(a, b)]
</span><a href="#local-6989586621679498915"><span class="hs-identifier hs-var">insertAssocList</span></a></span><span> </span><span class="annot"><span class="annottext">[(AssetClass, Integer)]
</span><a href="#local-6989586621679498916"><span class="hs-identifier hs-var">l</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CurrencySymbol -&gt; TokenName -&gt; AssetClass
</span><span class="hs-identifier hs-var">Pl.assetClass</span></span><span> </span><span class="annot"><span class="annottext">CurrencySymbol
</span><span class="hs-identifier hs-var">Pl.adaSymbol</span></span><span> </span><span class="annot"><span class="annottext">TokenName
</span><span class="hs-identifier hs-var">Pl.adaToken</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679498917"><span class="hs-identifier hs-var">ada</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-819"></span><span>          </span><span class="annot"><span class="annottext">Value
</span><a href="#local-6989586621679498919"><span class="hs-identifier hs-var">value</span></a></span><span>
</span><span id="line-820"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-821"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-822"></span><span>    </span><span id="local-6989586621679499471"><span id="local-6989586621679499472"><span class="annot"><a href="#local-6989586621679498915"><span class="hs-identifier hs-type">insertAssocList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Eq</span></span><span> </span><span class="annot"><a href="#local-6989586621679499472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679499472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679499471"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499472"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499471"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679499472"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="#local-6989586621679499471"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span></span></span><span>
</span><span id="line-823"></span><span>    </span><span id="local-6989586621679498915"><span class="annot"><span class="annottext">insertAssocList :: [(a, b)] -&gt; a -&gt; b -&gt; [(a, b)]
</span><a href="#local-6989586621679498915"><span class="hs-identifier hs-var hs-var">insertAssocList</span></a></span></span><span> </span><span id="local-6989586621679498912"><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679498912"><span class="hs-identifier hs-var">l</span></a></span></span><span> </span><span id="local-6989586621679498911"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498911"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679498910"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679498910"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498911"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679498910"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. a -&gt; [a] -&gt; [a]
</span><span class="hs-glyph hs-var">:</span></span><span> </span><span class="annot"><span class="annottext">((a, b) -&gt; Bool) -&gt; [(a, b)] -&gt; [(a, b)]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><span class="hs-identifier hs-var">filter</span></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; a -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><span class="hs-operator hs-var">/=</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498911"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(a -&gt; Bool) -&gt; ((a, b) -&gt; a) -&gt; (a, b) -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><span class="hs-operator hs-var">.</span></span><span> </span><span class="annot"><span class="annottext">(a, b) -&gt; a
forall a b. (a, b) -&gt; a
</span><span class="hs-identifier hs-var">fst</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(a, b)]
</span><a href="#local-6989586621679498912"><span class="hs-identifier hs-var">l</span></a></span><span>
</span><span id="line-824"></span><span>
</span><span id="line-825"></span><span class="hs-comment">-- Various Optics on 'TxSkels' and all the other types defined in</span><span>
</span><span id="line-826"></span><span class="hs-comment">-- 'Cooked.Tx.Constraints.Type'.</span><span>
</span><span id="line-827"></span><span>
</span><span id="line-828"></span><span class="hs-comment">-- | Decide if a transaction output has a certain owner and datum type.</span><span>
</span><span id="line-829"></span><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutOwnerTypeP"><span class="hs-identifier hs-type">txSkelOutOwnerTypeP</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-830"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621679498908"><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span></span><span class="hs-operator">.</span><span>
</span><span id="line-831"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cooked.Output.html#ToCredential"><span class="hs-identifier hs-type">ToCredential</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-832"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Show</span></span><span> </span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-833"></span><span>    </span><span class="annot"><a href="Cooked.Skeleton.html#IsTxSkelOutAllowedOwner"><span class="hs-identifier hs-type">IsTxSkelOutAllowedOwner</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-834"></span><span>    </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span>
</span><span id="line-835"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-836"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Prism'</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-type">ConcreteOutput</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Value</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Versioned</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.Script</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-837"></span><span id="txSkelOutOwnerTypeP"><span class="annot"><span class="annottext">txSkelOutOwnerTypeP :: Prism'
  TxSkelOut
  (ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script))
</span><a href="Cooked.Skeleton.html#txSkelOutOwnerTypeP"><span class="hs-identifier hs-var hs-var">txSkelOutOwnerTypeP</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-838"></span><span>  </span><span class="annot"><span class="annottext">(ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script)
 -&gt; TxSkelOut)
-&gt; (TxSkelOut
    -&gt; Maybe
         (ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script)))
-&gt; Prism'
     TxSkelOut
     (ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script))
forall b s a. (b -&gt; s) -&gt; (s -&gt; Maybe a) -&gt; Prism s s a b
</span><span class="hs-identifier hs-var">prism'</span></span><span>
</span><span id="line-839"></span><span>    </span><span class="annot"><span class="annottext">ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script)
-&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span>
</span><span id="line-840"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679498906"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-841"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679498905"><span class="annot"><span class="annottext">owner :: OwnerType o
</span><a href="#local-6989586621679498905"><span class="hs-identifier hs-var hs-var">owner</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o (OwnerType o) -&gt; OwnerType o
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o (OwnerType o)
forall o. IsAbstractOutput o =&gt; Lens' o (OwnerType o)
</span><a href="Cooked.Output.html#outputOwnerL"><span class="hs-identifier hs-var">outputOwnerL</span></a></span><span>
</span><span id="line-842"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OwnerType o -&gt; TypeRep (OwnerType o)
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">OwnerType o
</span><a href="#local-6989586621679498905"><span class="hs-identifier hs-var">owner</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep (OwnerType o)
-&gt; TypeRep ownerType -&gt; Maybe (OwnerType o :~~: ownerType)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">Typeable ownerType =&gt; TypeRep ownerType
forall k (a :: k). Typeable a =&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeRep</span></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="#local-6989586621679498908"><span class="hs-identifier hs-type">ownerType</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-843"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">OwnerType o :~~: ownerType
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-844"></span><span>                </span><span class="annot"><span class="annottext">ConcreteOutput
  (OwnerType o) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType o) TxSkelOutDatum Value (Versioned Script))
forall a. a -&gt; Maybe a
</span><span class="hs-identifier hs-var">Just</span></span><span> </span><span class="annot"><span class="annottext">(ConcreteOutput
   (OwnerType o) TxSkelOutDatum Value (Versioned Script)
 -&gt; Maybe
      (ConcreteOutput
         (OwnerType o) TxSkelOutDatum Value (Versioned Script)))
-&gt; ConcreteOutput
     (OwnerType o) TxSkelOutDatum Value (Versioned Script)
-&gt; Maybe
     (ConcreteOutput
        (OwnerType o) TxSkelOutDatum Value (Versioned Script))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-845"></span><span>                  </span><span class="annot"><span class="annottext">OwnerType o
-&gt; Maybe StakingCredential
-&gt; Value
-&gt; TxSkelOutDatum
-&gt; Maybe (Versioned Script)
-&gt; ConcreteOutput
     (OwnerType o) TxSkelOutDatum Value (Versioned Script)
forall ownerType valueType datumType referenceScriptType.
ownerType
-&gt; Maybe StakingCredential
-&gt; valueType
-&gt; datumType
-&gt; Maybe referenceScriptType
-&gt; ConcreteOutput ownerType datumType valueType referenceScriptType
</span><a href="Cooked.Output.html#ConcreteOutput"><span class="hs-identifier hs-var">ConcreteOutput</span></a></span><span>
</span><span id="line-846"></span><span>                    </span><span class="annot"><span class="annottext">OwnerType o
</span><a href="#local-6989586621679498905"><span class="hs-identifier hs-var">owner</span></a></span><span>
</span><span id="line-847"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o
-&gt; Optic' A_Lens '[] o (Maybe StakingCredential)
-&gt; Maybe StakingCredential
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o (Maybe StakingCredential)
forall o. IsAbstractOutput o =&gt; Lens' o (Maybe StakingCredential)
</span><a href="Cooked.Output.html#outputStakingCredentialL"><span class="hs-identifier hs-var">outputStakingCredentialL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-848"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o Value -&gt; Value
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o Value
forall o. IsAbstractOutput o =&gt; Lens' o (ValueType o)
</span><a href="Cooked.Output.html#outputValueL"><span class="hs-identifier hs-var">outputValueL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-849"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o -&gt; Optic' A_Lens '[] o TxSkelOutDatum -&gt; TxSkelOutDatum
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o TxSkelOutDatum
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-850"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ReferenceScriptType o -&gt; Versioned Script
forall a. ToScript a =&gt; a -&gt; Versioned Script
</span><a href="Cooked.Output.html#toScript"><span class="hs-identifier hs-var">toScript</span></a></span><span> </span><span class="annot"><span class="annottext">(ReferenceScriptType o -&gt; Versioned Script)
-&gt; Maybe (ReferenceScriptType o) -&gt; Maybe (Versioned Script)
forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><span class="hs-operator hs-var">&lt;$&gt;</span></span><span> </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498906"><span class="hs-identifier hs-var">output</span></a></span><span> </span><span class="annot"><span class="annottext">o
-&gt; Optic' A_Lens '[] o (Maybe (ReferenceScriptType o))
-&gt; Maybe (ReferenceScriptType o)
forall k s (is :: IxList) a.
Is k A_Getter =&gt;
s -&gt; Optic' k is s a -&gt; a
</span><span class="hs-operator hs-var">^.</span></span><span> </span><span class="annot"><span class="annottext">Optic' A_Lens '[] o (Maybe (ReferenceScriptType o))
forall o.
IsAbstractOutput o =&gt;
Lens' o (Maybe (ReferenceScriptType o))
</span><a href="Cooked.Output.html#outputReferenceScriptL"><span class="hs-identifier hs-var">outputReferenceScriptL</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-851"></span><span>              </span><span class="annot"><span class="annottext">Maybe (OwnerType o :~~: ownerType)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe
  (ConcreteOutput ownerType TxSkelOutDatum Value (Versioned Script))
forall a. Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span>
</span><span id="line-852"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-853"></span><span>
</span><span id="line-854"></span><span id="local-6989586621679498900"><span class="annot"><a href="Cooked.Skeleton.html#txSkelOutputDatumTypeAT"><span class="hs-identifier hs-type">txSkelOutputDatumTypeAT</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-855"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.FromData</span></span><span> </span><span class="annot"><a href="#local-6989586621679498900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679498900"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-856"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">AffineTraversal'</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOut"><span class="hs-identifier hs-type">TxSkelOut</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679498900"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-857"></span><span id="txSkelOutputDatumTypeAT"><span class="annot"><span class="annottext">txSkelOutputDatumTypeAT :: AffineTraversal' TxSkelOut a
</span><a href="Cooked.Skeleton.html#txSkelOutputDatumTypeAT"><span class="hs-identifier hs-var hs-var">txSkelOutputDatumTypeAT</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-858"></span><span>  </span><span class="annot"><span class="annottext">(TxSkelOut -&gt; Either TxSkelOut a)
-&gt; (TxSkelOut -&gt; a -&gt; TxSkelOut) -&gt; AffineTraversal' TxSkelOut a
forall s t a b.
(s -&gt; Either t a) -&gt; (s -&gt; b -&gt; t) -&gt; AffineTraversal s t a b
</span><span class="hs-identifier hs-var">atraversal</span></span><span>
</span><span id="line-859"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679498897"><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679498897"><span class="hs-identifier hs-var">txSkelOut</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Maybe Datum
</span><a href="Cooked.Skeleton.html#txSkelOutDatumComplete"><span class="hs-identifier hs-var">txSkelOutDatumComplete</span></a></span><span> </span><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679498897"><span class="hs-identifier hs-var">txSkelOut</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-860"></span><span>        </span><span class="annot"><span class="annottext">Maybe Datum
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Either TxSkelOut a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679498897"><span class="hs-identifier hs-var">txSkelOut</span></a></span><span>
</span><span id="line-861"></span><span>        </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Pl.Datum</span></span><span> </span><span id="local-6989586621679498896"><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679498896"><span class="hs-identifier hs-var">datum</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BuiltinData -&gt; Maybe a
forall a. FromData a =&gt; BuiltinData -&gt; Maybe a
</span><span class="hs-identifier hs-var">Pl.fromBuiltinData</span></span><span> </span><span class="annot"><span class="annottext">BuiltinData
</span><a href="#local-6989586621679498896"><span class="hs-identifier hs-var">datum</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-862"></span><span>          </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span id="local-6989586621679498895"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498895"><span class="hs-identifier hs-var">tyDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; Either TxSkelOut a
forall a b. b -&gt; Either a b
</span><span class="hs-identifier hs-var">Right</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498895"><span class="hs-identifier hs-var">tyDatum</span></a></span><span>
</span><span id="line-863"></span><span>          </span><span class="annot"><span class="annottext">Maybe a
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSkelOut -&gt; Either TxSkelOut a
forall a b. a -&gt; Either a b
</span><span class="hs-identifier hs-var">Left</span></span><span> </span><span class="annot"><span class="annottext">TxSkelOut
</span><a href="#local-6989586621679498897"><span class="hs-identifier hs-var">txSkelOut</span></a></span><span>
</span><span id="line-864"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-865"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-type">Pays</span></a></span><span> </span><span id="local-6989586621679498894"><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498894"><span class="hs-identifier hs-var">output</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679498893"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498893"><span class="hs-identifier hs-var">newTyDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-866"></span><span>        </span><span class="annot"><span class="annottext">o -&gt; TxSkelOut
forall o.
(Show o, IsOnchainOutput o, IsTxSkelOutAllowedOwner (OwnerType o),
 Typeable (OwnerType o), ToCredential (OwnerType o),
 DatumType o ~ TxSkelOutDatum, ValueType o ~ Value,
 ToScript (ReferenceScriptType o)) =&gt;
o -&gt; TxSkelOut
</span><a href="Cooked.Skeleton.html#Pays"><span class="hs-identifier hs-var">Pays</span></a></span><span> </span><span class="annot"><span class="annottext">(o -&gt; TxSkelOut) -&gt; o -&gt; TxSkelOut
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span>
</span><span id="line-867"></span><span>          </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o TxSkelOutDatum TxSkelOutDatum
-&gt; (TxSkelOutDatum -&gt; TxSkelOutDatum) -&gt; o -&gt; o
forall k (is :: IxList) s t a b.
Is k A_Setter =&gt;
Optic k is s t a b -&gt; (a -&gt; b) -&gt; s -&gt; t
</span><span class="hs-identifier hs-var">over</span></span><span>
</span><span id="line-868"></span><span>            </span><span class="annot"><span class="annottext">Optic A_Lens '[] o o TxSkelOutDatum TxSkelOutDatum
forall o. IsAbstractOutput o =&gt; Lens' o (DatumType o)
</span><a href="Cooked.Output.html#outputDatumL"><span class="hs-identifier hs-var">outputDatumL</span></a></span><span>
</span><span id="line-869"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-870"></span><span>                </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutNoDatum"><span class="hs-identifier hs-var">TxSkelOutNoDatum</span></a></span><span>
</span><span id="line-871"></span><span>                </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span> </span><span id="local-6989586621679498892"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498892"><span class="hs-identifier hs-var">tyDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-var">TxSkelOutDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; TxSkelOutDatum) -&gt; a -&gt; TxSkelOutDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall b a. (Typeable b, Typeable a) =&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679498891"><span class="hs-identifier hs-var">replaceDatumOnCorrectType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498892"><span class="hs-identifier hs-var">tyDatum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498893"><span class="hs-identifier hs-var">newTyDatum</span></a></span><span>
</span><span id="line-872"></span><span>                </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-type">TxSkelOutDatumHash</span></a></span><span> </span><span id="local-6989586621679498890"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498890"><span class="hs-identifier hs-var">tyDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutDatumHash"><span class="hs-identifier hs-var">TxSkelOutDatumHash</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; TxSkelOutDatum) -&gt; a -&gt; TxSkelOutDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall b a. (Typeable b, Typeable a) =&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679498891"><span class="hs-identifier hs-var">replaceDatumOnCorrectType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498890"><span class="hs-identifier hs-var">tyDatum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498893"><span class="hs-identifier hs-var">newTyDatum</span></a></span><span>
</span><span id="line-873"></span><span>                </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-type">TxSkelOutInlineDatum</span></a></span><span> </span><span id="local-6989586621679498889"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498889"><span class="hs-identifier hs-var">tyDatum</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">a -&gt; TxSkelOutDatum
forall a. TxSkelOutDatumConstrs a =&gt; a -&gt; TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#TxSkelOutInlineDatum"><span class="hs-identifier hs-var">TxSkelOutInlineDatum</span></a></span><span> </span><span class="annot"><span class="annottext">(a -&gt; TxSkelOutDatum) -&gt; a -&gt; TxSkelOutDatum
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><span class="hs-operator hs-var">$</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; a -&gt; a
forall b a. (Typeable b, Typeable a) =&gt; b -&gt; a -&gt; b
</span><a href="#local-6989586621679498891"><span class="hs-identifier hs-var">replaceDatumOnCorrectType</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498889"><span class="hs-identifier hs-var">tyDatum</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498893"><span class="hs-identifier hs-var">newTyDatum</span></a></span><span>
</span><span id="line-874"></span><span>            </span><span class="hs-special">)</span><span>
</span><span id="line-875"></span><span>            </span><span class="annot"><span class="annottext">o
</span><a href="#local-6989586621679498894"><span class="hs-identifier hs-var">output</span></a></span><span>
</span><span id="line-876"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-877"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-878"></span><span>    </span><span id="local-6989586621679499445"><span id="local-6989586621679499446"><span class="annot"><a href="#local-6989586621679498891"><span class="hs-identifier hs-type">replaceDatumOnCorrectType</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499446"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Typeable</span></span><span> </span><span class="annot"><a href="#local-6989586621679499445"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499446"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499445"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679499446"><span class="hs-identifier hs-type">b</span></a></span></span></span><span>
</span><span id="line-879"></span><span>    </span><span id="local-6989586621679498891"><span class="annot"><span class="annottext">replaceDatumOnCorrectType :: b -&gt; a -&gt; b
</span><a href="#local-6989586621679498891"><span class="hs-identifier hs-var hs-var">replaceDatumOnCorrectType</span></a></span></span><span> </span><span id="local-6989586621679498888"><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679498888"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span id="local-6989586621679498887"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498887"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">b -&gt; TypeRep b
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679498888"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="annot"><span class="annottext">TypeRep b -&gt; TypeRep a -&gt; Maybe (b :~~: a)
forall k1 k2 (a :: k1) (b :: k2).
TypeRep a -&gt; TypeRep b -&gt; Maybe (a :~~: b)
</span><span class="hs-operator hs-var">`eqTypeRep`</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TypeRep a
forall a. Typeable a =&gt; a -&gt; TypeRep a
</span><span class="hs-identifier hs-var">typeOf</span></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679498887"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-880"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">Just</span></span><span> </span><span class="annot"><span class="annottext">b :~~: a
</span><span class="hs-identifier hs-var">HRefl</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
a
</span><a href="#local-6989586621679498887"><span class="hs-identifier hs-var">new</span></a></span><span>
</span><span id="line-881"></span><span>      </span><span class="annot"><span class="annottext">Maybe (b :~~: a)
</span><span class="hs-identifier hs-var">Nothing</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">b
</span><a href="#local-6989586621679498888"><span class="hs-identifier hs-var">old</span></a></span><span>
</span><span id="line-882"></span><span>
</span><span id="line-883"></span><span class="hs-keyword">data</span><span> </span><span id="SkelContext"><span class="annot"><a href="Cooked.Skeleton.html#SkelContext"><span class="hs-identifier hs-var">SkelContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="SkelContext"><span class="annot"><a href="Cooked.Skeleton.html#SkelContext"><span class="hs-identifier hs-var">SkelContext</span></a></span></span><span>
</span><span id="line-884"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="skelContextTxOuts"><span class="annot"><span class="annottext">SkelContext -&gt; Map TxOutRef TxOut
</span><a href="Cooked.Skeleton.html#skelContextTxOuts"><span class="hs-identifier hs-var hs-var">skelContextTxOuts</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOutRef</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.TxOut</span></span><span class="hs-special">,</span><span>
</span><span id="line-885"></span><span>    </span><span id="skelContextTxSkelOutDatums"><span class="annot"><span class="annottext">SkelContext -&gt; Map DatumHash TxSkelOutDatum
</span><a href="Cooked.Skeleton.html#skelContextTxSkelOutDatums"><span class="hs-identifier hs-var hs-var">skelContextTxSkelOutDatums</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Map</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pl.DatumHash</span></span><span> </span><span class="annot"><a href="Cooked.Skeleton.html#TxSkelOutDatum"><span class="hs-identifier hs-type">TxSkelOutDatum</span></a></span><span>
</span><span id="line-886"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-887"></span></pre></body></html>